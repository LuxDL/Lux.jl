<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Training a PINN on 2D PDE | Lux.jl Docs</title>
    <meta name="description" content="Documentation for LuxDL Repositories">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/v1.11.2/assets/style.owesowmQ.css" as="style">
    <link rel="preload stylesheet" href="/v1.11.2/vp-icons.css" as="style">
    
    <script type="module" src="/v1.11.2/assets/app.Cy0kHjCm.js"></script>
    <link rel="preload" href="/v1.11.2/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/v1.11.2/assets/chunks/theme.BfZMugAT.js">
    <link rel="modulepreload" href="/v1.11.2/assets/chunks/framework.BL7q4BmR.js">
    <link rel="modulepreload" href="/v1.11.2/assets/tutorials_intermediate_4_PINN2DPDE.md.BmucbYiV.lean.js">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q8GYTEVTZ2"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Q8GYTEVTZ2");</script>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="REPLACE_ME_DOCUMENTER_VITEPRESS_FAVICON">
    <script src="/versions.js"></script>
    <script src="/v1.11.2/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/v1.11.2/" data-v-0f4f798b><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/v1.11.2/lux-logo-dark.svg" alt data-v-35a7d0b8><!--]--><!--[--><img class="VPImage light logo" src="/v1.11.2/lux-logo.svg" alt data-v-35a7d0b8><!--]--><!--]--><!--]--><span data-v-0f4f798b>Lux.jl Docs</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.11.2/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.11.2/introduction" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Getting Started</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://lux.csail.mit.edu/benchmarks/" target="_blank" rel="noreferrer" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Benchmarks</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.11.2/tutorials/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Tutorials</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.11.2/manual/interface" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Manual</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>API</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Lux</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Lux/layers" data-v-acbfed09><!--[--><span data-v-acbfed09>Built-In Layers</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Lux/autodiff" data-v-acbfed09><!--[--><span data-v-acbfed09>Automatic Differentiation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Lux/utilities" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Lux/contrib" data-v-acbfed09><!--[--><span data-v-acbfed09>Experimental</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Lux/interop" data-v-acbfed09><!--[--><span data-v-acbfed09>InterOp</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Lux/distributed_utils" data-v-acbfed09><!--[--><span data-v-acbfed09>DistributedUtils</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Accelerator Support</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Accelerator_Support/MLDataDevices" data-v-acbfed09><!--[--><span data-v-acbfed09>MLDataDevices</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>NN Primitives</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/NN_Primitives/LuxLib" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxLib</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/NN_Primitives/NNlib" data-v-acbfed09><!--[--><span data-v-acbfed09>NNlib</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/NN_Primitives/ActivationFunctions" data-v-acbfed09><!--[--><span data-v-acbfed09>Activation Functions</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Building Blocks</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Building_Blocks/LuxCore" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxCore</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Building_Blocks/WeightInitializers" data-v-acbfed09><!--[--><span data-v-acbfed09>WeightInitializers</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Testing Functionality</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.11.2/api/Testing_Functionality/LuxTestUtils" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxTestUtils</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LuxDL/Lux.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/avikpal1410" aria-label="twitter" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LuxDL/Lux.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/avikpal1410" aria-label="twitter" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><!--[--><a target="_blank" data-decoration="★" title="552 GitHub stars" href="https://github.com/LuxDL/Lux.jl" data-v-107dda21><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="vertical-align:middle;margin-right:0.25rem;margin-left:0.5rem;" data-v-107dda21><path d="M12 .297C5.375.297 0 5.673 0 12.3c0 5.292 3.438 9.8 8.207 11.387.6.11.793-.26.793-.577 0-.285-.01-1.04-.015-2.04-3.338.727-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.807 1.305 3.493.997.107-.774.42-1.305.762-1.605-2.665-.3-5.467-1.333-5.467-5.931 0-1.31.47-2.382 1.236-3.222-.123-.303-.535-1.52.117-3.166 0 0 1.01-.323 3.31 1.23.96-.267 1.98-.4 3-.405 1.02.005 2.04.138 3 .405 2.3-1.553 3.31-1.23 3.31-1.23.653 1.646.24 2.863.117 3.166.765.84 1.236 1.912 1.236 3.222 0 4.61-2.807 5.625-5.477 5.921.43.372.823 1.102.823 2.222 0 1.606-.015 2.902-.015 3.293 0 .32.192.693.8.577C20.565 22.1 24 17.588 24 12.297 24 5.673 18.627.297 12 .297z" data-v-107dda21></path></svg><span data-v-107dda21>0.6k</span></a><a class="mobile" target="_blank" title="552 GitHub stars" href="https://github.com/LuxDL/Lux.jl" data-v-107dda21><svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none" data-v-107dda21><path d="M19.625 5.60534C18.7083 4.03477 17.4649 2.79135 15.8945 1.87479C14.3238 0.958185 12.6091 0.5 10.7492 0.5C8.88947 0.5 7.17422 0.958325 5.60388 1.87479C4.0333 2.7913 2.78997 4.03477 1.87332 5.60534C0.956814 7.17587 0.498535 8.89089 0.498535 10.7504C0.498535 12.984 1.15021 14.9926 2.4539 16.7766C3.75744 18.5607 5.44142 19.7952 7.50571 20.4803C7.746 20.5249 7.92388 20.4936 8.03954 20.387C8.15524 20.2804 8.21302 20.1467 8.21302 19.9868C8.21302 19.9601 8.21073 19.7199 8.20629 19.266C8.20171 18.8122 8.19956 18.4162 8.19956 18.0783L7.89256 18.1315C7.69682 18.1673 7.44989 18.1825 7.15178 18.1782C6.8538 18.174 6.54446 18.1428 6.22419 18.0847C5.90377 18.0272 5.60575 17.8937 5.32988 17.6846C5.05416 17.4755 4.85842 17.2018 4.74272 16.8639L4.60925 16.5568C4.52029 16.3523 4.38023 16.1251 4.18888 15.8761C3.99754 15.6269 3.80405 15.458 3.60831 15.369L3.51486 15.3021C3.45259 15.2577 3.39481 15.204 3.34138 15.1418C3.28799 15.0796 3.24802 15.0173 3.22132 14.955C3.19458 14.8926 3.21674 14.8414 3.28804 14.8012C3.35933 14.761 3.48817 14.7416 3.67512 14.7416L3.94196 14.7814C4.11993 14.8171 4.34007 14.9236 4.60266 15.1017C4.86511 15.2796 5.08085 15.5109 5.24994 15.7956C5.4547 16.1605 5.7014 16.4385 5.99072 16.6299C6.27982 16.8212 6.5713 16.9167 6.86488 16.9167C7.15846 16.9167 7.41203 16.8945 7.62567 16.8502C7.83908 16.8057 8.0393 16.7388 8.22625 16.6499C8.30633 16.0535 8.52437 15.5953 8.88017 15.275C8.37304 15.2217 7.9171 15.1414 7.51212 15.0347C7.10736 14.9278 6.6891 14.7544 6.25761 14.5139C5.82589 14.2738 5.46774 13.9756 5.18309 13.6198C4.89839 13.2639 4.66474 12.7966 4.48247 12.2183C4.3001 11.6399 4.20889 10.9726 4.20889 10.2163C4.20889 9.13941 4.56044 8.22304 5.26341 7.46665C4.93411 6.65705 4.96519 5.74947 5.35676 4.744C5.61482 4.66382 5.9975 4.72399 6.50463 4.92412C7.01186 5.12434 7.38323 5.29587 7.61912 5.43808C7.85502 5.58024 8.04402 5.70071 8.18642 5.79842C9.01411 5.56715 9.86825 5.45149 10.7491 5.45149C11.6299 5.45149 12.4843 5.56715 13.312 5.79842L13.8192 5.47823C14.166 5.26459 14.5756 5.06881 15.0469 4.89083C15.5185 4.71295 15.8791 4.66396 16.1284 4.74414C16.5286 5.74966 16.5643 6.65719 16.2349 7.46679C16.9378 8.22318 17.2895 9.13978 17.2895 10.2164C17.2895 10.9727 17.198 11.6421 17.0159 12.225C16.8336 12.808 16.5979 13.2749 16.3088 13.6265C16.0194 13.9781 15.659 14.274 15.2275 14.5141C14.7959 14.7544 14.3775 14.9278 13.9728 15.0347C13.5678 15.1415 13.1119 15.2219 12.6047 15.2752C13.0673 15.6755 13.2986 16.3073 13.2986 17.1704V19.9864C13.2986 20.1464 13.3542 20.2799 13.4656 20.3867C13.5768 20.4932 13.7524 20.5246 13.9927 20.4799C16.0573 19.7949 17.7413 18.5603 19.0448 16.7762C20.3481 14.9922 21 12.9837 21 10.75C20.9996 8.89075 20.541 7.17587 19.625 5.60534Z" fill="currentColor" data-v-107dda21></path></svg></a><!--]--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Beginner</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/beginner/1_Basics" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Julia & Lux for the Uninitiated</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/beginner/2_PolynomialFitting" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Fitting a Polynomial using MLP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/beginner/3_SimpleRNN" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Training a Simple LSTM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/beginner/4_SimpleChains" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>MNIST Classification with SimpleChains</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/beginner/5_OptimizationIntegration" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Fitting with Optimization.jl</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Intermediate</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/intermediate/1_NeuralODE" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>MNIST Classification using Neural ODEs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/intermediate/3_HyperNet" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Training a HyperNetwork on MNIST and FashionMNIST</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/intermediate/4_PINN2DPDE" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Training a PINN on 2D PDE</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/intermediate/5_ConvolutionalVAE" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Convolutional VAE for MNIST using Reactant</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/intermediate/6_GCN_Cora" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Graph Convolutional Network on Cora</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/intermediate/7_RealNVP" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Normalizing Flows for Density Estimation</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Advanced</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/v1.11.2/tutorials/advanced/1_GravitationalWaveForm" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Training a Neural ODE to Model Gravitational Waveforms</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible collapsed" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Larger Models</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://github.com/LuxDL/Lux.jl/tree/main/examples/ImageNet" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Training Image Classification Models on ImageNet with Distributed Data Parallel Training</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://github.com/LuxDL/Lux.jl/tree/main/examples/DDIM" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Training a DDIM (Diffusion Model) for Image Generation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://github.com/LuxDL/Lux.jl/tree/main/examples/CIFAR10" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Different Vision Models on CIFAR-10</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible collapsed" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>3rd Party Tutorials</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/pdesystem/" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>PINNs (NeuralPDE.jl)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://docs.sciml.ai/SciMLSensitivity/stable/tutorials/data_parallel/" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>UDEs (SciMLSensitivity.jl)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://docs.sciml.ai/DiffEqFlux/stable/examples/neural_ode/" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Neural DEs (DiffEqFlux.jl)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://docs.sciml.ai/DeepEquilibriumNetworks/stable/tutorials/basic_mnist_deq/" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>DEQs (DeepEquilibriumNetworks.jl)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://github.com/Dale-Black/ComputerVisionTutorials.jl/" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Medical Image Segmentation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link vp-external-link-icon link" href="https://github.com/agdestein/NeuralClosureTutorials/" target="_blank" rel="noreferrer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Neural Closure Models</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--[--><!--[--><!--[--><!--[--><br><h2> Trusted by </h2><a class="enjoyer" href="https://sciml.ai/" target="_blank"><img width="32" height="32" src="https://avatars.githubusercontent.com/u/21238080?v=4"><span><p class="extra-info">Scientific Computing</p><p class="heading">SciML.ai</p><p class="extra-info">Machine Learning</p></span></a><!--]--><!--]--><!--]--><!--]--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _v1_11_2_tutorials_intermediate_4_PINN2DPDE" data-v-83890dd9><div><h1 id="Training-a-PINN-on-2D-PDE" tabindex="-1">Training a PINN on 2D PDE <a class="header-anchor" href="#Training-a-PINN-on-2D-PDE" aria-label="Permalink to &quot;Training a PINN on 2D PDE {#Training-a-PINN-on-2D-PDE}&quot;">​</a></h1><p>In this tutorial we will go over using a PINN to solve 2D PDEs. We will be using the system from <a href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/gpu/" target="_blank" rel="noreferrer">NeuralPDE Tutorials</a>. However, we will be using our custom loss function and use nested AD capabilities of Lux.jl.</p><p>This is a demonstration of Lux.jl. For serious usecases of PINNs, please refer to the package: <a href="https://github.com/SciML/NeuralPDE.jl" target="_blank" rel="noreferrer">NeuralPDE.jl</a>.</p><h2 id="Package-Imports" tabindex="-1">Package Imports <a class="header-anchor" href="#Package-Imports" aria-label="Permalink to &quot;Package Imports {#Package-Imports}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Optimisers,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Random,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Printf,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Statistics,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    MLUtils,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    OnlineStats,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    CairoMakie,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Reactant,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Enzyme</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xdev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reactant_device</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; force</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cdev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cpu_device</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(::MLDataDevices.CPUDevice) (generic function with 1 method)</span></span></code></pre></div><h2 id="Problem-Definition" tabindex="-1">Problem Definition <a class="header-anchor" href="#Problem-Definition" aria-label="Permalink to &quot;Problem Definition {#Problem-Definition}&quot;">​</a></h2><p>Since Lux supports efficient nested AD upto 2nd order, we will rewrite the problem with first order derivatives, so that we can compute the gradients of the loss using 2nd order AD.</p><h2 id="Define-the-Neural-Networks" tabindex="-1">Define the Neural Networks <a class="header-anchor" href="#Define-the-Neural-Networks" aria-label="Permalink to &quot;Define the Neural Networks {#Define-the-Neural-Networks}&quot;">​</a></h2><p>All the networks take 3 input variables and output a scalar value. Here, we will define a a wrapper over the 3 networks, so that we can train them using <a href="/v1.11.2/api/Lux/utilities#Lux.Training.TrainState"><code>Training.TrainState</code></a>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PINN{U,V,W} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractLuxContainerLayer{(:u, :v, :w)}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">U</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">V</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    w</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">W</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_mlp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(act, hidden_dims)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hidden_dims, act),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hidden_dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hidden_dims, act),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hidden_dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hidden_dims, act),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hidden_dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PINN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; hidden_dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PINN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        create_mlp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tanh, hidden_dims),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        create_mlp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tanh, hidden_dims),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        create_mlp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tanh, hidden_dims),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Main.var&quot;##230&quot;.PINN</span></span></code></pre></div><h2 id="Define-the-Loss-Functions" tabindex="-1">Define the Loss Functions <a class="header-anchor" href="#Define-the-Loss-Functions" aria-label="Permalink to &quot;Define the Loss Functions {#Define-the-Loss-Functions}&quot;">​</a></h2><p>We will define a custom loss function to compute the loss using 2nd order AD. We will use the following loss function</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@views</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> physics_informed_loss_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatefulLuxLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatefulLuxLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, w</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatefulLuxLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xyt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ∂u_∂xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Enzyme</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reverse, sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">∘</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u, xyt)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ∂u_∂x, ∂u_∂y, ∂u_∂t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ∂u_∂xyt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], ∂u_∂xyt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], ∂u_∂xyt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ∂v_∂x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Enzyme</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reverse, sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">∘</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v, xyt)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    v_xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ∂w_∂y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Enzyme</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reverse, sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">∘</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w, xyt)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    w_xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> w</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, ∂u_∂t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ∂v_∂x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ∂w_∂y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, v_xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ∂u_∂x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abs2, w_xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ∂u_∂y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>physics_informed_loss_function (generic function with 1 method)</span></span></code></pre></div><p>Additionally, we need to compute the loss wrt the boundary conditions.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mse_loss_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StatefulLuxLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xyt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MSELoss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt), target)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loss_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, ps, st, (xyt, target_data, xyt_bc, target_bc))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    u_net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> StatefulLuxLayer{true}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u, ps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u, st</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    v_net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> StatefulLuxLayer{true}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v, ps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v, st</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    w_net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> StatefulLuxLayer{true}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w, ps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w, st</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    physics_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> physics_informed_loss_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_net, v_net, w_net, xyt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mse_loss_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_net, target_data, xyt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bc_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mse_loss_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u_net, target_bc, xyt_bc)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> physics_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bc_loss</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        loss, (; u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u_net</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">st, v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_net</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">st, w</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w_net</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">st), (; physics_loss, data_loss, bc_loss)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>loss_function (generic function with 1 method)</span></span></code></pre></div><h2 id="Generate-the-Data" tabindex="-1">Generate the Data <a class="header-anchor" href="#Generate-the-Data" aria-label="Permalink to &quot;Generate the Data {#Generate-the-Data}&quot;">​</a></h2><p>We will generate some random data to train the model on. We will take data on a square spatial and temporal domain <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.586ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3795.2 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(849.8,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1794.6,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(2072.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2572.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3017.2,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3517.2,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>, <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.401ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3713.2 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(767.8,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1712.6,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1990.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2490.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(2935.2,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3435.2,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>, and <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.109ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3584.2 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(638.8,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1583.6,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1861.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2361.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(2806.2,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3306.2,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>. Typically, you want to be smarter about the sampling process, but for the sake of simplicity, we will skip that.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">analytical_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, y, t) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">analytical_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> analytical_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], xyt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], xyt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">begin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    grid_len </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    grid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grid_len)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([[elem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> elem </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Iterators</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">product</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid, grid, grid)))])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">analytical_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bc_len </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bc_len))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bc_len))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bc_len))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xyt_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((x, y, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, bc_len)); dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, bc_len), y, t); dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, bc_len) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y, t); dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((x, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, bc_len), t); dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((x, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, bc_len) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t); dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">analytical_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt_bc), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    min_target_bc, max_target_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(target_bc)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    min_data, max_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(target_data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    min_pde_val, max_pde_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(min_data, min_target_bc), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(max_data, max_target_bc)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (xyt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maximum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xyt_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (xyt_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt_bc)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maximum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt_bc) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt_bc))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (target_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> min_pde_val) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (max_pde_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> min_pde_val)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (target_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> min_pde_val) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (max_pde_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> min_pde_val)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h2 id="training" tabindex="-1">Training <a class="header-anchor" href="#training" aria-label="Permalink to &quot;Training&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> train_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xyt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target_data,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xyt_bc,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target_bc;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    maxiters</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    hidden_dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rng </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_rng</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">seed!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rng, seed)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    pinn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PINN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; hidden_dims)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ps, st </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> xdev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Lux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rng, pinn))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bc_dataloader </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> xdev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        DataLoader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((xyt_bc, target_bc); batchsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, shuffle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, partial</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    pde_dataloader </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> xdev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        DataLoader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((xyt, target_data); batchsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, shuffle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, partial</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    train_state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Training</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TrainState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pinn, ps, st, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Adam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    lr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.05f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.005f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0005f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    total_loss_tracker, physics_loss_tracker, data_loss_tracker, bc_loss_tracker </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ntuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OnlineStats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CircBuff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; rev</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((xyt_batch, target_data_batch), (xyt_bc_batch, target_bc_batch)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        zip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Iterators</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cycle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pde_dataloader), Iterators</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cycle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bc_dataloader))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Optimisers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">adjust!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(train_state, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        _, loss, stats, train_state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Training</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">single_train_step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            AutoEnzyme</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            loss_function,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            (xyt_batch, target_data_batch, xyt_bc_batch, target_bc_batch),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            train_state,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        fit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(total_loss_tracker, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Float32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loss))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        fit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(physics_loss_tracker, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Float32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">physics_loss))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        fit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data_loss_tracker, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Float32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_loss))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        fit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bc_loss_tracker, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Float32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bc_loss))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mean_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OnlineStats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(total_loss_tracker))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mean_physics_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OnlineStats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(physics_loss_tracker))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mean_data_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OnlineStats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data_loss_tracker))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mean_bc_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OnlineStats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bc_loss_tracker))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        isnan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loss) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ArgumentError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NaN Loss Detected&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maxiters</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            @printf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Iteration: [%6d/%6d] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Loss: %.9f (%.9f) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Physics Loss: %.9f \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     (%.9f) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Data Loss: %.9f (%.9f) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BC \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     Loss: %.9f (%.9f)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter maxiters loss mean_loss stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">physics_loss mean_physics_loss stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_loss mean_data_loss stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bc_loss mean_bc_loss</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≥</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maxiters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> break</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> StatefulLuxLayer{true}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pinn, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cdev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(train_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameters), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cdev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(train_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trained_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> train_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xyt, target_data, xyt_bc, target_bc)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trained_u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">testmode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    StatefulLuxLayer{true}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(trained_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u, trained_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u, trained_model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">st</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2025-03-28 04:44:33.167760: I external/xla/xla/service/service.cc:152] XLA service 0xb3b0180 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:</span></span>
<span class="line"><span>2025-03-28 04:44:33.167793: I external/xla/xla/service/service.cc:160]   StreamExecutor device (0): NVIDIA A100-PCIE-40GB MIG 1g.5gb, Compute Capability 8.0</span></span>
<span class="line"><span>WARNING: All log messages before absl::InitializeLog() is called are written to STDERR</span></span>
<span class="line"><span>I0000 00:00:1743137073.168490 3481103 se_gpu_pjrt_client.cc:1039] Using BFC allocator.</span></span>
<span class="line"><span>I0000 00:00:1743137073.168557 3481103 gpu_helpers.cc:136] XLA backend allocating 3825205248 bytes on device 0 for BFCAllocator.</span></span>
<span class="line"><span>I0000 00:00:1743137073.168598 3481103 gpu_helpers.cc:177] XLA backend will use up to 1275068416 bytes on device 0 for CollectiveBFCAllocator.</span></span>
<span class="line"><span>I0000 00:00:1743137073.182124 3481103 cuda_dnn.cc:529] Loaded cuDNN version 90400</span></span>
<span class="line"><span>E0000 00:00:1743137370.266593 3481103 buffer_comparator.cc:156] Difference at 16: 0, expected 9.17386</span></span>
<span class="line"><span>E0000 00:00:1743137370.266655 3481103 buffer_comparator.cc:156] Difference at 17: 0, expected 8.63962</span></span>
<span class="line"><span>E0000 00:00:1743137370.266663 3481103 buffer_comparator.cc:156] Difference at 18: 0, expected 11.0889</span></span>
<span class="line"><span>E0000 00:00:1743137370.266671 3481103 buffer_comparator.cc:156] Difference at 19: 0, expected 8.96333</span></span>
<span class="line"><span>E0000 00:00:1743137370.266677 3481103 buffer_comparator.cc:156] Difference at 20: 0, expected 8.01067</span></span>
<span class="line"><span>E0000 00:00:1743137370.266684 3481103 buffer_comparator.cc:156] Difference at 21: 0, expected 11.0277</span></span>
<span class="line"><span>E0000 00:00:1743137370.266691 3481103 buffer_comparator.cc:156] Difference at 22: 0, expected 7.61027</span></span>
<span class="line"><span>E0000 00:00:1743137370.266697 3481103 buffer_comparator.cc:156] Difference at 23: 0, expected 7.70495</span></span>
<span class="line"><span>E0000 00:00:1743137370.266703 3481103 buffer_comparator.cc:156] Difference at 24: 0, expected 10.9025</span></span>
<span class="line"><span>E0000 00:00:1743137370.266710 3481103 buffer_comparator.cc:156] Difference at 25: 0, expected 9.9377</span></span>
<span class="line"><span>2025-03-28 04:49:30.266727: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.269465 3481103 buffer_comparator.cc:156] Difference at 16: 0, expected 9.17386</span></span>
<span class="line"><span>E0000 00:00:1743137370.269489 3481103 buffer_comparator.cc:156] Difference at 17: 0, expected 8.63962</span></span>
<span class="line"><span>E0000 00:00:1743137370.269496 3481103 buffer_comparator.cc:156] Difference at 18: 0, expected 11.0889</span></span>
<span class="line"><span>E0000 00:00:1743137370.269504 3481103 buffer_comparator.cc:156] Difference at 19: 0, expected 8.96333</span></span>
<span class="line"><span>E0000 00:00:1743137370.269510 3481103 buffer_comparator.cc:156] Difference at 20: 0, expected 8.01067</span></span>
<span class="line"><span>E0000 00:00:1743137370.269516 3481103 buffer_comparator.cc:156] Difference at 21: 0, expected 11.0277</span></span>
<span class="line"><span>E0000 00:00:1743137370.269523 3481103 buffer_comparator.cc:156] Difference at 22: 0, expected 7.61027</span></span>
<span class="line"><span>E0000 00:00:1743137370.269529 3481103 buffer_comparator.cc:156] Difference at 23: 0, expected 7.70495</span></span>
<span class="line"><span>E0000 00:00:1743137370.269535 3481103 buffer_comparator.cc:156] Difference at 24: 0, expected 10.9025</span></span>
<span class="line"><span>E0000 00:00:1743137370.269542 3481103 buffer_comparator.cc:156] Difference at 25: 0, expected 9.9377</span></span>
<span class="line"><span>2025-03-28 04:49:30.269552: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.271968 3481103 buffer_comparator.cc:156] Difference at 16: 0, expected 9.17386</span></span>
<span class="line"><span>E0000 00:00:1743137370.271984 3481103 buffer_comparator.cc:156] Difference at 17: 0, expected 8.63962</span></span>
<span class="line"><span>E0000 00:00:1743137370.271989 3481103 buffer_comparator.cc:156] Difference at 18: 0, expected 11.0889</span></span>
<span class="line"><span>E0000 00:00:1743137370.271994 3481103 buffer_comparator.cc:156] Difference at 19: 0, expected 8.96333</span></span>
<span class="line"><span>E0000 00:00:1743137370.271998 3481103 buffer_comparator.cc:156] Difference at 20: 0, expected 8.01067</span></span>
<span class="line"><span>E0000 00:00:1743137370.272002 3481103 buffer_comparator.cc:156] Difference at 21: 0, expected 11.0277</span></span>
<span class="line"><span>E0000 00:00:1743137370.272006 3481103 buffer_comparator.cc:156] Difference at 22: 0, expected 7.61027</span></span>
<span class="line"><span>E0000 00:00:1743137370.272011 3481103 buffer_comparator.cc:156] Difference at 23: 0, expected 7.70495</span></span>
<span class="line"><span>E0000 00:00:1743137370.272015 3481103 buffer_comparator.cc:156] Difference at 24: 0, expected 10.9025</span></span>
<span class="line"><span>E0000 00:00:1743137370.272021 3481103 buffer_comparator.cc:156] Difference at 25: 0, expected 9.9377</span></span>
<span class="line"><span>2025-03-28 04:49:30.272028: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.274243 3481103 buffer_comparator.cc:156] Difference at 32: 0, expected 9.26776</span></span>
<span class="line"><span>E0000 00:00:1743137370.274259 3481103 buffer_comparator.cc:156] Difference at 33: 0, expected 9.1446</span></span>
<span class="line"><span>E0000 00:00:1743137370.274263 3481103 buffer_comparator.cc:156] Difference at 34: 0, expected 9.79374</span></span>
<span class="line"><span>E0000 00:00:1743137370.274268 3481103 buffer_comparator.cc:156] Difference at 35: 0, expected 10.23</span></span>
<span class="line"><span>E0000 00:00:1743137370.274272 3481103 buffer_comparator.cc:156] Difference at 36: 0, expected 10.448</span></span>
<span class="line"><span>E0000 00:00:1743137370.274277 3481103 buffer_comparator.cc:156] Difference at 37: 0, expected 11.8017</span></span>
<span class="line"><span>E0000 00:00:1743137370.274281 3481103 buffer_comparator.cc:156] Difference at 38: 0, expected 9.69309</span></span>
<span class="line"><span>E0000 00:00:1743137370.274286 3481103 buffer_comparator.cc:156] Difference at 39: 0, expected 11.2277</span></span>
<span class="line"><span>E0000 00:00:1743137370.274290 3481103 buffer_comparator.cc:156] Difference at 40: 0, expected 10.0359</span></span>
<span class="line"><span>E0000 00:00:1743137370.274294 3481103 buffer_comparator.cc:156] Difference at 41: 0, expected 9.30719</span></span>
<span class="line"><span>2025-03-28 04:49:30.274301: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.276512 3481103 buffer_comparator.cc:156] Difference at 32: 0, expected 9.26776</span></span>
<span class="line"><span>E0000 00:00:1743137370.276528 3481103 buffer_comparator.cc:156] Difference at 33: 0, expected 9.1446</span></span>
<span class="line"><span>E0000 00:00:1743137370.276533 3481103 buffer_comparator.cc:156] Difference at 34: 0, expected 9.79374</span></span>
<span class="line"><span>E0000 00:00:1743137370.276537 3481103 buffer_comparator.cc:156] Difference at 35: 0, expected 10.23</span></span>
<span class="line"><span>E0000 00:00:1743137370.276542 3481103 buffer_comparator.cc:156] Difference at 36: 0, expected 10.448</span></span>
<span class="line"><span>E0000 00:00:1743137370.276546 3481103 buffer_comparator.cc:156] Difference at 37: 0, expected 11.8017</span></span>
<span class="line"><span>E0000 00:00:1743137370.276551 3481103 buffer_comparator.cc:156] Difference at 38: 0, expected 9.69309</span></span>
<span class="line"><span>E0000 00:00:1743137370.276555 3481103 buffer_comparator.cc:156] Difference at 39: 0, expected 11.2277</span></span>
<span class="line"><span>E0000 00:00:1743137370.276559 3481103 buffer_comparator.cc:156] Difference at 40: 0, expected 10.0359</span></span>
<span class="line"><span>E0000 00:00:1743137370.276564 3481103 buffer_comparator.cc:156] Difference at 41: 0, expected 9.30719</span></span>
<span class="line"><span>2025-03-28 04:49:30.276570: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.278780 3481103 buffer_comparator.cc:156] Difference at 32: 0, expected 9.26776</span></span>
<span class="line"><span>E0000 00:00:1743137370.278796 3481103 buffer_comparator.cc:156] Difference at 33: 0, expected 9.1446</span></span>
<span class="line"><span>E0000 00:00:1743137370.278800 3481103 buffer_comparator.cc:156] Difference at 34: 0, expected 9.79374</span></span>
<span class="line"><span>E0000 00:00:1743137370.278805 3481103 buffer_comparator.cc:156] Difference at 35: 0, expected 10.23</span></span>
<span class="line"><span>E0000 00:00:1743137370.278809 3481103 buffer_comparator.cc:156] Difference at 36: 0, expected 10.448</span></span>
<span class="line"><span>E0000 00:00:1743137370.278814 3481103 buffer_comparator.cc:156] Difference at 37: 0, expected 11.8017</span></span>
<span class="line"><span>E0000 00:00:1743137370.278818 3481103 buffer_comparator.cc:156] Difference at 38: 0, expected 9.69309</span></span>
<span class="line"><span>E0000 00:00:1743137370.278822 3481103 buffer_comparator.cc:156] Difference at 39: 0, expected 11.2277</span></span>
<span class="line"><span>E0000 00:00:1743137370.278827 3481103 buffer_comparator.cc:156] Difference at 40: 0, expected 10.0359</span></span>
<span class="line"><span>E0000 00:00:1743137370.278831 3481103 buffer_comparator.cc:156] Difference at 41: 0, expected 9.30719</span></span>
<span class="line"><span>2025-03-28 04:49:30.278838: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.296365 3481103 buffer_comparator.cc:156] Difference at 16: 0, expected 11.6059</span></span>
<span class="line"><span>E0000 00:00:1743137370.296399 3481103 buffer_comparator.cc:156] Difference at 17: 0, expected 14.502</span></span>
<span class="line"><span>E0000 00:00:1743137370.296403 3481103 buffer_comparator.cc:156] Difference at 18: 0, expected 11.2449</span></span>
<span class="line"><span>E0000 00:00:1743137370.296406 3481103 buffer_comparator.cc:156] Difference at 19: 0, expected 10.0998</span></span>
<span class="line"><span>E0000 00:00:1743137370.296409 3481103 buffer_comparator.cc:156] Difference at 20: 0, expected 14.0222</span></span>
<span class="line"><span>E0000 00:00:1743137370.296412 3481103 buffer_comparator.cc:156] Difference at 21: 0, expected 10.1321</span></span>
<span class="line"><span>E0000 00:00:1743137370.296415 3481103 buffer_comparator.cc:156] Difference at 22: 0, expected 10.2986</span></span>
<span class="line"><span>E0000 00:00:1743137370.296418 3481103 buffer_comparator.cc:156] Difference at 23: 0, expected 14.1109</span></span>
<span class="line"><span>E0000 00:00:1743137370.296421 3481103 buffer_comparator.cc:156] Difference at 24: 0, expected 13.3463</span></span>
<span class="line"><span>E0000 00:00:1743137370.296424 3481103 buffer_comparator.cc:156] Difference at 25: 0, expected 12.8369</span></span>
<span class="line"><span>2025-03-28 04:49:30.296432: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.299361 3481103 buffer_comparator.cc:156] Difference at 16: 0, expected 11.6059</span></span>
<span class="line"><span>E0000 00:00:1743137370.299373 3481103 buffer_comparator.cc:156] Difference at 17: 0, expected 14.502</span></span>
<span class="line"><span>E0000 00:00:1743137370.299376 3481103 buffer_comparator.cc:156] Difference at 18: 0, expected 11.2449</span></span>
<span class="line"><span>E0000 00:00:1743137370.299379 3481103 buffer_comparator.cc:156] Difference at 19: 0, expected 10.0998</span></span>
<span class="line"><span>E0000 00:00:1743137370.299382 3481103 buffer_comparator.cc:156] Difference at 20: 0, expected 14.0222</span></span>
<span class="line"><span>E0000 00:00:1743137370.299385 3481103 buffer_comparator.cc:156] Difference at 21: 0, expected 10.1321</span></span>
<span class="line"><span>E0000 00:00:1743137370.299388 3481103 buffer_comparator.cc:156] Difference at 22: 0, expected 10.2986</span></span>
<span class="line"><span>E0000 00:00:1743137370.299391 3481103 buffer_comparator.cc:156] Difference at 23: 0, expected 14.1109</span></span>
<span class="line"><span>E0000 00:00:1743137370.299394 3481103 buffer_comparator.cc:156] Difference at 24: 0, expected 13.3463</span></span>
<span class="line"><span>E0000 00:00:1743137370.299397 3481103 buffer_comparator.cc:156] Difference at 25: 0, expected 12.8369</span></span>
<span class="line"><span>2025-03-28 04:49:30.299401: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.302337 3481103 buffer_comparator.cc:156] Difference at 16: 0, expected 11.6059</span></span>
<span class="line"><span>E0000 00:00:1743137370.302349 3481103 buffer_comparator.cc:156] Difference at 17: 0, expected 14.502</span></span>
<span class="line"><span>E0000 00:00:1743137370.302352 3481103 buffer_comparator.cc:156] Difference at 18: 0, expected 11.2449</span></span>
<span class="line"><span>E0000 00:00:1743137370.302355 3481103 buffer_comparator.cc:156] Difference at 19: 0, expected 10.0998</span></span>
<span class="line"><span>E0000 00:00:1743137370.302358 3481103 buffer_comparator.cc:156] Difference at 20: 0, expected 14.0222</span></span>
<span class="line"><span>E0000 00:00:1743137370.302361 3481103 buffer_comparator.cc:156] Difference at 21: 0, expected 10.1321</span></span>
<span class="line"><span>E0000 00:00:1743137370.302364 3481103 buffer_comparator.cc:156] Difference at 22: 0, expected 10.2986</span></span>
<span class="line"><span>E0000 00:00:1743137370.302367 3481103 buffer_comparator.cc:156] Difference at 23: 0, expected 14.1109</span></span>
<span class="line"><span>E0000 00:00:1743137370.302370 3481103 buffer_comparator.cc:156] Difference at 24: 0, expected 13.3463</span></span>
<span class="line"><span>E0000 00:00:1743137370.302373 3481103 buffer_comparator.cc:156] Difference at 25: 0, expected 12.8369</span></span>
<span class="line"><span>2025-03-28 04:49:30.302377: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.305297 3481103 buffer_comparator.cc:156] Difference at 32: 0, expected 12.4</span></span>
<span class="line"><span>E0000 00:00:1743137370.305308 3481103 buffer_comparator.cc:156] Difference at 33: 0, expected 12.9454</span></span>
<span class="line"><span>E0000 00:00:1743137370.305312 3481103 buffer_comparator.cc:156] Difference at 34: 0, expected 12.9462</span></span>
<span class="line"><span>E0000 00:00:1743137370.305314 3481103 buffer_comparator.cc:156] Difference at 35: 0, expected 13.9775</span></span>
<span class="line"><span>E0000 00:00:1743137370.305317 3481103 buffer_comparator.cc:156] Difference at 36: 0, expected 15.0433</span></span>
<span class="line"><span>E0000 00:00:1743137370.305322 3481103 buffer_comparator.cc:156] Difference at 37: 0, expected 12.0589</span></span>
<span class="line"><span>E0000 00:00:1743137370.305325 3481103 buffer_comparator.cc:156] Difference at 38: 0, expected 14.4629</span></span>
<span class="line"><span>E0000 00:00:1743137370.305328 3481103 buffer_comparator.cc:156] Difference at 39: 0, expected 12.7671</span></span>
<span class="line"><span>E0000 00:00:1743137370.305331 3481103 buffer_comparator.cc:156] Difference at 40: 0, expected 12.3584</span></span>
<span class="line"><span>E0000 00:00:1743137370.305334 3481103 buffer_comparator.cc:156] Difference at 41: 0, expected 11.6002</span></span>
<span class="line"><span>2025-03-28 04:49:30.305338: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.308299 3481103 buffer_comparator.cc:156] Difference at 32: 0, expected 12.4</span></span>
<span class="line"><span>E0000 00:00:1743137370.308311 3481103 buffer_comparator.cc:156] Difference at 33: 0, expected 12.9454</span></span>
<span class="line"><span>E0000 00:00:1743137370.308314 3481103 buffer_comparator.cc:156] Difference at 34: 0, expected 12.9462</span></span>
<span class="line"><span>E0000 00:00:1743137370.308317 3481103 buffer_comparator.cc:156] Difference at 35: 0, expected 13.9775</span></span>
<span class="line"><span>E0000 00:00:1743137370.308320 3481103 buffer_comparator.cc:156] Difference at 36: 0, expected 15.0433</span></span>
<span class="line"><span>E0000 00:00:1743137370.308323 3481103 buffer_comparator.cc:156] Difference at 37: 0, expected 12.0589</span></span>
<span class="line"><span>E0000 00:00:1743137370.308326 3481103 buffer_comparator.cc:156] Difference at 38: 0, expected 14.4629</span></span>
<span class="line"><span>E0000 00:00:1743137370.308329 3481103 buffer_comparator.cc:156] Difference at 39: 0, expected 12.7671</span></span>
<span class="line"><span>E0000 00:00:1743137370.308332 3481103 buffer_comparator.cc:156] Difference at 40: 0, expected 12.3584</span></span>
<span class="line"><span>E0000 00:00:1743137370.308334 3481103 buffer_comparator.cc:156] Difference at 41: 0, expected 11.6002</span></span>
<span class="line"><span>2025-03-28 04:49:30.308339: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.311367 3481103 buffer_comparator.cc:156] Difference at 32: 0, expected 12.4</span></span>
<span class="line"><span>E0000 00:00:1743137370.311379 3481103 buffer_comparator.cc:156] Difference at 33: 0, expected 12.9454</span></span>
<span class="line"><span>E0000 00:00:1743137370.311382 3481103 buffer_comparator.cc:156] Difference at 34: 0, expected 12.9462</span></span>
<span class="line"><span>E0000 00:00:1743137370.311385 3481103 buffer_comparator.cc:156] Difference at 35: 0, expected 13.9775</span></span>
<span class="line"><span>E0000 00:00:1743137370.311388 3481103 buffer_comparator.cc:156] Difference at 36: 0, expected 15.0433</span></span>
<span class="line"><span>E0000 00:00:1743137370.311391 3481103 buffer_comparator.cc:156] Difference at 37: 0, expected 12.0589</span></span>
<span class="line"><span>E0000 00:00:1743137370.311394 3481103 buffer_comparator.cc:156] Difference at 38: 0, expected 14.4629</span></span>
<span class="line"><span>E0000 00:00:1743137370.311397 3481103 buffer_comparator.cc:156] Difference at 39: 0, expected 12.7671</span></span>
<span class="line"><span>E0000 00:00:1743137370.311400 3481103 buffer_comparator.cc:156] Difference at 40: 0, expected 12.3584</span></span>
<span class="line"><span>E0000 00:00:1743137370.311403 3481103 buffer_comparator.cc:156] Difference at 41: 0, expected 11.6002</span></span>
<span class="line"><span>2025-03-28 04:49:30.311407: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.325760 3481103 buffer_comparator.cc:156] Difference at 1024: 13.9198, expected 0.527629</span></span>
<span class="line"><span>E0000 00:00:1743137370.325779 3481103 buffer_comparator.cc:156] Difference at 1025: 12.3296, expected 0.544573</span></span>
<span class="line"><span>E0000 00:00:1743137370.325782 3481103 buffer_comparator.cc:156] Difference at 1026: 15.039, expected 0.31953</span></span>
<span class="line"><span>E0000 00:00:1743137370.325785 3481103 buffer_comparator.cc:156] Difference at 1027: 14.2357, expected 0.61527</span></span>
<span class="line"><span>E0000 00:00:1743137370.325788 3481103 buffer_comparator.cc:156] Difference at 1028: 10.1686, expected 1.06241</span></span>
<span class="line"><span>E0000 00:00:1743137370.325791 3481103 buffer_comparator.cc:156] Difference at 1029: 13.0036, expected 1.22093</span></span>
<span class="line"><span>E0000 00:00:1743137370.325795 3481103 buffer_comparator.cc:156] Difference at 1030: 13.3221, expected 0.553754</span></span>
<span class="line"><span>E0000 00:00:1743137370.325798 3481103 buffer_comparator.cc:156] Difference at 1031: 11.1666, expected 0.665092</span></span>
<span class="line"><span>E0000 00:00:1743137370.325801 3481103 buffer_comparator.cc:156] Difference at 1032: 14.2729, expected 1.13956</span></span>
<span class="line"><span>E0000 00:00:1743137370.325805 3481103 buffer_comparator.cc:156] Difference at 1033: 11.9378, expected 0.481583</span></span>
<span class="line"><span>2025-03-28 04:49:30.325811: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.333966 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 7.32342</span></span>
<span class="line"><span>E0000 00:00:1743137370.333980 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 10.2674</span></span>
<span class="line"><span>E0000 00:00:1743137370.333983 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 8.76472</span></span>
<span class="line"><span>E0000 00:00:1743137370.333986 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 8.04411</span></span>
<span class="line"><span>E0000 00:00:1743137370.333989 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 7.44869</span></span>
<span class="line"><span>E0000 00:00:1743137370.333992 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 8.01524</span></span>
<span class="line"><span>E0000 00:00:1743137370.333994 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 10.2221</span></span>
<span class="line"><span>E0000 00:00:1743137370.333997 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 7.96118</span></span>
<span class="line"><span>E0000 00:00:1743137370.334000 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 8.62185</span></span>
<span class="line"><span>E0000 00:00:1743137370.334003 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 8.94114</span></span>
<span class="line"><span>2025-03-28 04:49:30.334008: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.336123 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 7.32342</span></span>
<span class="line"><span>E0000 00:00:1743137370.336134 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 10.2674</span></span>
<span class="line"><span>E0000 00:00:1743137370.336138 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 8.76472</span></span>
<span class="line"><span>E0000 00:00:1743137370.336141 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 8.04411</span></span>
<span class="line"><span>E0000 00:00:1743137370.336143 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 7.44869</span></span>
<span class="line"><span>E0000 00:00:1743137370.336146 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 8.01524</span></span>
<span class="line"><span>E0000 00:00:1743137370.336149 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 10.2221</span></span>
<span class="line"><span>E0000 00:00:1743137370.336152 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 7.96118</span></span>
<span class="line"><span>E0000 00:00:1743137370.336154 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 8.62185</span></span>
<span class="line"><span>E0000 00:00:1743137370.336157 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 8.94114</span></span>
<span class="line"><span>2025-03-28 04:49:30.336161: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.338289 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 7.32342</span></span>
<span class="line"><span>E0000 00:00:1743137370.338300 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 10.2674</span></span>
<span class="line"><span>E0000 00:00:1743137370.338304 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 8.76472</span></span>
<span class="line"><span>E0000 00:00:1743137370.338306 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 8.04411</span></span>
<span class="line"><span>E0000 00:00:1743137370.338309 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 7.44869</span></span>
<span class="line"><span>E0000 00:00:1743137370.338312 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 8.01524</span></span>
<span class="line"><span>E0000 00:00:1743137370.338314 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 10.2221</span></span>
<span class="line"><span>E0000 00:00:1743137370.338317 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 7.96118</span></span>
<span class="line"><span>E0000 00:00:1743137370.338320 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 8.62185</span></span>
<span class="line"><span>E0000 00:00:1743137370.338322 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 8.94114</span></span>
<span class="line"><span>2025-03-28 04:49:30.338327: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.340443 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 7.79614</span></span>
<span class="line"><span>E0000 00:00:1743137370.340454 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 8.40799</span></span>
<span class="line"><span>E0000 00:00:1743137370.340457 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 7.73293</span></span>
<span class="line"><span>E0000 00:00:1743137370.340459 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 9.69584</span></span>
<span class="line"><span>E0000 00:00:1743137370.340462 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 8.80404</span></span>
<span class="line"><span>E0000 00:00:1743137370.340465 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 10.1025</span></span>
<span class="line"><span>E0000 00:00:1743137370.340468 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 8.25699</span></span>
<span class="line"><span>E0000 00:00:1743137370.340471 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 8.00626</span></span>
<span class="line"><span>E0000 00:00:1743137370.340473 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 8.86599</span></span>
<span class="line"><span>E0000 00:00:1743137370.340476 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.81407</span></span>
<span class="line"><span>2025-03-28 04:49:30.340480: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.342598 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 7.79614</span></span>
<span class="line"><span>E0000 00:00:1743137370.342610 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 8.40799</span></span>
<span class="line"><span>E0000 00:00:1743137370.342613 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 7.73293</span></span>
<span class="line"><span>E0000 00:00:1743137370.342616 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 9.69584</span></span>
<span class="line"><span>E0000 00:00:1743137370.342618 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 8.80404</span></span>
<span class="line"><span>E0000 00:00:1743137370.342621 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 10.1025</span></span>
<span class="line"><span>E0000 00:00:1743137370.342624 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 8.25699</span></span>
<span class="line"><span>E0000 00:00:1743137370.342627 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 8.00626</span></span>
<span class="line"><span>E0000 00:00:1743137370.342629 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 8.86599</span></span>
<span class="line"><span>E0000 00:00:1743137370.342632 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.81407</span></span>
<span class="line"><span>2025-03-28 04:49:30.342636: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.344754 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 7.79614</span></span>
<span class="line"><span>E0000 00:00:1743137370.344764 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 8.40799</span></span>
<span class="line"><span>E0000 00:00:1743137370.344767 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 7.73293</span></span>
<span class="line"><span>E0000 00:00:1743137370.344770 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 9.69584</span></span>
<span class="line"><span>E0000 00:00:1743137370.344773 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 8.80404</span></span>
<span class="line"><span>E0000 00:00:1743137370.344775 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 10.1025</span></span>
<span class="line"><span>E0000 00:00:1743137370.344778 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 8.25699</span></span>
<span class="line"><span>E0000 00:00:1743137370.344781 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 8.00626</span></span>
<span class="line"><span>E0000 00:00:1743137370.344784 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 8.86599</span></span>
<span class="line"><span>E0000 00:00:1743137370.344786 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.81407</span></span>
<span class="line"><span>2025-03-28 04:49:30.344791: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.372851 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 9.278</span></span>
<span class="line"><span>E0000 00:00:1743137370.372895 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 9.69724</span></span>
<span class="line"><span>E0000 00:00:1743137370.372900 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 10.7774</span></span>
<span class="line"><span>E0000 00:00:1743137370.372903 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 10.3636</span></span>
<span class="line"><span>E0000 00:00:1743137370.372906 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 7.56533</span></span>
<span class="line"><span>E0000 00:00:1743137370.372909 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 8.17756</span></span>
<span class="line"><span>E0000 00:00:1743137370.372911 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 11.0551</span></span>
<span class="line"><span>E0000 00:00:1743137370.372914 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 11.628</span></span>
<span class="line"><span>E0000 00:00:1743137370.372917 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 10.6715</span></span>
<span class="line"><span>E0000 00:00:1743137370.372920 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 10.8131</span></span>
<span class="line"><span>2025-03-28 04:49:30.372929: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.375058 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 9.278</span></span>
<span class="line"><span>E0000 00:00:1743137370.375069 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 9.69724</span></span>
<span class="line"><span>E0000 00:00:1743137370.375072 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 10.7774</span></span>
<span class="line"><span>E0000 00:00:1743137370.375075 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 10.3636</span></span>
<span class="line"><span>E0000 00:00:1743137370.375078 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 7.56533</span></span>
<span class="line"><span>E0000 00:00:1743137370.375081 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 8.17756</span></span>
<span class="line"><span>E0000 00:00:1743137370.375084 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 11.0551</span></span>
<span class="line"><span>E0000 00:00:1743137370.375086 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 11.628</span></span>
<span class="line"><span>E0000 00:00:1743137370.375089 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 10.6715</span></span>
<span class="line"><span>E0000 00:00:1743137370.375092 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 10.8131</span></span>
<span class="line"><span>2025-03-28 04:49:30.375096: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.377221 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 9.278</span></span>
<span class="line"><span>E0000 00:00:1743137370.377232 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 9.69724</span></span>
<span class="line"><span>E0000 00:00:1743137370.377235 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 10.7774</span></span>
<span class="line"><span>E0000 00:00:1743137370.377238 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 10.3636</span></span>
<span class="line"><span>E0000 00:00:1743137370.377241 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 7.56533</span></span>
<span class="line"><span>E0000 00:00:1743137370.377244 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 8.17756</span></span>
<span class="line"><span>E0000 00:00:1743137370.377246 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 11.0551</span></span>
<span class="line"><span>E0000 00:00:1743137370.377249 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 11.628</span></span>
<span class="line"><span>E0000 00:00:1743137370.377252 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 10.6715</span></span>
<span class="line"><span>E0000 00:00:1743137370.377255 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 10.8131</span></span>
<span class="line"><span>2025-03-28 04:49:30.377259: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.379373 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 10.5897</span></span>
<span class="line"><span>E0000 00:00:1743137370.379384 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 8.79857</span></span>
<span class="line"><span>E0000 00:00:1743137370.379387 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 10.7009</span></span>
<span class="line"><span>E0000 00:00:1743137370.379390 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 10.0423</span></span>
<span class="line"><span>E0000 00:00:1743137370.379393 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 10.3055</span></span>
<span class="line"><span>E0000 00:00:1743137370.379398 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 11.1027</span></span>
<span class="line"><span>E0000 00:00:1743137370.379401 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 9.64939</span></span>
<span class="line"><span>E0000 00:00:1743137370.379403 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 10.2558</span></span>
<span class="line"><span>E0000 00:00:1743137370.379406 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 8.38055</span></span>
<span class="line"><span>E0000 00:00:1743137370.379409 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.92221</span></span>
<span class="line"><span>2025-03-28 04:49:30.379413: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.381554 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 10.5897</span></span>
<span class="line"><span>E0000 00:00:1743137370.381567 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 8.79857</span></span>
<span class="line"><span>E0000 00:00:1743137370.381570 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 10.7009</span></span>
<span class="line"><span>E0000 00:00:1743137370.381573 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 10.0423</span></span>
<span class="line"><span>E0000 00:00:1743137370.381576 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 10.3055</span></span>
<span class="line"><span>E0000 00:00:1743137370.381579 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 11.1027</span></span>
<span class="line"><span>E0000 00:00:1743137370.381581 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 9.64939</span></span>
<span class="line"><span>E0000 00:00:1743137370.381584 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 10.2558</span></span>
<span class="line"><span>E0000 00:00:1743137370.381587 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 8.38055</span></span>
<span class="line"><span>E0000 00:00:1743137370.381589 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.92221</span></span>
<span class="line"><span>2025-03-28 04:49:30.381594: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.383741 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 10.5897</span></span>
<span class="line"><span>E0000 00:00:1743137370.383753 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 8.79857</span></span>
<span class="line"><span>E0000 00:00:1743137370.383757 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 10.7009</span></span>
<span class="line"><span>E0000 00:00:1743137370.383760 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 10.0423</span></span>
<span class="line"><span>E0000 00:00:1743137370.383762 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 10.3055</span></span>
<span class="line"><span>E0000 00:00:1743137370.383765 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 11.1027</span></span>
<span class="line"><span>E0000 00:00:1743137370.383768 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 9.64939</span></span>
<span class="line"><span>E0000 00:00:1743137370.383771 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 10.2558</span></span>
<span class="line"><span>E0000 00:00:1743137370.383773 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 8.38055</span></span>
<span class="line"><span>E0000 00:00:1743137370.383776 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.92221</span></span>
<span class="line"><span>2025-03-28 04:49:30.383781: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.385909 3481103 buffer_comparator.cc:156] Difference at 64: -nan, expected 8.4725</span></span>
<span class="line"><span>E0000 00:00:1743137370.385920 3481103 buffer_comparator.cc:156] Difference at 65: -nan, expected 8.00729</span></span>
<span class="line"><span>E0000 00:00:1743137370.385923 3481103 buffer_comparator.cc:156] Difference at 66: -nan, expected 10.5558</span></span>
<span class="line"><span>E0000 00:00:1743137370.385926 3481103 buffer_comparator.cc:156] Difference at 67: -nan, expected 7.97013</span></span>
<span class="line"><span>E0000 00:00:1743137370.385928 3481103 buffer_comparator.cc:156] Difference at 68: -nan, expected 9.17677</span></span>
<span class="line"><span>E0000 00:00:1743137370.385931 3481103 buffer_comparator.cc:156] Difference at 69: -nan, expected 6.91094</span></span>
<span class="line"><span>E0000 00:00:1743137370.385934 3481103 buffer_comparator.cc:156] Difference at 70: -nan, expected 7.85311</span></span>
<span class="line"><span>E0000 00:00:1743137370.385936 3481103 buffer_comparator.cc:156] Difference at 71: -nan, expected 8.69839</span></span>
<span class="line"><span>E0000 00:00:1743137370.385941 3481103 buffer_comparator.cc:156] Difference at 72: -nan, expected 9.37233</span></span>
<span class="line"><span>E0000 00:00:1743137370.385944 3481103 buffer_comparator.cc:156] Difference at 73: -nan, expected 7.56939</span></span>
<span class="line"><span>2025-03-28 04:49:30.385948: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.388073 3481103 buffer_comparator.cc:156] Difference at 64: -nan, expected 8.4725</span></span>
<span class="line"><span>E0000 00:00:1743137370.388084 3481103 buffer_comparator.cc:156] Difference at 65: -nan, expected 8.00729</span></span>
<span class="line"><span>E0000 00:00:1743137370.388087 3481103 buffer_comparator.cc:156] Difference at 66: -nan, expected 10.5558</span></span>
<span class="line"><span>E0000 00:00:1743137370.388090 3481103 buffer_comparator.cc:156] Difference at 67: -nan, expected 7.97013</span></span>
<span class="line"><span>E0000 00:00:1743137370.388092 3481103 buffer_comparator.cc:156] Difference at 68: -nan, expected 9.17677</span></span>
<span class="line"><span>E0000 00:00:1743137370.388095 3481103 buffer_comparator.cc:156] Difference at 69: -nan, expected 6.91094</span></span>
<span class="line"><span>E0000 00:00:1743137370.388098 3481103 buffer_comparator.cc:156] Difference at 70: -nan, expected 7.85311</span></span>
<span class="line"><span>E0000 00:00:1743137370.388100 3481103 buffer_comparator.cc:156] Difference at 71: -nan, expected 8.69839</span></span>
<span class="line"><span>E0000 00:00:1743137370.388103 3481103 buffer_comparator.cc:156] Difference at 72: -nan, expected 9.37233</span></span>
<span class="line"><span>E0000 00:00:1743137370.388106 3481103 buffer_comparator.cc:156] Difference at 73: -nan, expected 7.56939</span></span>
<span class="line"><span>2025-03-28 04:49:30.388110: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.390241 3481103 buffer_comparator.cc:156] Difference at 64: -nan, expected 8.4725</span></span>
<span class="line"><span>E0000 00:00:1743137370.390252 3481103 buffer_comparator.cc:156] Difference at 65: -nan, expected 8.00729</span></span>
<span class="line"><span>E0000 00:00:1743137370.390256 3481103 buffer_comparator.cc:156] Difference at 66: -nan, expected 10.5558</span></span>
<span class="line"><span>E0000 00:00:1743137370.390259 3481103 buffer_comparator.cc:156] Difference at 67: -nan, expected 7.97013</span></span>
<span class="line"><span>E0000 00:00:1743137370.390263 3481103 buffer_comparator.cc:156] Difference at 68: -nan, expected 9.17677</span></span>
<span class="line"><span>E0000 00:00:1743137370.390266 3481103 buffer_comparator.cc:156] Difference at 69: -nan, expected 6.91094</span></span>
<span class="line"><span>E0000 00:00:1743137370.390268 3481103 buffer_comparator.cc:156] Difference at 70: -nan, expected 7.85311</span></span>
<span class="line"><span>E0000 00:00:1743137370.390271 3481103 buffer_comparator.cc:156] Difference at 71: -nan, expected 8.69839</span></span>
<span class="line"><span>E0000 00:00:1743137370.390274 3481103 buffer_comparator.cc:156] Difference at 72: -nan, expected 9.37233</span></span>
<span class="line"><span>E0000 00:00:1743137370.390278 3481103 buffer_comparator.cc:156] Difference at 73: -nan, expected 7.56939</span></span>
<span class="line"><span>2025-03-28 04:49:30.390283: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.397292 3481103 buffer_comparator.cc:156] Difference at 17: 9.32088, expected 7.11199</span></span>
<span class="line"><span>E0000 00:00:1743137370.397328 3481103 buffer_comparator.cc:156] Difference at 21: 7.08398, expected 9.39119</span></span>
<span class="line"><span>E0000 00:00:1743137370.397331 3481103 buffer_comparator.cc:156] Difference at 22: 7.37219, expected 9.38334</span></span>
<span class="line"><span>E0000 00:00:1743137370.397334 3481103 buffer_comparator.cc:156] Difference at 24: 6.74966, expected 8.44799</span></span>
<span class="line"><span>E0000 00:00:1743137370.397337 3481103 buffer_comparator.cc:156] Difference at 26: 7.50065, expected 9.26022</span></span>
<span class="line"><span>E0000 00:00:1743137370.397340 3481103 buffer_comparator.cc:156] Difference at 27: 7.63766, expected 9.09301</span></span>
<span class="line"><span>E0000 00:00:1743137370.397343 3481103 buffer_comparator.cc:156] Difference at 28: 7.32136, expected 9.93336</span></span>
<span class="line"><span>E0000 00:00:1743137370.397346 3481103 buffer_comparator.cc:156] Difference at 29: 6.62533, expected 9.39435</span></span>
<span class="line"><span>E0000 00:00:1743137370.397348 3481103 buffer_comparator.cc:156] Difference at 30: 8.2956, expected 9.51389</span></span>
<span class="line"><span>E0000 00:00:1743137370.397351 3481103 buffer_comparator.cc:156] Difference at 34: 10.3938, expected 7.48572</span></span>
<span class="line"><span>2025-03-28 04:49:30.397360: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.399498 3481103 buffer_comparator.cc:156] Difference at 17: 9.32088, expected 7.11199</span></span>
<span class="line"><span>E0000 00:00:1743137370.399514 3481103 buffer_comparator.cc:156] Difference at 21: 7.08398, expected 9.39119</span></span>
<span class="line"><span>E0000 00:00:1743137370.399518 3481103 buffer_comparator.cc:156] Difference at 22: 7.37219, expected 9.38334</span></span>
<span class="line"><span>E0000 00:00:1743137370.399520 3481103 buffer_comparator.cc:156] Difference at 24: 6.74966, expected 8.44799</span></span>
<span class="line"><span>E0000 00:00:1743137370.399523 3481103 buffer_comparator.cc:156] Difference at 26: 7.50065, expected 9.26022</span></span>
<span class="line"><span>E0000 00:00:1743137370.399526 3481103 buffer_comparator.cc:156] Difference at 27: 7.63766, expected 9.09301</span></span>
<span class="line"><span>E0000 00:00:1743137370.399529 3481103 buffer_comparator.cc:156] Difference at 28: 7.32136, expected 9.93336</span></span>
<span class="line"><span>E0000 00:00:1743137370.399532 3481103 buffer_comparator.cc:156] Difference at 29: 6.62533, expected 9.39435</span></span>
<span class="line"><span>E0000 00:00:1743137370.399534 3481103 buffer_comparator.cc:156] Difference at 30: 8.2956, expected 9.51389</span></span>
<span class="line"><span>E0000 00:00:1743137370.399537 3481103 buffer_comparator.cc:156] Difference at 34: 10.3938, expected 7.48572</span></span>
<span class="line"><span>2025-03-28 04:49:30.399544: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.401671 3481103 buffer_comparator.cc:156] Difference at 34: 10.3938, expected 7.48572</span></span>
<span class="line"><span>E0000 00:00:1743137370.401683 3481103 buffer_comparator.cc:156] Difference at 39: 8.70204, expected 7.6147</span></span>
<span class="line"><span>E0000 00:00:1743137370.401686 3481103 buffer_comparator.cc:156] Difference at 40: 10.1065, expected 6.04756</span></span>
<span class="line"><span>E0000 00:00:1743137370.401689 3481103 buffer_comparator.cc:156] Difference at 41: 10.7572, expected 7.8893</span></span>
<span class="line"><span>E0000 00:00:1743137370.401692 3481103 buffer_comparator.cc:156] Difference at 43: 10.7753, expected 7.69612</span></span>
<span class="line"><span>E0000 00:00:1743137370.401695 3481103 buffer_comparator.cc:156] Difference at 44: 9.91027, expected 8.503</span></span>
<span class="line"><span>E0000 00:00:1743137370.401698 3481103 buffer_comparator.cc:156] Difference at 45: 10.2077, expected 8.12358</span></span>
<span class="line"><span>E0000 00:00:1743137370.401701 3481103 buffer_comparator.cc:156] Difference at 46: 10.7749, expected 7.84264</span></span>
<span class="line"><span>E0000 00:00:1743137370.401704 3481103 buffer_comparator.cc:156] Difference at 48: 9.44041, expected 7.26336</span></span>
<span class="line"><span>E0000 00:00:1743137370.401707 3481103 buffer_comparator.cc:156] Difference at 49: 9.96615, expected 6.98996</span></span>
<span class="line"><span>2025-03-28 04:49:30.401711: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.403857 3481103 buffer_comparator.cc:156] Difference at 34: 10.3938, expected 7.48572</span></span>
<span class="line"><span>E0000 00:00:1743137370.403868 3481103 buffer_comparator.cc:156] Difference at 39: 8.70204, expected 7.6147</span></span>
<span class="line"><span>E0000 00:00:1743137370.403871 3481103 buffer_comparator.cc:156] Difference at 40: 10.1065, expected 6.04756</span></span>
<span class="line"><span>E0000 00:00:1743137370.403875 3481103 buffer_comparator.cc:156] Difference at 41: 10.7572, expected 7.8893</span></span>
<span class="line"><span>E0000 00:00:1743137370.403878 3481103 buffer_comparator.cc:156] Difference at 43: 10.7753, expected 7.69612</span></span>
<span class="line"><span>E0000 00:00:1743137370.403881 3481103 buffer_comparator.cc:156] Difference at 44: 9.91027, expected 8.503</span></span>
<span class="line"><span>E0000 00:00:1743137370.403883 3481103 buffer_comparator.cc:156] Difference at 45: 10.2077, expected 8.12358</span></span>
<span class="line"><span>E0000 00:00:1743137370.403886 3481103 buffer_comparator.cc:156] Difference at 46: 10.7749, expected 7.84264</span></span>
<span class="line"><span>E0000 00:00:1743137370.403889 3481103 buffer_comparator.cc:156] Difference at 48: 9.44041, expected 7.26336</span></span>
<span class="line"><span>E0000 00:00:1743137370.403892 3481103 buffer_comparator.cc:156] Difference at 49: 9.96615, expected 6.98996</span></span>
<span class="line"><span>2025-03-28 04:49:30.403896: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.406034 3481103 buffer_comparator.cc:156] Difference at 67: 10.5021, expected 7.70695</span></span>
<span class="line"><span>E0000 00:00:1743137370.406047 3481103 buffer_comparator.cc:156] Difference at 68: 10.1174, expected 9.00042</span></span>
<span class="line"><span>E0000 00:00:1743137370.406062 3481103 buffer_comparator.cc:156] Difference at 69: 9.89636, expected 8.345</span></span>
<span class="line"><span>E0000 00:00:1743137370.406065 3481103 buffer_comparator.cc:156] Difference at 70: 10.5296, expected 8.52479</span></span>
<span class="line"><span>E0000 00:00:1743137370.406068 3481103 buffer_comparator.cc:156] Difference at 71: 8.1412, expected 7.08541</span></span>
<span class="line"><span>E0000 00:00:1743137370.406071 3481103 buffer_comparator.cc:156] Difference at 72: 6.85179, expected 8.47292</span></span>
<span class="line"><span>E0000 00:00:1743137370.406074 3481103 buffer_comparator.cc:156] Difference at 77: 7.45304, expected 9.28323</span></span>
<span class="line"><span>E0000 00:00:1743137370.406077 3481103 buffer_comparator.cc:156] Difference at 80: 7.39802, expected 9.4894</span></span>
<span class="line"><span>E0000 00:00:1743137370.406080 3481103 buffer_comparator.cc:156] Difference at 81: 9.68936, expected 7.49939</span></span>
<span class="line"><span>E0000 00:00:1743137370.406082 3481103 buffer_comparator.cc:156] Difference at 82: 9.2677, expected 6.28629</span></span>
<span class="line"><span>2025-03-28 04:49:30.406087: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.408207 3481103 buffer_comparator.cc:156] Difference at 67: 10.5021, expected 7.70695</span></span>
<span class="line"><span>E0000 00:00:1743137370.408219 3481103 buffer_comparator.cc:156] Difference at 68: 10.1174, expected 9.00042</span></span>
<span class="line"><span>E0000 00:00:1743137370.408222 3481103 buffer_comparator.cc:156] Difference at 69: 9.89636, expected 8.345</span></span>
<span class="line"><span>E0000 00:00:1743137370.408225 3481103 buffer_comparator.cc:156] Difference at 70: 10.5296, expected 8.52479</span></span>
<span class="line"><span>E0000 00:00:1743137370.408228 3481103 buffer_comparator.cc:156] Difference at 71: 8.1412, expected 7.08541</span></span>
<span class="line"><span>E0000 00:00:1743137370.408231 3481103 buffer_comparator.cc:156] Difference at 72: 6.85179, expected 8.47292</span></span>
<span class="line"><span>E0000 00:00:1743137370.408234 3481103 buffer_comparator.cc:156] Difference at 77: 7.45304, expected 9.28323</span></span>
<span class="line"><span>E0000 00:00:1743137370.408236 3481103 buffer_comparator.cc:156] Difference at 80: 7.39802, expected 9.4894</span></span>
<span class="line"><span>E0000 00:00:1743137370.408239 3481103 buffer_comparator.cc:156] Difference at 81: 9.68936, expected 7.49939</span></span>
<span class="line"><span>E0000 00:00:1743137370.408242 3481103 buffer_comparator.cc:156] Difference at 82: 9.2677, expected 6.28629</span></span>
<span class="line"><span>2025-03-28 04:49:30.408246: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.410263 3481103 buffer_comparator.cc:156] Difference at 67: 10.5021, expected 7.70695</span></span>
<span class="line"><span>E0000 00:00:1743137370.410275 3481103 buffer_comparator.cc:156] Difference at 68: 10.1174, expected 9.00042</span></span>
<span class="line"><span>E0000 00:00:1743137370.410278 3481103 buffer_comparator.cc:156] Difference at 69: 9.89636, expected 8.345</span></span>
<span class="line"><span>E0000 00:00:1743137370.410281 3481103 buffer_comparator.cc:156] Difference at 70: 10.5296, expected 8.52479</span></span>
<span class="line"><span>E0000 00:00:1743137370.410284 3481103 buffer_comparator.cc:156] Difference at 71: 8.1412, expected 7.08541</span></span>
<span class="line"><span>E0000 00:00:1743137370.410287 3481103 buffer_comparator.cc:156] Difference at 72: 6.85179, expected 8.47292</span></span>
<span class="line"><span>E0000 00:00:1743137370.410290 3481103 buffer_comparator.cc:156] Difference at 77: 7.45304, expected 9.28323</span></span>
<span class="line"><span>E0000 00:00:1743137370.410293 3481103 buffer_comparator.cc:156] Difference at 80: 7.39802, expected 9.4894</span></span>
<span class="line"><span>E0000 00:00:1743137370.410296 3481103 buffer_comparator.cc:156] Difference at 81: 9.68936, expected 7.49939</span></span>
<span class="line"><span>E0000 00:00:1743137370.410298 3481103 buffer_comparator.cc:156] Difference at 82: 9.2677, expected 6.28629</span></span>
<span class="line"><span>2025-03-28 04:49:30.410303: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.411958 3481103 buffer_comparator.cc:156] Difference at 128: 8.2391, expected 10.3054</span></span>
<span class="line"><span>E0000 00:00:1743137370.411970 3481103 buffer_comparator.cc:156] Difference at 129: 8.47949, expected 9.87733</span></span>
<span class="line"><span>E0000 00:00:1743137370.411973 3481103 buffer_comparator.cc:156] Difference at 133: 8.18623, expected 9.79527</span></span>
<span class="line"><span>E0000 00:00:1743137370.411976 3481103 buffer_comparator.cc:156] Difference at 138: 6.64546, expected 8.48491</span></span>
<span class="line"><span>E0000 00:00:1743137370.411980 3481103 buffer_comparator.cc:156] Difference at 139: 8.57118, expected 7.35965</span></span>
<span class="line"><span>E0000 00:00:1743137370.411983 3481103 buffer_comparator.cc:156] Difference at 141: 8.57626, expected 7.30194</span></span>
<span class="line"><span>E0000 00:00:1743137370.411986 3481103 buffer_comparator.cc:156] Difference at 142: 8.50319, expected 7.45738</span></span>
<span class="line"><span>E0000 00:00:1743137370.411989 3481103 buffer_comparator.cc:156] Difference at 144: 8.42517, expected 7.38918</span></span>
<span class="line"><span>E0000 00:00:1743137370.411992 3481103 buffer_comparator.cc:156] Difference at 146: 9.43345, expected 7.98069</span></span>
<span class="line"><span>E0000 00:00:1743137370.411994 3481103 buffer_comparator.cc:156] Difference at 147: 7.98762, expected 9.22175</span></span>
<span class="line"><span>2025-03-28 04:49:30.411999: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.413747 3481103 buffer_comparator.cc:156] Difference at 128: 8.2391, expected 10.3054</span></span>
<span class="line"><span>E0000 00:00:1743137370.413759 3481103 buffer_comparator.cc:156] Difference at 129: 8.47949, expected 9.87733</span></span>
<span class="line"><span>E0000 00:00:1743137370.413762 3481103 buffer_comparator.cc:156] Difference at 133: 8.18623, expected 9.79527</span></span>
<span class="line"><span>E0000 00:00:1743137370.413765 3481103 buffer_comparator.cc:156] Difference at 138: 6.64546, expected 8.48491</span></span>
<span class="line"><span>E0000 00:00:1743137370.413768 3481103 buffer_comparator.cc:156] Difference at 139: 8.57118, expected 7.35965</span></span>
<span class="line"><span>E0000 00:00:1743137370.413770 3481103 buffer_comparator.cc:156] Difference at 141: 8.57626, expected 7.30194</span></span>
<span class="line"><span>E0000 00:00:1743137370.413773 3481103 buffer_comparator.cc:156] Difference at 142: 8.50319, expected 7.45738</span></span>
<span class="line"><span>E0000 00:00:1743137370.413776 3481103 buffer_comparator.cc:156] Difference at 144: 8.42517, expected 7.38918</span></span>
<span class="line"><span>E0000 00:00:1743137370.413779 3481103 buffer_comparator.cc:156] Difference at 146: 9.43345, expected 7.98069</span></span>
<span class="line"><span>E0000 00:00:1743137370.413782 3481103 buffer_comparator.cc:156] Difference at 147: 7.98762, expected 9.22175</span></span>
<span class="line"><span>2025-03-28 04:49:30.413786: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.419594 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 8.81126</span></span>
<span class="line"><span>E0000 00:00:1743137370.419609 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 10.499</span></span>
<span class="line"><span>E0000 00:00:1743137370.419613 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 9.85809</span></span>
<span class="line"><span>E0000 00:00:1743137370.419615 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 8.65377</span></span>
<span class="line"><span>E0000 00:00:1743137370.419618 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 10.0279</span></span>
<span class="line"><span>E0000 00:00:1743137370.419621 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 9.616</span></span>
<span class="line"><span>E0000 00:00:1743137370.419624 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 11.4222</span></span>
<span class="line"><span>E0000 00:00:1743137370.419627 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 8.99654</span></span>
<span class="line"><span>E0000 00:00:1743137370.419629 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 10.1518</span></span>
<span class="line"><span>E0000 00:00:1743137370.419632 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 9.78295</span></span>
<span class="line"><span>2025-03-28 04:49:30.419637: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.421290 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 8.81126</span></span>
<span class="line"><span>E0000 00:00:1743137370.421301 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 10.499</span></span>
<span class="line"><span>E0000 00:00:1743137370.421305 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 9.85809</span></span>
<span class="line"><span>E0000 00:00:1743137370.421307 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 8.65377</span></span>
<span class="line"><span>E0000 00:00:1743137370.421310 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 10.0279</span></span>
<span class="line"><span>E0000 00:00:1743137370.421313 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 9.616</span></span>
<span class="line"><span>E0000 00:00:1743137370.421316 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 11.4222</span></span>
<span class="line"><span>E0000 00:00:1743137370.421320 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 8.99654</span></span>
<span class="line"><span>E0000 00:00:1743137370.421323 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 10.1518</span></span>
<span class="line"><span>E0000 00:00:1743137370.421326 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 9.78295</span></span>
<span class="line"><span>2025-03-28 04:49:30.421330: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.422977 3481103 buffer_comparator.cc:156] Difference at 16: -nan, expected 8.81126</span></span>
<span class="line"><span>E0000 00:00:1743137370.422989 3481103 buffer_comparator.cc:156] Difference at 17: -nan, expected 10.499</span></span>
<span class="line"><span>E0000 00:00:1743137370.422992 3481103 buffer_comparator.cc:156] Difference at 18: -nan, expected 9.85809</span></span>
<span class="line"><span>E0000 00:00:1743137370.422995 3481103 buffer_comparator.cc:156] Difference at 19: -nan, expected 8.65377</span></span>
<span class="line"><span>E0000 00:00:1743137370.422997 3481103 buffer_comparator.cc:156] Difference at 20: -nan, expected 10.0279</span></span>
<span class="line"><span>E0000 00:00:1743137370.423000 3481103 buffer_comparator.cc:156] Difference at 21: -nan, expected 9.616</span></span>
<span class="line"><span>E0000 00:00:1743137370.423003 3481103 buffer_comparator.cc:156] Difference at 22: -nan, expected 11.4222</span></span>
<span class="line"><span>E0000 00:00:1743137370.423006 3481103 buffer_comparator.cc:156] Difference at 23: -nan, expected 8.99654</span></span>
<span class="line"><span>E0000 00:00:1743137370.423008 3481103 buffer_comparator.cc:156] Difference at 24: -nan, expected 10.1518</span></span>
<span class="line"><span>E0000 00:00:1743137370.423011 3481103 buffer_comparator.cc:156] Difference at 25: -nan, expected 9.78295</span></span>
<span class="line"><span>2025-03-28 04:49:30.423015: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.424670 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 8.20589</span></span>
<span class="line"><span>E0000 00:00:1743137370.424681 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 9.19448</span></span>
<span class="line"><span>E0000 00:00:1743137370.424684 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 8.03576</span></span>
<span class="line"><span>E0000 00:00:1743137370.424687 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 10.6612</span></span>
<span class="line"><span>E0000 00:00:1743137370.424690 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 9.50115</span></span>
<span class="line"><span>E0000 00:00:1743137370.424692 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 10.8965</span></span>
<span class="line"><span>E0000 00:00:1743137370.424695 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 9.00596</span></span>
<span class="line"><span>E0000 00:00:1743137370.424698 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 7.25269</span></span>
<span class="line"><span>E0000 00:00:1743137370.424701 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 9.67287</span></span>
<span class="line"><span>E0000 00:00:1743137370.424703 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.30318</span></span>
<span class="line"><span>2025-03-28 04:49:30.424708: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.426350 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 8.20589</span></span>
<span class="line"><span>E0000 00:00:1743137370.426361 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 9.19448</span></span>
<span class="line"><span>E0000 00:00:1743137370.426364 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 8.03576</span></span>
<span class="line"><span>E0000 00:00:1743137370.426367 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 10.6612</span></span>
<span class="line"><span>E0000 00:00:1743137370.426370 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 9.50115</span></span>
<span class="line"><span>E0000 00:00:1743137370.426372 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 10.8965</span></span>
<span class="line"><span>E0000 00:00:1743137370.426375 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 9.00596</span></span>
<span class="line"><span>E0000 00:00:1743137370.426378 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 7.25269</span></span>
<span class="line"><span>E0000 00:00:1743137370.426381 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 9.67287</span></span>
<span class="line"><span>E0000 00:00:1743137370.426383 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.30318</span></span>
<span class="line"><span>2025-03-28 04:49:30.426390: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>E0000 00:00:1743137370.428038 3481103 buffer_comparator.cc:156] Difference at 32: -nan, expected 8.20589</span></span>
<span class="line"><span>E0000 00:00:1743137370.428049 3481103 buffer_comparator.cc:156] Difference at 33: -nan, expected 9.19448</span></span>
<span class="line"><span>E0000 00:00:1743137370.428052 3481103 buffer_comparator.cc:156] Difference at 34: -nan, expected 8.03576</span></span>
<span class="line"><span>E0000 00:00:1743137370.428055 3481103 buffer_comparator.cc:156] Difference at 35: -nan, expected 10.6612</span></span>
<span class="line"><span>E0000 00:00:1743137370.428058 3481103 buffer_comparator.cc:156] Difference at 36: -nan, expected 9.50115</span></span>
<span class="line"><span>E0000 00:00:1743137370.428061 3481103 buffer_comparator.cc:156] Difference at 37: -nan, expected 10.8965</span></span>
<span class="line"><span>E0000 00:00:1743137370.428064 3481103 buffer_comparator.cc:156] Difference at 38: -nan, expected 9.00596</span></span>
<span class="line"><span>E0000 00:00:1743137370.428066 3481103 buffer_comparator.cc:156] Difference at 39: -nan, expected 7.25269</span></span>
<span class="line"><span>E0000 00:00:1743137370.428069 3481103 buffer_comparator.cc:156] Difference at 40: -nan, expected 9.67287</span></span>
<span class="line"><span>E0000 00:00:1743137370.428072 3481103 buffer_comparator.cc:156] Difference at 41: -nan, expected 7.30318</span></span>
<span class="line"><span>2025-03-28 04:49:30.428076: E external/xla/xla/service/gpu/autotuning/gemm_fusion_autotuner.cc:1137] Results do not match the reference. This is likely a bug/unexpected loss of precision.</span></span>
<span class="line"><span>Iteration: [     1/ 50000] 	 Loss: 3.153872967 (3.153872967) 	 Physics Loss: 1.977264166 (1.977264166) 	 Data Loss: 0.578239620 (0.578239620) 	 BC Loss: 0.598369122 (0.598369122)</span></span>
<span class="line"><span>Iteration: [  1001/ 50000] 	 Loss: 0.037203494 (0.029109152) 	 Physics Loss: 0.000550530 (0.000358969) 	 Data Loss: 0.023778778 (0.012030440) 	 BC Loss: 0.012874187 (0.016719742)</span></span>
<span class="line"><span>Iteration: [  2001/ 50000] 	 Loss: 0.030779511 (0.034423992) 	 Physics Loss: 0.000592207 (0.001774628) 	 Data Loss: 0.014397524 (0.013753930) 	 BC Loss: 0.015789781 (0.018895429)</span></span>
<span class="line"><span>Iteration: [  3001/ 50000] 	 Loss: 0.021841470 (0.027056616) 	 Physics Loss: 0.000522536 (0.004873221) 	 Data Loss: 0.004614574 (0.008088700) 	 BC Loss: 0.016704362 (0.014094692)</span></span>
<span class="line"><span>Iteration: [  4001/ 50000] 	 Loss: 0.038582101 (0.034729011) 	 Physics Loss: 0.003376254 (0.002704982) 	 Data Loss: 0.014301238 (0.012586679) 	 BC Loss: 0.020904612 (0.019437356)</span></span>
<span class="line"><span>Iteration: [  5001/ 50000] 	 Loss: 0.027363494 (0.057518166) 	 Physics Loss: 0.006317818 (0.028009484) 	 Data Loss: 0.009285189 (0.011741836) 	 BC Loss: 0.011760486 (0.017766841)</span></span>
<span class="line"><span>Iteration: [  6001/ 50000] 	 Loss: 0.024195662 (0.019290088) 	 Physics Loss: 0.000576330 (0.000937816) 	 Data Loss: 0.005862516 (0.006385402) 	 BC Loss: 0.017756816 (0.011966869)</span></span>
<span class="line"><span>Iteration: [  7001/ 50000] 	 Loss: 0.015304947 (0.019078610) 	 Physics Loss: 0.001520974 (0.001128703) 	 Data Loss: 0.005780942 (0.006937551) 	 BC Loss: 0.008003032 (0.011012357)</span></span>
<span class="line"><span>Iteration: [  8001/ 50000] 	 Loss: 0.018056616 (0.016851155) 	 Physics Loss: 0.000815929 (0.001745509) 	 Data Loss: 0.003489140 (0.004778590) 	 BC Loss: 0.013751546 (0.010327056)</span></span>
<span class="line"><span>Iteration: [  9001/ 50000] 	 Loss: 0.019105814 (0.016347572) 	 Physics Loss: 0.001103567 (0.001558701) 	 Data Loss: 0.002615690 (0.004747680) 	 BC Loss: 0.015386556 (0.010041193)</span></span>
<span class="line"><span>Iteration: [ 10001/ 50000] 	 Loss: 0.011850247 (0.016185638) 	 Physics Loss: 0.001527360 (0.002253429) 	 Data Loss: 0.004485745 (0.004699244) 	 BC Loss: 0.005837142 (0.009232965)</span></span>
<span class="line"><span>Iteration: [ 11001/ 50000] 	 Loss: 0.017559819 (0.014584152) 	 Physics Loss: 0.001138550 (0.001371698) 	 Data Loss: 0.004524786 (0.004185131) 	 BC Loss: 0.011896483 (0.009027325)</span></span>
<span class="line"><span>Iteration: [ 12001/ 50000] 	 Loss: 0.014435371 (0.013971340) 	 Physics Loss: 0.001502353 (0.001294284) 	 Data Loss: 0.006330506 (0.004238269) 	 BC Loss: 0.006602511 (0.008438786)</span></span>
<span class="line"><span>Iteration: [ 13001/ 50000] 	 Loss: 0.007569676 (0.013424525) 	 Physics Loss: 0.001393272 (0.001443758) 	 Data Loss: 0.001905998 (0.003799081) 	 BC Loss: 0.004270406 (0.008181685)</span></span>
<span class="line"><span>Iteration: [ 14001/ 50000] 	 Loss: 0.008399807 (0.012269501) 	 Physics Loss: 0.000874100 (0.001270473) 	 Data Loss: 0.003854776 (0.003514751) 	 BC Loss: 0.003670931 (0.007484275)</span></span>
<span class="line"><span>Iteration: [ 15001/ 50000] 	 Loss: 0.012854995 (0.012447622) 	 Physics Loss: 0.000962182 (0.001374702) 	 Data Loss: 0.000483413 (0.003976720) 	 BC Loss: 0.011409399 (0.007096201)</span></span>
<span class="line"><span>Iteration: [ 16001/ 50000] 	 Loss: 0.008248669 (0.013208234) 	 Physics Loss: 0.001395914 (0.001164462) 	 Data Loss: 0.003623560 (0.003468768) 	 BC Loss: 0.003229195 (0.008575005)</span></span>
<span class="line"><span>Iteration: [ 17001/ 50000] 	 Loss: 0.005129706 (0.012013515) 	 Physics Loss: 0.000699974 (0.001131699) 	 Data Loss: 0.000917939 (0.003342754) 	 BC Loss: 0.003511793 (0.007539063)</span></span>
<span class="line"><span>Iteration: [ 18001/ 50000] 	 Loss: 0.016537888 (0.010515220) 	 Physics Loss: 0.001252979 (0.001072636) 	 Data Loss: 0.004219135 (0.002489778) 	 BC Loss: 0.011065774 (0.006952806)</span></span>
<span class="line"><span>Iteration: [ 19001/ 50000] 	 Loss: 0.010813366 (0.012705814) 	 Physics Loss: 0.001188082 (0.001193895) 	 Data Loss: 0.003777510 (0.002822159) 	 BC Loss: 0.005847774 (0.008689760)</span></span>
<span class="line"><span>Iteration: [ 20001/ 50000] 	 Loss: 0.005427668 (0.011710118) 	 Physics Loss: 0.001577919 (0.001387226) 	 Data Loss: 0.002568154 (0.002168224) 	 BC Loss: 0.001281594 (0.008154668)</span></span>
<span class="line"><span>Iteration: [ 21001/ 50000] 	 Loss: 0.006487023 (0.010208706) 	 Physics Loss: 0.001401789 (0.001660767) 	 Data Loss: 0.001722868 (0.002501602) 	 BC Loss: 0.003362367 (0.006046339)</span></span>
<span class="line"><span>Iteration: [ 22001/ 50000] 	 Loss: 0.009437616 (0.010694695) 	 Physics Loss: 0.001765511 (0.001500460) 	 Data Loss: 0.005958611 (0.001754927) 	 BC Loss: 0.001713495 (0.007439307)</span></span>
<span class="line"><span>Iteration: [ 23001/ 50000] 	 Loss: 0.013743464 (0.008254445) 	 Physics Loss: 0.002180674 (0.001913983) 	 Data Loss: 0.004219715 (0.002065712) 	 BC Loss: 0.007343076 (0.004274749)</span></span>
<span class="line"><span>Iteration: [ 24001/ 50000] 	 Loss: 0.014256330 (0.008225464) 	 Physics Loss: 0.001869628 (0.001696485) 	 Data Loss: 0.000880123 (0.001554014) 	 BC Loss: 0.011506579 (0.004974965)</span></span>
<span class="line"><span>Iteration: [ 25001/ 50000] 	 Loss: 0.005411615 (0.006930466) 	 Physics Loss: 0.001179156 (0.001798108) 	 Data Loss: 0.000670032 (0.001461951) 	 BC Loss: 0.003562426 (0.003670407)</span></span>
<span class="line"><span>Iteration: [ 26001/ 50000] 	 Loss: 0.006880802 (0.005627883) 	 Physics Loss: 0.001134805 (0.001795200) 	 Data Loss: 0.000952239 (0.001306181) 	 BC Loss: 0.004793759 (0.002526500)</span></span>
<span class="line"><span>Iteration: [ 27001/ 50000] 	 Loss: 0.007057397 (0.005158458) 	 Physics Loss: 0.000736209 (0.001526923) 	 Data Loss: 0.001355446 (0.001198944) 	 BC Loss: 0.004965742 (0.002432592)</span></span>
<span class="line"><span>Iteration: [ 28001/ 50000] 	 Loss: 0.002918471 (0.004430990) 	 Physics Loss: 0.001545964 (0.001843499) 	 Data Loss: 0.000570738 (0.001045180) 	 BC Loss: 0.000801769 (0.001542311)</span></span>
<span class="line"><span>Iteration: [ 29001/ 50000] 	 Loss: 0.003383059 (0.003222783) 	 Physics Loss: 0.001546039 (0.001197281) 	 Data Loss: 0.001057410 (0.000871451) 	 BC Loss: 0.000779610 (0.001154052)</span></span>
<span class="line"><span>Iteration: [ 30001/ 50000] 	 Loss: 0.003592887 (0.003187301) 	 Physics Loss: 0.001639638 (0.001459631) 	 Data Loss: 0.000699877 (0.000813704) 	 BC Loss: 0.001253372 (0.000913966)</span></span>
<span class="line"><span>Iteration: [ 31001/ 50000] 	 Loss: 0.002682653 (0.002753643) 	 Physics Loss: 0.000679309 (0.001226370) 	 Data Loss: 0.000449619 (0.000731408) 	 BC Loss: 0.001553725 (0.000795864)</span></span>
<span class="line"><span>Iteration: [ 32001/ 50000] 	 Loss: 0.005353532 (0.003093726) 	 Physics Loss: 0.003998624 (0.001627845) 	 Data Loss: 0.000485983 (0.000814618) 	 BC Loss: 0.000868925 (0.000651262)</span></span>
<span class="line"><span>Iteration: [ 33001/ 50000] 	 Loss: 0.001863127 (0.002165305) 	 Physics Loss: 0.000551163 (0.001070478) 	 Data Loss: 0.000602129 (0.000578883) 	 BC Loss: 0.000709834 (0.000515945)</span></span>
<span class="line"><span>Iteration: [ 34001/ 50000] 	 Loss: 0.001789484 (0.002187706) 	 Physics Loss: 0.000852895 (0.001082061) 	 Data Loss: 0.000387473 (0.000637523) 	 BC Loss: 0.000549116 (0.000468122)</span></span>
<span class="line"><span>Iteration: [ 35001/ 50000] 	 Loss: 0.000949289 (0.001767912) 	 Physics Loss: 0.000569952 (0.000929367) 	 Data Loss: 0.000198365 (0.000504372) 	 BC Loss: 0.000180972 (0.000334173)</span></span>
<span class="line"><span>Iteration: [ 36001/ 50000] 	 Loss: 0.002945340 (0.001718901) 	 Physics Loss: 0.001339663 (0.000954814) 	 Data Loss: 0.001226619 (0.000454665) 	 BC Loss: 0.000379057 (0.000309422)</span></span>
<span class="line"><span>Iteration: [ 37001/ 50000] 	 Loss: 0.001214534 (0.001479726) 	 Physics Loss: 0.000422838 (0.000726230) 	 Data Loss: 0.000534357 (0.000504710) 	 BC Loss: 0.000257339 (0.000248787)</span></span>
<span class="line"><span>Iteration: [ 38001/ 50000] 	 Loss: 0.001880942 (0.001397801) 	 Physics Loss: 0.000924640 (0.000684149) 	 Data Loss: 0.000530066 (0.000463928) 	 BC Loss: 0.000426236 (0.000249725)</span></span>
<span class="line"><span>Iteration: [ 39001/ 50000] 	 Loss: 0.001347756 (0.001421823) 	 Physics Loss: 0.000728663 (0.000679449) 	 Data Loss: 0.000345473 (0.000504370) 	 BC Loss: 0.000273620 (0.000238003)</span></span>
<span class="line"><span>Iteration: [ 40001/ 50000] 	 Loss: 0.001802240 (0.001479169) 	 Physics Loss: 0.001196385 (0.000767612) 	 Data Loss: 0.000447591 (0.000483108) 	 BC Loss: 0.000158264 (0.000228449)</span></span>
<span class="line"><span>Iteration: [ 41001/ 50000] 	 Loss: 0.001352749 (0.001697045) 	 Physics Loss: 0.000932642 (0.000977645) 	 Data Loss: 0.000314114 (0.000515789) 	 BC Loss: 0.000105992 (0.000203611)</span></span>
<span class="line"><span>Iteration: [ 42001/ 50000] 	 Loss: 0.001608718 (0.001346420) 	 Physics Loss: 0.001242280 (0.000718649) 	 Data Loss: 0.000229054 (0.000422413) 	 BC Loss: 0.000137383 (0.000205358)</span></span>
<span class="line"><span>Iteration: [ 43001/ 50000] 	 Loss: 0.000952899 (0.001501483) 	 Physics Loss: 0.000515131 (0.000807861) 	 Data Loss: 0.000285539 (0.000429003) 	 BC Loss: 0.000152229 (0.000264619)</span></span>
<span class="line"><span>Iteration: [ 44001/ 50000] 	 Loss: 0.000931397 (0.001297562) 	 Physics Loss: 0.000534546 (0.000711467) 	 Data Loss: 0.000204832 (0.000406957) 	 BC Loss: 0.000192019 (0.000179138)</span></span>
<span class="line"><span>Iteration: [ 45001/ 50000] 	 Loss: 0.001132066 (0.001029962) 	 Physics Loss: 0.000462024 (0.000488499) 	 Data Loss: 0.000538058 (0.000379111) 	 BC Loss: 0.000131983 (0.000162352)</span></span>
<span class="line"><span>Iteration: [ 46001/ 50000] 	 Loss: 0.001625891 (0.001669809) 	 Physics Loss: 0.001002158 (0.001080601) 	 Data Loss: 0.000345248 (0.000392433) 	 BC Loss: 0.000278485 (0.000196775)</span></span>
<span class="line"><span>Iteration: [ 47001/ 50000] 	 Loss: 0.001482891 (0.001004653) 	 Physics Loss: 0.000928177 (0.000492962) 	 Data Loss: 0.000446164 (0.000375494) 	 BC Loss: 0.000108550 (0.000136197)</span></span>
<span class="line"><span>Iteration: [ 48001/ 50000] 	 Loss: 0.001417234 (0.001158843) 	 Physics Loss: 0.000884422 (0.000662071) 	 Data Loss: 0.000195326 (0.000363015) 	 BC Loss: 0.000337487 (0.000133758)</span></span>
<span class="line"><span>Iteration: [ 49001/ 50000] 	 Loss: 0.001132041 (0.001062525) 	 Physics Loss: 0.000717354 (0.000549186) 	 Data Loss: 0.000253737 (0.000361861) 	 BC Loss: 0.000160949 (0.000151479)</span></span></code></pre></div><h2 id="Visualizing-the-Results" tabindex="-1">Visualizing the Results <a class="header-anchor" href="#Visualizing-the-Results" aria-label="Permalink to &quot;Visualizing the Results {#Visualizing-the-Results}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ts, xs, ys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([[elem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> elem </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">collect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Iterators</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">product</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xs, ys, ts)))])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u_real </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">analytical_solution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xs), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ys), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ts))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grid_normalized </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (grid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maximum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u_pred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">trained_u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grid_normalized), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xs), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ys), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ts))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u_pred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u_pred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (max_pde_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> min_pde_val) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> min_pde_val</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">begin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CairoMakie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; xlabel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    errs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(u_pred[:, :, i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u_real[:, :, i]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ts)]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; limits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(errs)))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    CairoMakie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pinn_nested_ad.gif&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ts); framerate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Abs. Predictor Error | Time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(ts[i])</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> errs[i]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        contour!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, xs, ys, err; levels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        heatmap!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, xs, ys, err)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fig</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    fig</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p><img src="/v1.11.2/assets/pinn_nested_ad.BdoPkoVA.gif" alt=""></p><h2 id="appendix" tabindex="-1">Appendix <a class="header-anchor" href="#appendix" aria-label="Permalink to &quot;Appendix&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> InteractiveUtils</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InteractiveUtils</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">versioninfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @isdefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MLDataDevices)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @isdefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CUDA) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MLDataDevices</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">functional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CUDADevice)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        CUDA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">versioninfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @isdefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AMDGPU) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MLDataDevices</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">functional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AMDGPUDevice)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        AMDGPU</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">versioninfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Julia Version 1.11.4</span></span>
<span class="line"><span>Commit 8561cc3d68d (2025-03-10 11:36 UTC)</span></span>
<span class="line"><span>Build Info:</span></span>
<span class="line"><span>  Official https://julialang.org/ release</span></span>
<span class="line"><span>Platform Info:</span></span>
<span class="line"><span>  OS: Linux (x86_64-linux-gnu)</span></span>
<span class="line"><span>  CPU: 48 × AMD EPYC 7402 24-Core Processor</span></span>
<span class="line"><span>  WORD_SIZE: 64</span></span>
<span class="line"><span>  LLVM: libLLVM-16.0.6 (ORCJIT, znver2)</span></span>
<span class="line"><span>Threads: 48 default, 0 interactive, 24 GC (on 2 virtual cores)</span></span>
<span class="line"><span>Environment:</span></span>
<span class="line"><span>  JULIA_CPU_THREADS = 2</span></span>
<span class="line"><span>  LD_LIBRARY_PATH = /usr/local/nvidia/lib:/usr/local/nvidia/lib64</span></span>
<span class="line"><span>  JULIA_PKG_SERVER = </span></span>
<span class="line"><span>  JULIA_NUM_THREADS = 48</span></span>
<span class="line"><span>  JULIA_CUDA_HARD_MEMORY_LIMIT = 100%</span></span>
<span class="line"><span>  JULIA_PKG_PRECOMPILE_AUTO = 0</span></span>
<span class="line"><span>  JULIA_DEBUG = Literate</span></span>
<span class="line"><span>  JULIA_DEPOT_PATH = /root/.cache/julia-buildkite-plugin/depots/01872db4-8c79-43af-ab7d-12abac4f24f6</span></span></code></pre></div><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/LuxDL/Lux.jl/edit/main/docs/src/tutorials/intermediate/4_PINN2DPDE.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page on GitHub<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/v1.11.2/tutorials/intermediate/3_HyperNet" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Training a HyperNetwork on MNIST and FashionMNIST</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/v1.11.2/tutorials/intermediate/5_ConvolutionalVAE" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Convolutional VAE for MNIST using Reactant</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://documenter.juliadocs.org/stable/" target="_blank"><strong>Documenter.jl</strong></a>, <a href="https://vitepress.dev" target="_blank"><strong>VitePress</strong></a> and <a href="https://luxdl.github.io/DocumenterVitepress.jl/stable" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href="https://www.julialang.org">Julia Programming Language</a>.<br></p><p class="copyright" data-v-c970a860>© Copyright 2025 Avik Pal.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_accelerator_support_mldatadevices.md\":\"CRjGmKN0\",\"api_building_blocks_luxcore.md\":\"CkEIp4Ry\",\"api_building_blocks_weightinitializers.md\":\"CPqzPnq-\",\"api_lux_autodiff.md\":\"APcbkq4T\",\"api_lux_contrib.md\":\"D_ysa58o\",\"api_lux_distributed_utils.md\":\"BC1OXFsJ\",\"api_lux_interop.md\":\"CXbXPeIC\",\"api_lux_layers.md\":\"CxcldwjE\",\"api_lux_utilities.md\":\"CciUggj8\",\"api_nn_primitives_activationfunctions.md\":\"Dx5_A4nF\",\"api_nn_primitives_luxlib.md\":\"BM55S5DB\",\"api_nn_primitives_nnlib.md\":\"Mwa5_QVM\",\"api_testing_functionality_luxtestutils.md\":\"vKv0INtp\",\"index.md\":\"CR3XfkY2\",\"introduction_citation.md\":\"pdLfmoIw\",\"introduction_index.md\":\"BgDeTMW-\",\"introduction_overview.md\":\"C5N1K3uD\",\"introduction_resources.md\":\"DIObvahC\",\"introduction_updating_to_v1.md\":\"BPCwbKoO\",\"manual_autodiff.md\":\"BYeisKku\",\"manual_compiling_lux_models.md\":\"BMUvgh2o\",\"manual_debugging.md\":\"C5i0ns_a\",\"manual_dispatch_custom_input.md\":\"CVwXZOdP\",\"manual_distributed_utils.md\":\"DqOKl18B\",\"manual_exporting_to_jax.md\":\"C1JwUE6e\",\"manual_freezing_model_parameters.md\":\"CuSd8OFZ\",\"manual_gpu_management.md\":\"DVnNFZo3\",\"manual_interface.md\":\"BLZMDv5I\",\"manual_migrate_from_flux.md\":\"iLCCcJ6k\",\"manual_nested_autodiff.md\":\"LjjH0L40\",\"manual_performance_pitfalls.md\":\"B5vwXFfO\",\"manual_preferences.md\":\"BrMLVD9_\",\"manual_visualize_lux_models.md\":\"BYKItRux\",\"manual_weight_initializers.md\":\"2vgFFFy6\",\"references.md\":\"hwdIlfkE\",\"tutorials_advanced_1_gravitationalwaveform.md\":\"bYLJ1k-1\",\"tutorials_beginner_1_basics.md\":\"Co8qFGGl\",\"tutorials_beginner_2_polynomialfitting.md\":\"CDAxMJLA\",\"tutorials_beginner_3_simplernn.md\":\"D3WdzAH1\",\"tutorials_beginner_4_simplechains.md\":\"nHH0aAvG\",\"tutorials_beginner_5_optimizationintegration.md\":\"CKtRDlf5\",\"tutorials_index.md\":\"CVcXamgP\",\"tutorials_intermediate_1_neuralode.md\":\"DKF_4TwR\",\"tutorials_intermediate_2_bayesiannn.md\":\"DJ3Iv65T\",\"tutorials_intermediate_3_hypernet.md\":\"BAw-VyoZ\",\"tutorials_intermediate_4_pinn2dpde.md\":\"BmucbYiV\",\"tutorials_intermediate_5_convolutionalvae.md\":\"3W8aUz5F\",\"tutorials_intermediate_6_gcn_cora.md\":\"BKsFdq41\",\"tutorials_intermediate_7_realnvp.md\":\"Cc6yjfSm\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Lux.jl Docs\",\"description\":\"Documentation for LuxDL Repositories\",\"base\":\"/v1.11.2/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"light\":\"/lux-logo.svg\",\"dark\":\"/lux-logo-dark.svg\"},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting Started\",\"link\":\"/introduction\"},{\"text\":\"Benchmarks\",\"link\":\"https://lux.csail.mit.edu/benchmarks/\"},{\"text\":\"Tutorials\",\"link\":\"/tutorials/\"},{\"text\":\"Manual\",\"link\":\"/manual/interface\"},{\"text\":\"API\",\"items\":[{\"text\":\"Lux\",\"items\":[{\"text\":\"Built-In Layers\",\"link\":\"/api/Lux/layers\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/api/Lux/autodiff\"},{\"text\":\"Utilities\",\"link\":\"/api/Lux/utilities\"},{\"text\":\"Experimental\",\"link\":\"/api/Lux/contrib\"},{\"text\":\"InterOp\",\"link\":\"/api/Lux/interop\"},{\"text\":\"DistributedUtils\",\"link\":\"/api/Lux/distributed_utils\"}]},{\"text\":\"Accelerator Support\",\"items\":[{\"text\":\"MLDataDevices\",\"link\":\"/api/Accelerator_Support/MLDataDevices\"}]},{\"text\":\"NN Primitives\",\"items\":[{\"text\":\"LuxLib\",\"link\":\"/api/NN_Primitives/LuxLib\"},{\"text\":\"NNlib\",\"link\":\"/api/NN_Primitives/NNlib\"},{\"text\":\"Activation Functions\",\"link\":\"/api/NN_Primitives/ActivationFunctions\"}]},{\"text\":\"Building Blocks\",\"items\":[{\"text\":\"LuxCore\",\"link\":\"/api/Building_Blocks/LuxCore\"},{\"text\":\"WeightInitializers\",\"link\":\"/api/Building_Blocks/WeightInitializers\"}]},{\"text\":\"Testing Functionality\",\"items\":[{\"text\":\"LuxTestUtils\",\"link\":\"/api/Testing_Functionality/LuxTestUtils\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":{\"/introduction/\":{\"text\":\"Getting Started\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"link\":\"/introduction\"},{\"text\":\"Overview\",\"link\":\"/introduction/overview\"},{\"text\":\"Resources\",\"link\":\"/introduction/resources\"},{\"text\":\"Updating to v1\",\"link\":\"/introduction/updating_to_v1\"},{\"text\":\"Citation\",\"link\":\"/introduction/citation\"}]},\"/tutorials/\":{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/\"},{\"text\":\"Beginner\",\"collapsed\":false,\"items\":[{\"text\":\"Julia & Lux for the Uninitiated\",\"link\":\"/tutorials/beginner/1_Basics\"},{\"text\":\"Fitting a Polynomial using MLP\",\"link\":\"/tutorials/beginner/2_PolynomialFitting\"},{\"text\":\"Training a Simple LSTM\",\"link\":\"/tutorials/beginner/3_SimpleRNN\"},{\"text\":\"MNIST Classification with SimpleChains\",\"link\":\"/tutorials/beginner/4_SimpleChains\"},{\"text\":\"Fitting with Optimization.jl\",\"link\":\"/tutorials/beginner/5_OptimizationIntegration\"}]},{\"text\":\"Intermediate\",\"collapsed\":false,\"items\":[{\"text\":\"MNIST Classification using Neural ODEs\",\"link\":\"/tutorials/intermediate/1_NeuralODE\"},{\"text\":\"Training a HyperNetwork on MNIST and FashionMNIST\",\"link\":\"/tutorials/intermediate/3_HyperNet\"},{\"text\":\"Training a PINN on 2D PDE\",\"link\":\"/tutorials/intermediate/4_PINN2DPDE\"},{\"text\":\"Convolutional VAE for MNIST using Reactant\",\"link\":\"/tutorials/intermediate/5_ConvolutionalVAE\"},{\"text\":\"Graph Convolutional Network on Cora\",\"link\":\"/tutorials/intermediate/6_GCN_Cora\"},{\"text\":\"Normalizing Flows for Density Estimation\",\"link\":\"/tutorials/intermediate/7_RealNVP\"}]},{\"text\":\"Advanced\",\"collapsed\":false,\"items\":[{\"text\":\"Training a Neural ODE to Model Gravitational Waveforms\",\"link\":\"/tutorials/advanced/1_GravitationalWaveForm\"}]},{\"text\":\"Larger Models\",\"collapsed\":true,\"items\":[{\"text\":\"Training Image Classification Models on ImageNet with Distributed Data Parallel Training\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/ImageNet\"},{\"text\":\"Training a DDIM (Diffusion Model) for Image Generation\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/DDIM\"},{\"text\":\"Different Vision Models on CIFAR-10\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/CIFAR10\"}]},{\"text\":\"3rd Party Tutorials\",\"collapsed\":true,\"items\":[{\"text\":\"PINNs (NeuralPDE.jl)\",\"link\":\"https://docs.sciml.ai/NeuralPDE/stable/tutorials/pdesystem/\"},{\"text\":\"UDEs (SciMLSensitivity.jl)\",\"link\":\"https://docs.sciml.ai/SciMLSensitivity/stable/tutorials/data_parallel/\"},{\"text\":\"Neural DEs (DiffEqFlux.jl)\",\"link\":\"https://docs.sciml.ai/DiffEqFlux/stable/examples/neural_ode/\"},{\"text\":\"DEQs (DeepEquilibriumNetworks.jl)\",\"link\":\"https://docs.sciml.ai/DeepEquilibriumNetworks/stable/tutorials/basic_mnist_deq/\"},{\"text\":\"Medical Image Segmentation\",\"link\":\"https://github.com/Dale-Black/ComputerVisionTutorials.jl/\"},{\"text\":\"Neural Closure Models\",\"link\":\"https://github.com/agdestein/NeuralClosureTutorials/\"}]}]},\"/manual/\":{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Basics\",\"items\":[{\"text\":\"Lux Interface\",\"link\":\"/manual/interface\"},{\"text\":\"Freezing Parameters\",\"link\":\"/manual/freezing_model_parameters\"},{\"text\":\"GPU Management\",\"link\":\"/manual/gpu_management\"},{\"text\":\"Initializing Weights\",\"link\":\"/manual/weight_initializers\"},{\"text\":\"Visualizing Lux Models\",\"link\":\"/manual/visualize_lux_models\"}]},{\"text\":\"Reactant Compilation\",\"items\":[{\"text\":\"Compiling Lux Models\",\"link\":\"/manual/compiling_lux_models\"},{\"text\":\"Exporting Lux Models to Jax\",\"link\":\"/manual/exporting_to_jax\"}]},{\"text\":\"Automatic Differentiation\",\"items\":[{\"text\":\"Automatic Differentiation\",\"link\":\"/manual/autodiff\"},{\"text\":\"Nested AutoDiff\",\"link\":\"/manual/nested_autodiff\"}]},{\"text\":\"Debugging / Performance Enhancement Tools\",\"items\":[{\"text\":\"Debugging Lux Models\",\"link\":\"/manual/debugging\"},{\"text\":\"Performance Pitfalls\",\"link\":\"/manual/performance_pitfalls\"}]},{\"text\":\"Migration Guides\",\"items\":[{\"text\":\"Migrating from Flux\",\"link\":\"/manual/migrate_from_flux\"}]},{\"text\":\"Advanced Usage\",\"items\":[{\"text\":\"Custom Input Types\",\"link\":\"/manual/dispatch_custom_input\"},{\"text\":\"Configuration via Preferences\",\"link\":\"/manual/preferences\"},{\"text\":\"Distributed Training\",\"link\":\"/manual/distributed_utils\"}]}]},\"/api/\":{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Lux\",\"collapsed\":false,\"items\":[{\"text\":\"Built-In Layers\",\"link\":\"/api/Lux/layers\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/api/Lux/autodiff\"},{\"text\":\"Utilities\",\"link\":\"/api/Lux/utilities\"},{\"text\":\"Experimental Features\",\"link\":\"/api/Lux/contrib\"},{\"text\":\"Interoperability\",\"link\":\"/api/Lux/interop\"},{\"text\":\"DistributedUtils\",\"link\":\"/api/Lux/distributed_utils\"}]},{\"text\":\"Accelerator Support\",\"collapsed\":false,\"items\":[{\"text\":\"MLDataDevices\",\"link\":\"/api/Accelerator_Support/MLDataDevices\"}]},{\"text\":\"NN Primitives\",\"collapsed\":false,\"items\":[{\"text\":\"LuxLib\",\"link\":\"/api/NN_Primitives/LuxLib\"},{\"text\":\"NNlib\",\"link\":\"/api/NN_Primitives/NNlib\"},{\"text\":\"Activation Functions\",\"link\":\"/api/NN_Primitives/ActivationFunctions\"}]},{\"text\":\"Building Blocks\",\"collapsed\":false,\"items\":[{\"text\":\"LuxCore\",\"link\":\"/api/Building_Blocks/LuxCore\"},{\"text\":\"WeightInitializers\",\"link\":\"/api/Building_Blocks/WeightInitializers\"}]},{\"text\":\"Testing Functionality\",\"collapsed\":false,\"items\":[{\"text\":\"LuxTestUtils\",\"link\":\"/api/Testing_Functionality/LuxTestUtils\"}]}]}},\"editLink\":{\"pattern\":\"https://github.com/LuxDL/Lux.jl/edit/main/docs/src/:path\",\"text\":\"Edit this page on GitHub\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/LuxDL/Lux.jl\"},{\"icon\":\"twitter\",\"link\":\"https://twitter.com/avikpal1410\"},{\"icon\":\"slack\",\"link\":\"https://julialang.org/slack/\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://documenter.juliadocs.org/stable/\\\" target=\\\"_blank\\\"><strong>Documenter.jl</strong></a>, <a href=\\\"https://vitepress.dev\\\" target=\\\"_blank\\\"><strong>VitePress</strong></a> and <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/stable\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href=\\\"https://www.julialang.org\\\">Julia Programming Language</a>.<br>\",\"copyright\":\"© Copyright 2025 Avik Pal.\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>