import{_ as h,C as p,o as a,c as t,j as i,a as n,E as k,al as e}from"./chunks/framework.kzDw1Qip.js";const N=JSON.parse('{"title":"Nested Automatic Differentiation","description":"","frontmatter":{},"headers":[],"relativePath":"manual/nested_autodiff.md","filePath":"manual/nested_autodiff.md","lastUpdated":null}'),d={name:"manual/nested_autodiff.md"},C={class:"MathJax",jax:"SVG",overflow:"linebreak"},r={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.697ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 750 1000"},o={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.853ex",height:"2.48ex",role:"img",focusable:"false",viewBox:"0 -846 3470.9 1096"},g={class:"MathJax",jax:"SVG",overflow:"linebreak"},E={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.097ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 485 1000"},y={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.283ex",height:"2.48ex",role:"img",focusable:"false",viewBox:"0 -846 2335.3 1096"},c={class:"MathJax",jax:"SVG",overflow:"linebreak"},m={style:{"vertical-align":"-0.679ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.931ex",height:"2.583ex",role:"img",focusable:"false",viewBox:"0 -841.7 3063.5 1141.7"},u={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.513ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1552.8 1000"},F={class:"mjx-scroll-wrapper"},f={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},b={style:{"vertical-align":"-2.705ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.692ex",height:"6.626ex",role:"img",focusable:"false",viewBox:"0 -1733 14891.7 2928.7"},L={class:"MathJax",jax:"SVG",overflow:"linebreak"},x={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.432ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 633 1000"},v={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.853ex",height:"2.48ex",role:"img",focusable:"false",viewBox:"0 -846 3470.9 1096"},_={class:"mjx-scroll-wrapper"},D={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},B={style:{"vertical-align":"-2.705ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.169ex",height:"6.626ex",role:"img",focusable:"false",viewBox:"0 -1733 9356.6 2928.7"},A={class:"MathJax",jax:"SVG",overflow:"linebreak"},w={style:{"vertical-align":"-0.661ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.843ex",height:"2.565ex",role:"img",focusable:"false",viewBox:"0 -841.7 1698.8 1133.9"},j={class:"MathJax",jax:"SVG",overflow:"linebreak"},M={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.269ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1445 840.8"},T={class:"MathJax",jax:"SVG",overflow:"linebreak"},Z={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.837ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 812 599.8"};function S(J,s,V,R,I,P){const l=p("CopyOrDownloadAsMarkdownButtons");return a(),t("div",null,[s[31]||(s[31]=i("div",{style:{display:"none"},hidden:"true","aria-hidden":"true"},"Are you an LLM? You can read better optimized documentation at /dev/manual/nested_autodiff.md for this page in Markdown format",-1)),s[32]||(s[32]=i("h1",{id:"nested_autodiff",tabindex:"-1"},[n("Nested Automatic Differentiation "),i("a",{class:"header-anchor",href:"#nested_autodiff","aria-label":'Permalink to "Nested Automatic Differentiation {#nested_autodiff}"'},"​")],-1)),k(l),s[33]||(s[33]=e("",50)),i("p",null,[s[9]||(s[9]=n("Hutchinson Trace Estimation often shows up in machine learning literature to provide a fast estimate of the trace of a Jacobian Matrix. This is based off of ",-1)),s[10]||(s[10]=i("a",{href:"https://www.nowozin.net/sebastian/blog/thoughts-on-trace-estimation-in-deep-learning.html",target:"_blank",rel:"noreferrer"},"Hutchinson 1990",-1)),s[11]||(s[11]=n(" which computes the estimated trace of a matrix ",-1)),i("mjx-container",C,[(a(),t("svg",r,[...s[0]||(s[0]=[i("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[i("g",{"data-mml-node":"math","data-latex":"A \\in \\mathbb{R}^{D \\times D}"},[i("g",{"data-mml-node":"mi","data-latex":"A"},[i("path",{"data-c":"1D434",d:"M137 3C155 3 217 0 236 0C251 0 258 8 258 23C258 32 252 38 239 39C210 40 196 50 196 69C196 78 205 98 224 128C251 173 270 206 283 228L526 228C526 221 527 207 530 185C537 112 541 72 541 67C541 48 519 39 474 39C455 39 446 31 446 15C446 5 452 0 464 0C488 0 564 3 588 3C608 3 679 0 699 0C714 0 721 8 721 24C721 34 712 39 694 39C666 39 649 41 644 44C639 47 635 56 634 71L574 689C571 708 572 716 551 716C539 716 529 710 522 697L178 120C148 70 108 43 59 39C43 38 35 30 35 15C35 5 41 0 52 0C68 0 121 3 137 3M492 577L522 267L307 267Z"})])])],-1)])])),s[2]||(s[2]=i("mjx-break",{size:"4"}," ",-1)),(a(),t("svg",o,[...s[1]||(s[1]=[e("",1)])]))]),s[12]||(s[12]=n(" using random vectors ",-1)),i("mjx-container",g,[(a(),t("svg",E,[...s[3]||(s[3]=[i("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[i("g",{"data-mml-node":"math","data-latex":"v \\in \\mathbb{R}^{D}"},[i("g",{"data-mml-node":"mi","data-latex":"v"},[i("path",{"data-c":"1D463",d:"M369 391C369 383 378 370 394 350C410 330 418 307 418 281C418 252 404 203 375 134C354 86 306 18 247 18C201 18 178 45 178 100C178 139 197 208 235 307C243 328 247 345 247 357C247 407 213 442 163 442C119 442 84 417 59 367C39 326 29 300 29 287C29 278 34 273 45 273C58 273 60 279 64 293C87 373 119 413 160 413C173 413 180 404 180 385C180 369 175 347 164 318C127 219 108 152 108 115C108 64 125 29 159 10C186-4 214-11 243-11C332-11 394 85 420 162C452 256 468 325 468 369C468 418 452 442 421 442C396 442 369 416 369 391Z"})])])],-1)])])),s[5]||(s[5]=i("mjx-break",{size:"4"}," ",-1)),(a(),t("svg",y,[...s[4]||(s[4]=[e("",1)])]))]),s[13]||(s[13]=n(" s.t. ",-1)),i("mjx-container",c,[(a(),t("svg",m,[...s[6]||(s[6]=[e("",1)])])),s[8]||(s[8]=i("mjx-break",{size:"4"}," ",-1)),(a(),t("svg",u,[...s[7]||(s[7]=[e("",1)])]))]),s[14]||(s[14]=n(".",-1))]),i("div",F,[i("mjx-container",f,[(a(),t("svg",b,[...s[15]||(s[15]=[e("",1)])]))])]),i("p",null,[s[19]||(s[19]=n("We can use this to compute the trace of a Jacobian Matrix ",-1)),i("mjx-container",L,[(a(),t("svg",x,[...s[16]||(s[16]=[i("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[i("g",{"data-mml-node":"math","data-latex":"J \\in \\mathbb{R}^{D \\times D}"},[i("g",{"data-mml-node":"mi","data-latex":"J"},[i("path",{"data-c":"1D43D",d:"M633 667C633 678 627 683 615 683C596 683 525 680 506 680L361 683C344 683 336 675 336 659C336 649 349 644 374 644C419 644 446 642 453 637C456 635 457 632 457 627C457 624 456 617 454 607L340 153C324 89 273 8 202 8C157 8 128 25 114 60L120 60C156 60 188 91 188 127C188 158 172 173 141 173C97 173 71 134 71 90C71 20 132-22 205-22C255-22 301-6 344 26C387 58 415 97 427 144L542 606C551 642 555 644 602 644C623 644 633 646 633 667Z"})])])],-1)])])),s[18]||(s[18]=i("mjx-break",{size:"4"}," ",-1)),(a(),t("svg",v,[...s[17]||(s[17]=[e("",1)])]))]),s[20]||(s[20]=n(" using the following algorithm:",-1))]),i("div",_,[i("mjx-container",D,[(a(),t("svg",B,[...s[21]||(s[21]=[e("",1)])]))])]),s[34]||(s[34]=i("p",null,"Note that we can compute this using two methods:",-1)),i("ol",null,[i("li",null,[i("p",null,[s[23]||(s[23]=n("Compute ",-1)),i("mjx-container",A,[(a(),t("svg",w,[...s[22]||(s[22]=[e("",1)])]))]),s[24]||(s[24]=n(" using a Vector-Jacobian product and then do a matrix-vector product to get the trace.",-1))])]),i("li",null,[i("p",null,[s[26]||(s[26]=n("Compute ",-1)),i("mjx-container",j,[(a(),t("svg",M,[...s[25]||(s[25]=[e("",1)])]))]),s[27]||(s[27]=n(" using a Jacobian-Vector product and then do a matrix-vector product to get the trace.",-1))])])]),i("p",null,[s[29]||(s[29]=n("For simplicity, we will use a single sample of ",-1)),i("mjx-container",T,[(a(),t("svg",Z,[...s[28]||(s[28]=[e("",1)])]))]),s[30]||(s[30]=n(" to compute the trace. Additionally, we will fix the sample to ensure that our tests against the finite difference implementation are not affected by the randomness in the sample.",-1))]),s[35]||(s[35]=e("",20))])}const G=h(d,[["render",S]]);export{N as __pageData,G as default};
