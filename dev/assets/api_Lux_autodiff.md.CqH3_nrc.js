import{_ as c,C as r,o as s,c as i,j as a,a as e,E as o,al as d,w as n}from"./chunks/framework.kzDw1Qip.js";const D=JSON.parse('{"title":"Automatic Differentiation Helpers","description":"","frontmatter":{},"headers":[],"relativePath":"api/Lux/autodiff.md","filePath":"api/Lux/autodiff.md","lastUpdated":null}'),p={name:"api/Lux/autodiff.md"},u={class:"jldocstring custom-block"},h={class:"MathJax",jax:"SVG",overflow:"linebreak"},f={style:{"vertical-align":"-1.068ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.854ex",height:"3.311ex",role:"img",focusable:"false",viewBox:"0 -991.2 3029.4 1463.2"},g={class:"jldocstring custom-block"},m={class:"MathJax",jax:"SVG",overflow:"linebreak"},x={style:{"vertical-align":"-1.068ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.791ex",height:"3.776ex",role:"img",focusable:"false",viewBox:"0 -1197 3443.5 1669"},b={class:"jldocstring custom-block"};function k(y,t,_,A,T,L){const C=r("CopyOrDownloadAsMarkdownButtons"),l=r("Badge");return s(),i("div",null,[t[20]||(t[20]=a("div",{style:{display:"none"},hidden:"true","aria-hidden":"true"},"Are you an LLM? You can read better optimized documentation at /dev/api/Lux/autodiff.md for this page in Markdown format",-1)),t[21]||(t[21]=a("h1",{id:"autodiff-lux-helpers",tabindex:"-1"},[e("Automatic Differentiation Helpers "),a("a",{class:"header-anchor",href:"#autodiff-lux-helpers","aria-label":'Permalink to "Automatic Differentiation Helpers {#autodiff-lux-helpers}"'},"​")],-1)),o(C),t[22]||(t[22]=a("h2",{id:"JVP-and-VJP-Wrappers",tabindex:"-1"},[e("JVP & VJP Wrappers "),a("a",{class:"header-anchor",href:"#JVP-and-VJP-Wrappers","aria-label":'Permalink to "JVP &amp; VJP Wrappers {#JVP-and-VJP-Wrappers}"'},"​")],-1)),a("details",u,[a("summary",null,[t[0]||(t[0]=a("a",{id:"Lux.jacobian_vector_product",href:"#Lux.jacobian_vector_product"},[a("span",{class:"jlbinding"},"Lux.jacobian_vector_product")],-1)),t[1]||(t[1]=e()),o(l,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),t[6]||(t[6]=d('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">jacobian_vector_product</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractADType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x, u)</span></span></code></pre></div>',1)),a("p",null,[t[3]||(t[3]=e("Compute the Jacobian-Vector Product ",-1)),a("mjx-container",h,[(s(),i("svg",f,[...t[2]||(t[2]=[d('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\left(\\frac{\\partial f}{\\partial x}\\right) u"><g data-mml-node="mrow" data-latex="\\left(\\frac{\\partial f}{\\partial x}\\right)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M444-472C455-472 461-466 461-455C461-449 459-445 454-442C382-387 325-294 282-164C245-53 226 57 226 164L226 336C226 443 245 552 282 664C325 793 382 886 454 942C459 945 461 949 461 955C461 966 455 972 444 972C440 972 437 971 434 968C353 905 285 809 232 681C181 560 156 445 156 336L156 164C156 55 181-60 232-181C285-310 353-405 434-468C437-471 440-472 444-472Z"></path></g><g data-mml-node="mfrac" data-latex="\\frac{\\partial f}{\\partial x}" transform="translate(523,0)"><g data-mml-node="mrow" transform="translate(227.1,485) scale(0.707)" data-latex="\\partial f"><g data-mml-node="mi" data-latex="\\partial"><path data-c="1D715" d="M256 574C256 597 241 610 212 612C243 659 288 683 347 683C439 683 484 606 484 508C484 467 476 417 461 356C444 425 401 460 334 460C257 460 190 428 130 366C70 304 40 235 40 158C40 121 53 83 79 45C110 0 158-22 225-22C315-22 390 20 449 105C505 187 566 329 566 456C566 527 548 587 512 635C473 689 418 716 349 716C282 716 232 693 198 646C171 609 157 579 157 556C157 530 171 517 199 517C229 517 256 544 256 574M439 303C439 240 420 178 381 117C338 48 287 14 228 14C162 14 124 57 124 121C124 149 131 188 145 238C159 288 173 323 188 344C228 401 277 430 334 430C407 430 439 376 439 303Z"></path></g><g data-mml-node="mi" data-latex="f" transform="translate(566,0)"><path data-c="1D453" d="M552 633C552 677 509 705 462 705C400 705 357 665 334 586C329 568 318 517 302 433L237 433C215 433 204 432 204 411C204 400 214 395 235 395L295 395L222 8C211-49 201-91 192-119C180-156 163-175 141-175C126-175 114-171 103-164C135-159 151-140 151-108C151-82 138-69 111-69C77-69 53-99 53-133C53-177 94-205 141-205C166-205 189-195 208-174C240-141 265-94 283-31C294 8 304 46 311 84L369 395L451 395C474 395 484 396 484 419C484 428 474 433 454 433L377 433C383 474 411 625 420 644C430 665 444 675 462 675C477 675 490 671 501 664C470 657 454 639 454 608C454 582 467 569 494 569C528 569 552 599 552 633Z"></path></g></g><g data-mml-node="mrow" transform="translate(220,-346.3) scale(0.707)" data-latex="\\partial x"><g data-mml-node="mi" data-latex="\\partial"><path data-c="1D715" d="M256 574C256 597 241 610 212 612C243 659 288 683 347 683C439 683 484 606 484 508C484 467 476 417 461 356C444 425 401 460 334 460C257 460 190 428 130 366C70 304 40 235 40 158C40 121 53 83 79 45C110 0 158-22 225-22C315-22 390 20 449 105C505 187 566 329 566 456C566 527 548 587 512 635C473 689 418 716 349 716C282 716 232 693 198 646C171 609 157 579 157 556C157 530 171 517 199 517C229 517 256 544 256 574M439 303C439 240 420 178 381 117C338 48 287 14 228 14C162 14 124 57 124 121C124 149 131 188 145 238C159 288 173 323 188 344C228 401 277 430 334 430C407 430 439 376 439 303Z"></path></g><g data-mml-node="mi" data-latex="x" transform="translate(566,0)"><path data-c="1D465" d="M527 373C527 419 482 442 432 442C389 442 355 419 329 373C308 419 273 442 222 442C173 442 133 419 101 374C74 335 60 306 60 287C60 278 65 273 75 273C84 273 90 278 92 287C111 345 153 413 220 413C253 413 269 392 269 351C269 330 251 252 216 118C199 51 169 18 126 18C112 18 99 21 88 26C114 36 127 54 127 80C127 106 114 119 87 119C54 119 29 91 29 58C29 12 76-11 125-11C167-11 201 12 228 58C247 12 283-11 335-11C383-11 423 12 455 57C482 96 496 125 496 144C496 153 491 158 481 158C472 158 467 153 464 144C447 87 402 18 337 18C304 18 287 38 287 79C287 92 292 120 303 165L337 300C356 375 387 413 431 413C445 413 458 410 469 405C442 396 429 378 429 351C429 325 443 312 470 312C502 312 527 341 527 373Z"></path></g></g><rect width="1004.7" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(1767.7,0)"><path data-c="29" d="M89-468C170-405 238-310 291-181C342-60 367 55 367 164L367 336C367 445 342 560 291 681C238 810 170 905 89 968C85 971 82 972 79 972C68 972 62 966 62 955C62 950 64 945 68 942C140 887 198 795 241 664C278 552 297 443 297 336L297 164C297 57 278-52 241-164C198-295 140-387 68-442C64-445 62-450 62-455C62-466 68-472 79-472C82-472 86-471 89-468Z"></path></g></g><g data-mml-node="mi" data-latex="u" transform="translate(2457.4,0)"><path data-c="1D462" d="M543 144C543 153 538 158 527 158C518 158 513 151 510 137C505 118 500 99 493 80C480 39 462 18 440 18C422 18 413 32 413 60C413 77 420 111 433 161L460 267C469 303 477 328 483 359L489 386C491 393 492 398 492 401C492 421 481 431 459 431C437 431 423 419 417 394L343 98C342 95 338 88 330 76C314 50 275 18 235 18C197 18 178 44 178 95C178 136 196 202 231 294C242 324 248 345 248 357C248 407 213 442 163 442C118 442 83 417 58 367C39 328 29 301 29 287C29 278 34 273 45 273C58 273 60 279 64 293C87 373 119 413 160 413C174 413 181 403 181 384C181 369 175 348 164 319C126 218 107 148 107 111C107 34 155-11 232-11C275-11 314 9 347 50C361 9 391-11 437-11C506-11 527 70 543 144Z"></path></g></g></g>',1)])]))]),t[4]||(t[4]=e(". This is a wrapper around AD backends but allows us to compute gradients of jacobian-vector products efficiently using mixed-mode AD.",-1))]),t[7]||(t[7]=d('<p><strong>Backends &amp; AD Packages</strong></p><table tabindex="0"><thead><tr><th style="text-align:left;">Supported Backends</th><th style="text-align:left;">Packages Needed</th><th style="text-align:left;">Notes</th></tr></thead><tbody><tr><td style="text-align:left;"><code>AutoEnzyme</code></td><td style="text-align:left;"><code>Enzyme.jl</code> / <code>Reactant.jl</code></td><td style="text-align:left;">For nested AD support directly using <code>Enzyme.jl</code>.</td></tr><tr><td style="text-align:left;"><code>AutoForwardDiff</code></td><td style="text-align:left;"></td><td style="text-align:left;"></td></tr></tbody></table><div class="warning custom-block"><p class="custom-block-title">Only for ChainRules-based AD like Zygote</p><p>Gradient wrt <code>u</code> in the reverse pass is always dropped.</p></div><p><strong>Arguments</strong></p><ul><li><p><code>f</code>: The function to compute the jacobian of.</p></li><li><p><code>backend</code>: The backend to use for computing the JVP.</p></li><li><p><code>x</code>: The input to the function.</p></li><li><p><code>u</code>: An object of the same structure as <code>x</code>.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>v</code>: The Jacobian Vector Product.</li></ul>',7)),o(l,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...t[5]||(t[5]=[a("a",{href:"https://github.com/LuxDL/Lux.jl/blob/6e188d9cf1599c6004761b22dd35ef8afac585d2/src/autodiff/api.jl#L45",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),a("details",g,[a("summary",null,[t[8]||(t[8]=a("a",{id:"Lux.vector_jacobian_product",href:"#Lux.vector_jacobian_product"},[a("span",{class:"jlbinding"},"Lux.vector_jacobian_product")],-1)),t[9]||(t[9]=e()),o(l,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),t[14]||(t[14]=d('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vector_jacobian_product</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractADType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x, u)</span></span></code></pre></div>',1)),a("p",null,[t[11]||(t[11]=e("Compute the Vector-Jacobian Product ",-1)),a("mjx-container",m,[(s(),i("svg",x,[...t[10]||(t[10]=[d('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\left(\\frac{\\partial f}{\\partial x}\\right)^T u"><g data-mml-node="msup" data-latex="\\left(\\frac{\\partial f}{\\partial x}\\right)^T"><g data-mml-node="mrow" data-latex="\\left(\\frac{\\partial f}{\\partial x}\\right)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M444-472C455-472 461-466 461-455C461-449 459-445 454-442C382-387 325-294 282-164C245-53 226 57 226 164L226 336C226 443 245 552 282 664C325 793 382 886 454 942C459 945 461 949 461 955C461 966 455 972 444 972C440 972 437 971 434 968C353 905 285 809 232 681C181 560 156 445 156 336L156 164C156 55 181-60 232-181C285-310 353-405 434-468C437-471 440-472 444-472Z"></path></g><g data-mml-node="mfrac" data-latex="\\frac{\\partial f}{\\partial x}" transform="translate(523,0)"><g data-mml-node="mrow" transform="translate(227.1,485) scale(0.707)" data-latex="\\partial f"><g data-mml-node="mi" data-latex="\\partial"><path data-c="1D715" d="M256 574C256 597 241 610 212 612C243 659 288 683 347 683C439 683 484 606 484 508C484 467 476 417 461 356C444 425 401 460 334 460C257 460 190 428 130 366C70 304 40 235 40 158C40 121 53 83 79 45C110 0 158-22 225-22C315-22 390 20 449 105C505 187 566 329 566 456C566 527 548 587 512 635C473 689 418 716 349 716C282 716 232 693 198 646C171 609 157 579 157 556C157 530 171 517 199 517C229 517 256 544 256 574M439 303C439 240 420 178 381 117C338 48 287 14 228 14C162 14 124 57 124 121C124 149 131 188 145 238C159 288 173 323 188 344C228 401 277 430 334 430C407 430 439 376 439 303Z"></path></g><g data-mml-node="mi" data-latex="f" transform="translate(566,0)"><path data-c="1D453" d="M552 633C552 677 509 705 462 705C400 705 357 665 334 586C329 568 318 517 302 433L237 433C215 433 204 432 204 411C204 400 214 395 235 395L295 395L222 8C211-49 201-91 192-119C180-156 163-175 141-175C126-175 114-171 103-164C135-159 151-140 151-108C151-82 138-69 111-69C77-69 53-99 53-133C53-177 94-205 141-205C166-205 189-195 208-174C240-141 265-94 283-31C294 8 304 46 311 84L369 395L451 395C474 395 484 396 484 419C484 428 474 433 454 433L377 433C383 474 411 625 420 644C430 665 444 675 462 675C477 675 490 671 501 664C470 657 454 639 454 608C454 582 467 569 494 569C528 569 552 599 552 633Z"></path></g></g><g data-mml-node="mrow" transform="translate(220,-346.3) scale(0.707)" data-latex="\\partial x"><g data-mml-node="mi" data-latex="\\partial"><path data-c="1D715" d="M256 574C256 597 241 610 212 612C243 659 288 683 347 683C439 683 484 606 484 508C484 467 476 417 461 356C444 425 401 460 334 460C257 460 190 428 130 366C70 304 40 235 40 158C40 121 53 83 79 45C110 0 158-22 225-22C315-22 390 20 449 105C505 187 566 329 566 456C566 527 548 587 512 635C473 689 418 716 349 716C282 716 232 693 198 646C171 609 157 579 157 556C157 530 171 517 199 517C229 517 256 544 256 574M439 303C439 240 420 178 381 117C338 48 287 14 228 14C162 14 124 57 124 121C124 149 131 188 145 238C159 288 173 323 188 344C228 401 277 430 334 430C407 430 439 376 439 303Z"></path></g><g data-mml-node="mi" data-latex="x" transform="translate(566,0)"><path data-c="1D465" d="M527 373C527 419 482 442 432 442C389 442 355 419 329 373C308 419 273 442 222 442C173 442 133 419 101 374C74 335 60 306 60 287C60 278 65 273 75 273C84 273 90 278 92 287C111 345 153 413 220 413C253 413 269 392 269 351C269 330 251 252 216 118C199 51 169 18 126 18C112 18 99 21 88 26C114 36 127 54 127 80C127 106 114 119 87 119C54 119 29 91 29 58C29 12 76-11 125-11C167-11 201 12 228 58C247 12 283-11 335-11C383-11 423 12 455 57C482 96 496 125 496 144C496 153 491 158 481 158C472 158 467 153 464 144C447 87 402 18 337 18C304 18 287 38 287 79C287 92 292 120 303 165L337 300C356 375 387 413 431 413C445 413 458 410 469 405C442 396 429 378 429 351C429 325 443 312 470 312C502 312 527 341 527 373Z"></path></g></g><rect width="1004.7" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(1767.7,0)"><path data-c="29" d="M89-468C170-405 238-310 291-181C342-60 367 55 367 164L367 336C367 445 342 560 291 681C238 810 170 905 89 968C85 971 82 972 79 972C68 972 62 966 62 955C62 950 64 945 68 942C140 887 198 795 241 664C278 552 297 443 297 336L297 164C297 57 278-52 241-164C198-295 140-387 68-442C64-445 62-450 62-455C62-466 68-472 79-472C82-472 86-471 89-468Z"></path></g></g><g data-mml-node="mi" transform="translate(2323.7,718.3) scale(0.707)" data-latex="T"><path data-c="1D447" d="M344 631C344 628 343 621 340 611L208 83C204 68 200 59 197 55C188 44 154 39 94 39C63 39 49 42 49 16C49 5 56 0 69 0C120 0 192 4 235 3L317 2C331 2 386 0 403 0C420 0 428 8 428 24C428 34 416 39 391 39C339 39 309 41 300 46C297 48 295 52 295 58L430 603C433 617 436 626 439 629C443 635 467 638 511 638C566 638 604 634 623 625C642 616 652 595 652 561C652 543 649 517 644 483C642 475 641 469 641 464C641 453 646 447 657 447C666 447 672 456 675 473L702 645C703 650 704 656 704 662C704 672 694 677 673 677L125 677C99 677 97 674 89 655L30 481C27 472 25 466 24 462C24 452 29 447 40 447C48 447 55 455 60 470C85 543 110 588 133 607C159 628 209 638 282 638L321 638C332 638 344 639 344 631Z"></path></g></g><g data-mml-node="mi" data-latex="u" transform="translate(2871.5,0)"><path data-c="1D462" d="M543 144C543 153 538 158 527 158C518 158 513 151 510 137C505 118 500 99 493 80C480 39 462 18 440 18C422 18 413 32 413 60C413 77 420 111 433 161L460 267C469 303 477 328 483 359L489 386C491 393 492 398 492 401C492 421 481 431 459 431C437 431 423 419 417 394L343 98C342 95 338 88 330 76C314 50 275 18 235 18C197 18 178 44 178 95C178 136 196 202 231 294C242 324 248 345 248 357C248 407 213 442 163 442C118 442 83 417 58 367C39 328 29 301 29 287C29 278 34 273 45 273C58 273 60 279 64 293C87 373 119 413 160 413C174 413 181 403 181 384C181 369 175 348 164 319C126 218 107 148 107 111C107 34 155-11 232-11C275-11 314 9 347 50C361 9 391-11 437-11C506-11 527 70 543 144Z"></path></g></g></g>',1)])]))]),t[12]||(t[12]=e(". This is a wrapper around AD backends but allows us to compute gradients of vector-jacobian products efficiently using mixed-mode AD.",-1))]),t[15]||(t[15]=d('<p><strong>Backends &amp; AD Packages</strong></p><table tabindex="0"><thead><tr><th style="text-align:left;">Supported Backends</th><th style="text-align:left;">Packages Needed</th><th style="text-align:left;">Notes</th></tr></thead><tbody><tr><td style="text-align:left;"><code>AutoEnzyme</code></td><td style="text-align:left;"><code>Enzyme.jl</code> / <code>Reactant.jl</code></td><td style="text-align:left;">For nested AD support directly using <code>Enzyme.jl</code>.</td></tr><tr><td style="text-align:left;"><code>AutoZygote</code></td><td style="text-align:left;"><code>Zygote.jl</code></td><td style="text-align:left;"></td></tr></tbody></table><div class="warning custom-block"><p class="custom-block-title">Only for ChainRules-based AD like Zygote</p><p>Gradient wrt <code>u</code> in the reverse pass is always dropped.</p></div><p><strong>Arguments</strong></p><ul><li><p><code>f</code>: The function to compute the jacobian of.</p></li><li><p><code>backend</code>: The backend to use for computing the VJP.</p></li><li><p><code>x</code>: The input to the function.</p></li><li><p><code>u</code>: An object of the same structure as <code>f(x)</code>.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>v</code>: The Vector Jacobian Product.</li></ul>',7)),o(l,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...t[13]||(t[13]=[a("a",{href:"https://github.com/LuxDL/Lux.jl/blob/6e188d9cf1599c6004761b22dd35ef8afac585d2/src/autodiff/api.jl#L1",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),t[23]||(t[23]=a("h2",{id:"Batched-AD",tabindex:"-1"},[e("Batched AD "),a("a",{class:"header-anchor",href:"#Batched-AD","aria-label":'Permalink to "Batched AD {#Batched-AD}"'},"​")],-1)),a("details",b,[a("summary",null,[t[16]||(t[16]=a("a",{id:"Lux.batched_jacobian",href:"#Lux.batched_jacobian"},[a("span",{class:"jlbinding"},"Lux.batched_jacobian")],-1)),t[17]||(t[17]=e()),o(l,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),t[19]||(t[19]=d('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">batched_jacobian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractADType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Computes the Jacobian of a function <code>f</code> with respect to a batch of inputs <code>x</code>. This expects the following properties for <code>y = f(x)</code>:</p><ol><li><p><code>ndims(y) ≥ 2</code></p></li><li><p><code>size(y, ndims(y)) == size(x, ndims(x))</code></p></li></ol><p><strong>Backends &amp; AD Packages</strong></p><table tabindex="0"><thead><tr><th style="text-align:left;">Supported Backends</th><th style="text-align:left;">Packages Needed</th></tr></thead><tbody><tr><td style="text-align:left;"><code>AutoEnzyme</code></td><td style="text-align:left;"><code>Reactant.jl</code></td></tr><tr><td style="text-align:left;"><code>AutoForwardDiff</code></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><code>AutoZygote</code></td><td style="text-align:left;"><code>Zygote.jl</code></td></tr></tbody></table><p><strong>Arguments</strong></p><ul><li><p><code>f</code>: The function to compute the jacobian of.</p></li><li><p><code>backend</code>: The backend to use for computing the jacobian.</p></li><li><p><code>x</code>: The input to the function. Must have <code>ndims(x) ≥ 2</code>.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>J</code>: The Jacobian of <code>f</code> with respect to <code>x</code>. This will be a 3D Array. If the dimensions of <code>x</code> are <code>(N₁, N₂, ..., Nₙ, B)</code> and of <code>y</code> are <code>(M₁, M₂, ..., Mₘ, B)</code>, then <code>J</code> will be a <code>((M₁ × M₂ × ... × Mₘ), (N₁ × N₂ × ... × Nₙ), B)</code> Array.</li></ul><div class="danger custom-block"><p class="custom-block-title">Danger</p><p><code>f(x)</code> must not be inter-mixing the batch dimensions, else the result will be incorrect. For example, if <code>f</code> contains operations like batch normalization, then the result will be incorrect.</p></div>',10)),o(l,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...t[18]||(t[18]=[a("a",{href:"https://github.com/LuxDL/Lux.jl/blob/6e188d9cf1599c6004761b22dd35ef8afac585d2/src/autodiff/api.jl#L89-L123",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),t[24]||(t[24]=a("h2",{id:"Nested-2nd-Order-AD",tabindex:"-1"},[e("Nested 2nd Order AD "),a("a",{class:"header-anchor",href:"#Nested-2nd-Order-AD","aria-label":'Permalink to "Nested 2nd Order AD {#Nested-2nd-Order-AD}"'},"​")],-1)),t[25]||(t[25]=a("p",null,[e("Consult the "),a("a",{href:"/dev/manual/nested_autodiff#nested_autodiff"},"manual page on Nested AD"),e(" for information on nested automatic differentiation.")],-1))])}const v=c(p,[["render",k]]);export{D as __pageData,v as default};
