<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Exporting Lux Models to Jax (via EnzymeJAX &amp; Reactant) | Lux.jl Docs</title>
    <meta name="description" content="Documentation for LuxDL Repositories">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/v1.4.1/assets/style.DLkfNY-v.css" as="style">
    <link rel="preload stylesheet" href="/v1.4.1/vp-icons.css" as="style">
    
    <script type="module" src="/v1.4.1/assets/app.DeozoP6o.js"></script>
    <link rel="preload" href="/v1.4.1/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/v1.4.1/assets/chunks/theme.BTV4q-zJ.js">
    <link rel="modulepreload" href="/v1.4.1/assets/chunks/framework.DPiAi8YZ.js">
    <link rel="modulepreload" href="/v1.4.1/assets/manual_exporting_to_jax.md.oF1gY-gI.lean.js">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q8GYTEVTZ2"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Q8GYTEVTZ2");</script>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="REPLACE_ME_DOCUMENTER_VITEPRESS_FAVICON">
    <script src="/versions.js"></script>
    <script src="/v1.4.1/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/v1.4.1/" data-v-0f4f798b><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/v1.4.1/lux-logo-dark.svg" alt data-v-35a7d0b8><!--]--><!--[--><img class="VPImage light logo" src="/v1.4.1/lux-logo.svg" alt data-v-35a7d0b8><!--]--><!--]--><!--]--><span data-v-0f4f798b>Lux.jl Docs</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.4.1/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.4.1/introduction" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Getting Started</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://lux.csail.mit.edu/benchmarks/" target="_blank" rel="noreferrer" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Benchmarks</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.4.1/tutorials/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Tutorials</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.4.1/manual/interface" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Manual</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>API</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Lux</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Lux/layers" data-v-acbfed09><!--[--><span data-v-acbfed09>Built-In Layers</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Lux/autodiff" data-v-acbfed09><!--[--><span data-v-acbfed09>Automatic Differentiation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Lux/utilities" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Lux/contrib" data-v-acbfed09><!--[--><span data-v-acbfed09>Experimental</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Lux/interop" data-v-acbfed09><!--[--><span data-v-acbfed09>InterOp</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Lux/distributed_utils" data-v-acbfed09><!--[--><span data-v-acbfed09>DistributedUtils</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Accelerator Support</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Accelerator_Support/MLDataDevices" data-v-acbfed09><!--[--><span data-v-acbfed09>MLDataDevices</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>NN Primitives</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/NN_Primitives/LuxLib" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxLib</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/NN_Primitives/NNlib" data-v-acbfed09><!--[--><span data-v-acbfed09>NNlib</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/NN_Primitives/ActivationFunctions" data-v-acbfed09><!--[--><span data-v-acbfed09>Activation Functions</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Building Blocks</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Building_Blocks/LuxCore" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxCore</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Building_Blocks/WeightInitializers" data-v-acbfed09><!--[--><span data-v-acbfed09>WeightInitializers</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Testing Functionality</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.4.1/api/Testing_Functionality/LuxTestUtils" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxTestUtils</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LuxDL/Lux.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/avikpal1410" aria-label="twitter" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LuxDL/Lux.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/avikpal1410" aria-label="twitter" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-bc9dc845><button data-v-bc9dc845>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Basics</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/interface" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Lux Interface</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/freezing_model_parameters" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Freezing Parameters</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/gpu_management" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>GPU Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/weight_initializers" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Initializing Weights</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 has-active" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Reactant Compilation</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/compiling_lux_models" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Compiling Lux Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/exporting_to_jax" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Exporting Lux Models to Jax</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Automatic Differentiation</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/autodiff" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Automatic Differentiation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/nested_autodiff" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Nested AutoDiff</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Debugging / Performance Enhancement Tools</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/debugging" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Debugging Lux Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/performance_pitfalls" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Performance Pitfalls</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Migration Guides</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/migrate_from_flux" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Migrating from Flux</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Advanced Usage</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/dispatch_custom_input" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Custom Input Types</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/preferences" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Configuration via Preferences</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/distributed_utils" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Distributed Training</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.4.1/manual/nn_inside_gpu_kernels" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Lux In GPU Kernels</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--[--><!--[--><!--[--><!--[--><br><h2> Trusted by </h2><a class="enjoyer" href="https://sciml.ai/" target="_blank"><img width="32" height="32" src="https://avatars.githubusercontent.com/u/21238080?v=4"><span><p class="extra-info">Scientific Computing</p><p class="heading">SciML.ai</p><p class="extra-info">Machine Learning</p></span></a><!--]--><!--]--><!--]--><!--]--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _v1_4_1_manual_exporting_to_jax" data-v-83890dd9><div><h1 id="Exporting-Lux-Models-to-Jax-(via-EnzymeJAX-and-Reactant)" tabindex="-1">Exporting Lux Models to Jax (via EnzymeJAX &amp; Reactant) <a class="header-anchor" href="#Exporting-Lux-Models-to-Jax-(via-EnzymeJAX-and-Reactant)" aria-label="Permalink to &quot;Exporting Lux Models to Jax (via EnzymeJAX &amp;amp; Reactant) {#Exporting-Lux-Models-to-Jax-(via-EnzymeJAX-and-Reactant)}&quot;">​</a></h1><div class="danger custom-block"><p class="custom-block-title">Experimental</p><p>This feature is experimental and is subject to change without notice. Additionally, this feature currently requires some manual setup for interacting with Jax, which we are working on improving.</p></div><p>In this manual, we will go over how to export Lux models to StableHLO and use <a href="https://github.com/EnzymeAD/Enzyme-JAX" target="_blank" rel="noreferrer">EnzymeJAX</a> to run integrate Lux models with JAX. We assume that users are familiar with <a href="/v1.4.1/manual/compiling_lux_models#reactant-compilation">Reactant compilation of Lux models</a>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux, Reactant, Random</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reactant_device</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(::ReactantDevice{Missing, Missing}) (generic function with 1 method)</span></span></code></pre></div><p>We simply define a Lux model and generate the stablehlo code using <code>Reactant.@code_hlo</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Conv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MaxPool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Conv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MaxPool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    FlattenLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ps, st </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_rng</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), model) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dev;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>((layer_1 = (weight = Reactant.ConcreteRArray{Float32, 4}(Float32[0.42504427 0.40626034 … -0.59226507 -0.53477997; 0.3686817 -0.5373746 … 0.12996913 -0.13718954; … ; 0.101239495 0.44847944 … -0.29192784 0.35690206; -0.38933414 0.32455882 … 0.10496962 -0.477524;;;; -0.42290956 0.31133085 … -0.06959804 -0.24329643; 0.018566618 -0.6832877 … -0.29007724 -0.6689658; … ; 0.3222572 -0.030274581 … 0.0798553 0.14184393; 0.30988115 -0.465022 … -0.20683944 0.4791351;;;; 0.018403172 -0.33061033 … 0.14841038 0.5411295; 0.62498915 0.0068503963 … 0.07740938 0.46108046; … ; 0.27046683 0.012198799 … -0.6053681 -0.6344564; 0.3116558 -0.10055077 … 0.19652618 0.06644935;;;; -0.39731917 0.03786111 … -0.03249792 0.0658604; -0.07460716 0.18330534 … 0.08042839 0.65421987; … ; -0.47582272 -0.22511362 … -0.18455839 -0.4954246; 0.44603336 0.49826398 … -0.6824314 -0.68595034;;;; -0.32300183 -0.2895024 … 0.5708895 -0.64145356; 0.6624845 -0.28084362 … -0.5314196 0.43401426; … ; 0.5583026 0.23177066 … 0.67371315 -0.13340135; 0.6625186 0.22035722 … 0.13509057 -0.042216856;;;; -0.196426 -0.4270271 … 0.497558 -0.35022122; -0.4645837 0.22933903 … -0.46689418 0.33256748; … ; -0.0625244 0.31512755 … -0.49182466 0.31657586; -0.042055804 0.5713154 … -0.14519687 -0.5719822]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[-0.115068056, -0.06272936, 0.1998477, 0.033507776, -0.19502087, 0.009124065])), layer_2 = NamedTuple(), layer_3 = (weight = Reactant.ConcreteRArray{Float32, 4}(Float32[-0.09419024 -0.12546155 … -0.28138128 -0.07438807; 0.190933 0.014920961 … 0.053161234 0.18107964; … ; -0.043331005 -0.1502209 … -0.054885004 -0.10081279; 0.052933674 -0.21221888 … 0.23258264 -0.2553813;;; 0.0016561351 -0.24095865 … 0.2536766 -0.10641168; -0.01077415 0.27335325 … -0.04663562 0.18771258; … ; -0.25932375 0.24483801 … -0.24138935 -0.27466705; 0.029031523 0.25484994 … -0.08218014 0.20777917;;; 0.17813344 0.2071122 … -0.28273854 -0.18668629; -0.08394788 0.20351906 … -0.1077706 0.013927206; … ; 0.073337264 0.24363591 … 0.2642264 -0.21566798; -0.051400743 -0.09515463 … 0.22712824 0.17905295;;; -0.20721275 0.12788789 … 0.115996316 -0.1180758; -0.26019672 -0.053609036 … 0.07830281 -0.26829526; … ; 0.2693915 -0.106776975 … 0.061640907 0.1589576; 0.035899505 0.055073082 … -0.16138583 -0.10402115;;; 0.053968836 0.010785883 … 0.19291057 -0.07711234; 0.21299377 0.0056982534 … -0.15684311 -0.08785621; … ; 0.13257632 -0.28283685 … 0.23888445 0.22442903; 0.06219509 -0.17878251 … 0.26701808 -0.2712212;;; -0.123444974 -0.26633984 … 0.15282564 0.1176017; -0.058369607 0.019457377 … 0.10790499 0.15200303; … ; 0.094567746 -0.26642346 … -0.17276545 0.16468617; 0.19291724 -0.16668817 … 0.20717101 -0.236953;;;; -0.25597733 -0.046499975 … 0.08835149 0.21362337; -0.068214975 0.2512635 … -0.1488656 -0.06026237; … ; -0.19976853 -0.07270358 … 0.2821133 -0.070024624; -0.17971443 0.086032905 … -0.09869908 0.24648154;;; 0.060257178 -0.24997793 … -0.20586343 -0.034204222; 0.08179813 -0.040952675 … -0.15642144 0.12588845; … ; 0.012251819 -0.17082949 … -0.14891358 0.28182212; -0.2088091 -0.20632617 … -0.27958375 -0.08267444;;; 0.1290583 -0.09508568 … -0.21649328 0.12826729; -0.12048934 -0.11339049 … -0.08876247 -0.1679639; … ; 0.21048409 0.12159287 … 0.039263833 0.10417945; 0.18458872 -0.17268291 … 0.13397457 -0.24109803;;; 0.022191495 0.10817814 … 0.018531125 -0.15194926; 0.15536754 0.0055642603 … -0.029613588 -0.11804799; … ; -0.10428222 0.0036105348 … -0.11696286 0.122239135; 0.045031577 -0.12789457 … 0.1933771 -0.2824307;;; 0.012058583 0.25442204 … -0.109503575 0.12076144; 0.0039513847 -0.17072238 … 0.078389086 -0.21459846; … ; 0.14376266 0.18479939 … -0.05443144 -0.043836866; 0.011407768 -0.23481128 … 0.2189507 0.11217019;;; -0.17512786 0.26293835 … 0.074778415 -0.21194705; -0.1837974 -0.020546958 … -0.17989184 0.16783114; … ; -0.22218485 0.21374564 … 0.0038844894 0.135758; 0.10275772 -0.260204 … -0.26212272 0.02449514;;;; -0.07825492 0.15769479 … 0.13179079 -0.03686214; -0.11316654 0.16076712 … -0.025799062 -0.23667626; … ; 0.218598 0.1560636 … 0.18976769 0.08196095; -0.07909682 -0.12223705 … 0.17856209 0.2718241;;; 0.19782118 -0.21303801 … 0.05925118 -0.10993549; 0.21554208 0.23775454 … 0.1397318 -0.06918476; … ; 0.059711292 0.20652777 … 0.0012646077 0.16634686; -0.22417082 -0.11986469 … -0.029205438 -0.12595788;;; -0.22008088 0.26886222 … -0.07740181 -0.029284034; 0.15451115 -0.092320815 … 0.2492169 -0.2403374; … ; 0.20172732 0.05086197 … 0.2595628 -0.057102133; -0.16858843 0.27212313 … 0.08074405 -0.19077042;;; -0.14620899 -0.15194319 … 0.0065545426 -0.19949646; 0.21139367 -0.13436233 … -0.1276782 -0.1469614; … ; 0.24720505 0.14709812 … -0.05702124 0.20301957; -0.010711132 0.24142408 … -0.1105266 -0.21510321;;; 0.10490846 -0.12281382 … -0.19768776 -0.14736328; -0.10956902 0.14515293 … 0.23099175 0.014812492; … ; 0.1977586 -0.20289023 … 0.22433293 -0.10473599; -0.053977534 0.15168865 … 0.11795627 0.21496703;;; -0.19610442 -0.23465934 … -0.028111676 -0.0010915359; -0.012623082 -0.04239059 … -0.014259627 -0.27487242; … ; -0.12927389 -0.2697605 … 0.17927444 -0.20362625; -0.15204276 0.22955084 … 0.030685466 -0.27421787;;;; … ;;;; -0.07928206 -0.19592603 … 0.17265405 -0.23865281; -0.21161564 -0.18244854 … 0.27502388 0.21844646; … ; -0.24184123 -0.25246027 … 0.24731702 -0.19140664; -0.2785702 0.027366554 … -0.22917175 0.20654075;;; -0.038386673 0.15234423 … -0.045921855 0.10186825; -0.002213957 0.087177314 … 0.11090474 0.21196489; … ; 0.08786036 -0.26179478 … 0.13983703 0.16394694; 0.10545407 0.27250943 … 0.2769391 0.2582651;;; -0.24079198 0.23555899 … 0.16497856 -0.04386185; 0.21779764 0.14898118 … 0.2739273 -0.18598081; … ; 0.16932233 -0.17896715 … 0.1719041 -0.14363362; -0.20745912 -0.00885893 … -0.1902605 0.21485187;;; 0.24983011 0.06890237 … -0.23297043 0.19478711; -0.21835117 -0.10089274 … 0.0052203084 -0.008405025; … ; 0.10824298 0.0631528 … -0.15775545 0.08696816; 0.08126981 0.26583114 … 0.16020697 -0.18807393;;; 0.13151634 0.03734241 … -0.17916004 -0.070519425; 0.1335499 -0.074811496 … 0.21915297 0.092043824; … ; 0.0464174 0.11992848 … 0.2752414 -0.14457966; -0.0319232 0.08998513 … -0.018232489 -0.2251252;;; 0.17648354 -0.12413359 … 0.09719181 0.21548887; -0.010860804 0.21706937 … 0.12654263 0.11109356; … ; -0.1642069 -0.25799006 … 0.18810916 -0.23465651; -0.070540674 -0.22604719 … 0.21405628 -0.08664528;;;; 0.18069442 -0.2514959 … 0.24182549 0.02443455; 0.13559686 0.0029213834 … -0.050654337 -0.08455986; … ; 0.07938072 -0.24727845 … 0.04846341 0.08333298; -0.2031597 -0.2404339 … 0.17066984 -0.107917204;;; -0.25838616 -0.09687422 … -0.09223517 0.20318303; -0.273412 -0.21638468 … -0.03570222 -0.10050644; … ; 0.07431662 -0.22918577 … 0.022398183 0.056949627; -0.04152813 0.17188124 … -0.094997235 0.03138271;;; 0.19554283 -0.0055537405 … -0.03192175 0.07064769; -0.14384945 0.24625105 … 0.24567501 0.2506349; … ; 0.23536147 0.01075193 … 0.27508956 0.0058315387; -0.27739015 0.2710892 … 0.0316336 0.20576255;;; 0.0039518904 0.12567687 … -0.2580158 0.2718878; 0.22145341 -0.07437722 … -0.14874776 -0.15357316; … ; 0.18119337 -0.079464 … -0.24725609 0.23876742; 0.23786668 0.19868313 … -0.11189711 -0.18140933;;; -0.05525084 0.21888435 … 0.21922348 0.0035015936; -0.1349833 -0.23853496 … 0.10419405 -0.01939146; … ; -0.23261946 -0.08010399 … -0.16739224 -0.15385231; 0.18018529 0.17006785 … -0.08464182 0.036864903;;; 0.00055087614 -0.10431799 … -0.13600244 0.1391462; -0.12841314 -0.24133645 … -0.029420251 -0.17474723; … ; -0.08101028 0.13394949 … -0.23026066 0.1464152; 0.04082502 -0.12937082 … -0.15918486 0.2121736;;;; 0.118275076 -0.0823899 … -0.2740536 -0.11895452; -0.25811654 0.18307379 … 0.015832143 0.048595548; … ; -0.21710008 0.09536803 … 0.17560396 0.2160825; -0.19982412 0.053593557 … -0.039094336 0.18525821;;; 0.121422365 0.08714683 … 0.15940838 0.19733086; -0.12662187 0.06807363 … -0.19183299 -0.1882472; … ; -0.20204979 -0.031819217 … 0.08418144 0.13160987; -0.21335354 -0.18143657 … 0.041636936 0.15875567;;; 0.24491447 0.006367006 … 0.23517573 0.051708076; 0.028640063 0.06970303 … 0.008727263 -0.2311272; … ; -0.029487856 0.12591171 … 0.18398581 0.17223379; -0.007125447 0.25490454 … -0.063816965 -0.23949237;;; 0.032025635 0.19171248 … 0.15839645 0.17583779; -0.20390746 -0.25233346 … -0.11578986 -0.26268366; … ; 0.09226262 0.19416256 … 0.23695976 -0.016546143; -0.022531029 -0.17532572 … 0.12115529 0.19356896;;; 0.23345506 -0.03895215 … 0.25449756 0.07694922; 0.082911715 0.06598432 … 0.016407127 -0.16955714; … ; 0.07025991 -0.07476513 … 0.18525241 -0.12606023; 0.076837376 -0.22768481 … -0.013439955 -0.15216735;;; 0.02040875 0.07013138 … 0.22170219 -0.256415; 0.13395417 0.07432225 … 0.10477615 -0.051876698; … ; 0.16404931 -0.202431 … 0.05677079 0.14534192; -0.036938675 -0.26299113 … 0.07263989 0.24928112]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[-0.079236835, 0.030559968, 0.06151049, -0.03897441, 0.07964343, 0.071590744, -0.02484658, 0.047643453, -0.01364453, 0.02755451, -0.04945199, 0.03439521, 0.0033376308, -0.03448105, 0.054861158, -0.08054241])), layer_4 = NamedTuple(), layer_5 = NamedTuple(), layer_6 = (layer_1 = (weight = Reactant.ConcreteRArray{Float32, 2}(Float32[0.054490864 0.18122764 … -0.06067218 0.09601371; 0.20585532 0.17910965 … 0.1640495 -0.025812356; … ; 0.13035776 0.025948811 … 0.10807248 0.08300146; 0.06539605 -0.11368338 … 0.14240713 -0.16777502]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[-0.013063848, 0.019034937, -0.055878423, 0.056395814, 0.059452973, -0.009891272, 0.037562408, 0.061210893, -0.0036934987, -0.029923223  …  -0.019624606, 0.0014236346, -0.011518262, -0.009291925, 0.04590764, -0.031929113, 0.03776943, -0.008334123, 0.0011817962, 0.020054087])), layer_2 = (weight = Reactant.ConcreteRArray{Float32, 2}(Float32[-0.02321693 -0.12686725 … -0.27444682 -0.24097088; -0.18188491 0.21785301 … 0.07990129 -0.046767287; … ; -0.20191978 -0.2632203 … 0.14726494 0.17553157; -0.27661818 -0.23145147 … -0.10018718 -0.26439604]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[-0.043497603, -0.033918247, -0.07715155, -0.061466962, -0.018064044, -0.05666669, 0.0848756, 0.028985621, 0.0062304526, 0.08194776  …  0.044462502, -0.022949, 0.06225748, 0.039102066, 0.049960107, 0.025559144, -0.038053177, -0.013179257, 0.008008301, 0.008930232])), layer_3 = (weight = Reactant.ConcreteRArray{Float32, 2}(Float32[0.18139583 0.058699332 … 0.01378015 -0.054409962; -0.044637576 0.101744756 … -0.09924946 -0.07245997; … ; -0.13262649 -0.026803501 … 0.021063684 0.08187794; -0.15774088 -0.041667562 … -0.12132327 0.13264379]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[0.079922244, -0.010632915, -0.0010757144, -0.04828227, -0.08182068, -0.04824383, -0.0437603, -0.106896296, -0.061070126, 0.043993264])))), (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple(), layer_4 = NamedTuple(), layer_5 = NamedTuple(), layer_6 = (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple())))</span></span></code></pre></div><p>Generate an example input.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> randn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_rng</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dev;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>28×28×1×4 Reactant.ConcreteRArray{Float32, 4}:</span></span>
<span class="line"><span>[:, :, 1, 1] =</span></span>
<span class="line"><span>  0.0693325  -0.423616    1.07872   …   0.284702   -1.74668     1.24608</span></span>
<span class="line"><span> -0.388372   -0.336906   -0.024543      0.763607    0.461403    0.524358</span></span>
<span class="line"><span>  2.13345    -1.09728    -2.02289       1.86508     0.280902   -0.225321</span></span>
<span class="line"><span>  0.600317    0.718761    0.864797     -0.461089   -0.106058   -0.602584</span></span>
<span class="line"><span>  2.38351    -0.292997   -0.102362      0.445425    1.81862     0.562875</span></span>
<span class="line"><span> -0.763559   -0.432734   -1.94579   …   0.492834    1.10095     0.307779</span></span>
<span class="line"><span> -0.0928091   0.500158   -0.656345      0.809652   -1.30183     1.04674</span></span>
<span class="line"><span> -0.674203    0.56623     0.959849      0.330619    0.46461    -0.545123</span></span>
<span class="line"><span>  0.608586   -1.63048    -0.682961      0.159214   -0.950532   -1.38903</span></span>
<span class="line"><span>  0.0932572   0.663445    0.554253     -0.737437   -1.08684     0.896531</span></span>
<span class="line"><span>  ⋮                                 ⋱   ⋮                      </span></span>
<span class="line"><span> -2.25725     0.876298    1.91024      -0.665405   -0.0777341  -0.531626</span></span>
<span class="line"><span> -1.32794    -0.133021   -0.378703  …   1.16236    -0.649646    1.47762</span></span>
<span class="line"><span> -0.696063    0.221808   -0.740343      0.286608    1.03794     0.469701</span></span>
<span class="line"><span>  0.0292798  -0.0510331   0.579802      0.0766193   0.261117    0.136539</span></span>
<span class="line"><span>  0.463691   -0.221081    1.55066      -0.226806    0.0409733   0.699204</span></span>
<span class="line"><span> -0.725311   -0.406319    0.532943     -1.11171     0.468755    1.67395</span></span>
<span class="line"><span>  0.697855    0.48289    -1.09882   …  -2.77168     0.771705   -0.354841</span></span>
<span class="line"><span> -0.765199    1.01969    -0.555739     -0.449902    0.127574   -0.205248</span></span>
<span class="line"><span> -0.637825   -1.76086    -0.770079     -1.40613    -1.78155    -0.699864</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[:, :, 1, 2] =</span></span>
<span class="line"><span>  0.351659   -0.703038   0.950472   …   1.91414    -1.43984    -0.510335</span></span>
<span class="line"><span>  0.569031   -0.55088    1.57225       -0.803675   -0.535108    0.412621</span></span>
<span class="line"><span>  1.08        1.09319   -0.702379      -0.914326   -0.0880074  -0.780679</span></span>
<span class="line"><span> -0.154779    0.637349  -0.881809       0.763193   -0.731912   -0.764204</span></span>
<span class="line"><span>  0.645386    0.364434  -1.3722        -0.75569    -1.0643     -0.577052</span></span>
<span class="line"><span> -2.89011    -0.496328   0.339538   …  -1.74834     0.228083   -0.794029</span></span>
<span class="line"><span> -1.1766      1.10019   -0.490318       1.2032     -0.110351   -1.00609</span></span>
<span class="line"><span> -1.89651    -1.96315   -0.754487       0.964351    1.87818    -0.5309</span></span>
<span class="line"><span>  0.79848     1.03886   -0.410096      -0.0761639   0.621745    0.847835</span></span>
<span class="line"><span> -0.0365749   1.0078    -0.463132       0.751452   -1.05789     0.318569</span></span>
<span class="line"><span>  ⋮                                 ⋱   ⋮                      </span></span>
<span class="line"><span> -1.1203      1.26625   -1.15811        0.294276    1.62326    -0.776538</span></span>
<span class="line"><span> -0.177798    0.361185   0.295686   …  -0.177081   -0.780918    0.824192</span></span>
<span class="line"><span>  0.513576   -0.935364   0.0814671      1.17417    -1.92886     1.06819</span></span>
<span class="line"><span> -0.0129912  -1.43166   -1.5504         0.0196996  -0.895906   -1.0299</span></span>
<span class="line"><span>  1.71888     0.453427   1.61204       -0.855893    0.445279    0.888125</span></span>
<span class="line"><span> -0.599821    0.378618   0.565978       0.467776   -0.444482    0.176865</span></span>
<span class="line"><span>  0.431459   -1.03185    0.740449   …  -0.501875   -0.798734   -1.90323</span></span>
<span class="line"><span>  2.01706    -1.18083    1.23864       -1.29229    -0.179664   -0.743148</span></span>
<span class="line"><span> -1.6797      1.72966   -0.711895       1.35777     1.86796     0.775137</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[:, :, 1, 3] =</span></span>
<span class="line"><span>  0.44954     1.45479    0.791855   …   0.595445   -0.156437  -0.649262</span></span>
<span class="line"><span>  0.0455653   1.24115    0.713157       0.971481   -1.3061    -0.697567</span></span>
<span class="line"><span> -0.511792   -0.42688    1.41848       -2.59061     0.259143   1.94259</span></span>
<span class="line"><span> -1.60927     1.47028    0.0283367     -0.565658   -0.236979  -0.248763</span></span>
<span class="line"><span> -1.87087    -0.435666   0.18871       -0.330288    1.8399    -1.34421</span></span>
<span class="line"><span> -0.65931     0.778272   2.51446    …   1.04722    -1.36473   -1.41361</span></span>
<span class="line"><span>  1.01411     2.17853    1.41086        1.15259     1.06624    2.11729</span></span>
<span class="line"><span>  0.83099    -0.5665    -0.39345        0.948687   -0.368952  -0.280315</span></span>
<span class="line"><span> -1.23403    -0.211008   0.769623      -0.382225   -1.18393    1.13788</span></span>
<span class="line"><span> -0.282996    0.246495  -0.453514       0.261971   -1.78962    0.0473894</span></span>
<span class="line"><span>  ⋮                                 ⋱   ⋮                     </span></span>
<span class="line"><span> -0.279684   -0.506223  -0.126196       2.00406    -1.81122    0.583252</span></span>
<span class="line"><span> -0.587942    0.17722   -0.806907   …   0.388054   -1.66424   -1.2271</span></span>
<span class="line"><span>  2.04241    -0.811282  -1.82934        2.25989     1.69709    1.55675</span></span>
<span class="line"><span> -0.785761    0.482697  -1.10743        0.0176254  -1.7621    -0.745583</span></span>
<span class="line"><span> -0.647252    0.166588  -0.528163       0.760599   -1.98595   -1.38049</span></span>
<span class="line"><span> -1.68016    -0.668969  -0.234502       0.155715    0.498571   0.686325</span></span>
<span class="line"><span>  2.19125    -0.550269   1.97988    …   0.309272    2.44185   -0.106064</span></span>
<span class="line"><span>  0.368998    1.69696   -0.452838      -0.561957   -0.583303   0.408157</span></span>
<span class="line"><span>  1.66073     0.730257  -0.283591       0.753012    0.796029   2.56915</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[:, :, 1, 4] =</span></span>
<span class="line"><span> -1.30556    -1.76606    -0.102552   …  -0.757897     0.844432   -0.230305</span></span>
<span class="line"><span> -1.87644    -0.612699   -0.409143      -0.306025     1.13655     0.570291</span></span>
<span class="line"><span>  1.35736    -1.37773    -0.514924      -0.0327042   -1.05062     0.0277007</span></span>
<span class="line"><span> -1.71801    -0.464733   -0.640684       0.598324    -0.0237537   0.77599</span></span>
<span class="line"><span> -0.271766   -0.838042    0.444151      -0.940421    -0.717739    0.152535</span></span>
<span class="line"><span>  1.05935    -0.565167   -1.27049    …  -0.460655     1.17721     0.428739</span></span>
<span class="line"><span> -0.282804   -1.49593    -2.54169        0.25486      1.09307     1.75219</span></span>
<span class="line"><span> -1.25632    -0.362553    0.305122       2.13352     -1.44251     0.501179</span></span>
<span class="line"><span> -0.621103   -1.11994     1.65988       -1.28509     -0.928562   -1.13418</span></span>
<span class="line"><span>  0.493673   -1.4562      1.70243        1.01968     -0.964679   -1.17621</span></span>
<span class="line"><span>  ⋮                                  ⋱   ⋮                       </span></span>
<span class="line"><span> -1.22057     0.531929   -0.0841045     -1.01232      1.89455    -0.486553</span></span>
<span class="line"><span>  0.916459    1.43045    -0.830426   …   1.10855      0.829399   -0.070775</span></span>
<span class="line"><span>  1.59552    -0.779778   -0.326881      -0.152029    -0.101989    1.85498</span></span>
<span class="line"><span> -1.05128     0.491878    1.17028       -0.814344    -0.767232   -0.104464</span></span>
<span class="line"><span>  0.243358   -0.0288306  -0.140886      -0.00362951  -1.42057     1.26966</span></span>
<span class="line"><span> -1.44502     0.654612   -0.267343      -0.686056    -0.588395    0.085004</span></span>
<span class="line"><span>  0.670296    0.889431    0.564166   …   1.48393      0.38317     0.778055</span></span>
<span class="line"><span> -0.979213   -0.0132893   1.06811        0.0480311   -0.861362    1.11876</span></span>
<span class="line"><span> -0.0377959  -2.00042    -0.734298       2.18866      0.176042    0.0990701</span></span></code></pre></div><p>Now instead of compiling the model, we will use <code>Reactant.@code_hlo</code> to generate the StableHLO code.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hlo_code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @code_hlo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ps, st)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>module {</span></span>
<span class="line"><span>  func.func @main(%arg0: tensor&lt;4x1x28x28xf32&gt;, %arg1: tensor&lt;6x1x5x5xf32&gt;, %arg2: tensor&lt;6xf32&gt;, %arg3: tensor&lt;16x6x5x5xf32&gt;, %arg4: tensor&lt;16xf32&gt;, %arg5: tensor&lt;256x128xf32&gt;, %arg6: tensor&lt;128xf32&gt;, %arg7: tensor&lt;128x84xf32&gt;, %arg8: tensor&lt;84xf32&gt;, %arg9: tensor&lt;84x10xf32&gt;, %arg10: tensor&lt;10xf32&gt;) -&gt; tensor&lt;4x10xf32&gt; {</span></span>
<span class="line"><span>    %cst = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %cst_0 = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %cst_1 = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %cst_2 = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %cst_3 = stablehlo.constant dense&lt;0xFF800000&gt; : tensor&lt;f32&gt;</span></span>
<span class="line"><span>    %0 = stablehlo.transpose %arg1, dims = [3, 2, 1, 0] : (tensor&lt;6x1x5x5xf32&gt;) -&gt; tensor&lt;5x5x1x6xf32&gt;</span></span>
<span class="line"><span>    %1 = stablehlo.transpose %arg3, dims = [3, 2, 1, 0] : (tensor&lt;16x6x5x5xf32&gt;) -&gt; tensor&lt;5x5x6x16xf32&gt;</span></span>
<span class="line"><span>    %2 = stablehlo.reverse %0, dims = [0, 1] : tensor&lt;5x5x1x6xf32&gt;</span></span>
<span class="line"><span>    %3 = stablehlo.convolution(%arg0, %2) dim_numbers = [b, f, 1, 0]x[0, 1, i, o]-&gt;[0, 1, f, b], window = {stride = [1, 1], pad = [[0, 0], [0, 0]], rhs_dilate = [1, 1]} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor&lt;4x1x28x28xf32&gt;, tensor&lt;5x5x1x6xf32&gt;) -&gt; tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %4 = stablehlo.broadcast_in_dim %arg2, dims = [2] : (tensor&lt;6xf32&gt;) -&gt; tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %5 = stablehlo.add %3, %4 : tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %6 = stablehlo.compare  LT, %5, %cst_2 : (tensor&lt;24x24x6x4xf32&gt;, tensor&lt;24x24x6x4xf32&gt;) -&gt; tensor&lt;24x24x6x4xi1&gt;</span></span>
<span class="line"><span>    %7 = stablehlo.select %6, %cst_2, %5 : tensor&lt;24x24x6x4xi1&gt;, tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %8 = &quot;stablehlo.reduce_window&quot;(%7, %cst_3) &lt;{padding = dense&lt;0&gt; : tensor&lt;4x2xi64&gt;, window_dilations = array&lt;i64: 1, 1, 1, 1&gt;, window_dimensions = array&lt;i64: 2, 2, 1, 1&gt;, window_strides = array&lt;i64: 2, 2, 1, 1&gt;}&gt; ({</span></span>
<span class="line"><span>    ^bb0(%arg11: tensor&lt;f32&gt;, %arg12: tensor&lt;f32&gt;):</span></span>
<span class="line"><span>      %32 = stablehlo.maximum %arg11, %arg12 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>      stablehlo.return %32 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>    }) : (tensor&lt;24x24x6x4xf32&gt;, tensor&lt;f32&gt;) -&gt; tensor&lt;12x12x6x4xf32&gt;</span></span>
<span class="line"><span>    %9 = stablehlo.reverse %1, dims = [0, 1] : tensor&lt;5x5x6x16xf32&gt;</span></span>
<span class="line"><span>    %10 = stablehlo.convolution(%8, %9) dim_numbers = [0, 1, f, b]x[0, 1, i, o]-&gt;[0, 1, f, b], window = {stride = [1, 1], pad = [[0, 0], [0, 0]], rhs_dilate = [1, 1]} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor&lt;12x12x6x4xf32&gt;, tensor&lt;5x5x6x16xf32&gt;) -&gt; tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %11 = stablehlo.broadcast_in_dim %arg4, dims = [2] : (tensor&lt;16xf32&gt;) -&gt; tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %12 = stablehlo.add %10, %11 : tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %13 = stablehlo.compare  LT, %12, %cst_1 : (tensor&lt;8x8x16x4xf32&gt;, tensor&lt;8x8x16x4xf32&gt;) -&gt; tensor&lt;8x8x16x4xi1&gt;</span></span>
<span class="line"><span>    %14 = stablehlo.select %13, %cst_1, %12 : tensor&lt;8x8x16x4xi1&gt;, tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %15 = &quot;stablehlo.reduce_window&quot;(%14, %cst_3) &lt;{padding = dense&lt;0&gt; : tensor&lt;4x2xi64&gt;, window_dilations = array&lt;i64: 1, 1, 1, 1&gt;, window_dimensions = array&lt;i64: 2, 2, 1, 1&gt;, window_strides = array&lt;i64: 2, 2, 1, 1&gt;}&gt; ({</span></span>
<span class="line"><span>    ^bb0(%arg11: tensor&lt;f32&gt;, %arg12: tensor&lt;f32&gt;):</span></span>
<span class="line"><span>      %32 = stablehlo.maximum %arg11, %arg12 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>      stablehlo.return %32 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>    }) : (tensor&lt;8x8x16x4xf32&gt;, tensor&lt;f32&gt;) -&gt; tensor&lt;4x4x16x4xf32&gt;</span></span>
<span class="line"><span>    %16 = stablehlo.transpose %15, dims = [3, 2, 1, 0] : (tensor&lt;4x4x16x4xf32&gt;) -&gt; tensor&lt;4x16x4x4xf32&gt;</span></span>
<span class="line"><span>    %17 = stablehlo.reshape %16 : (tensor&lt;4x16x4x4xf32&gt;) -&gt; tensor&lt;4x256xf32&gt;</span></span>
<span class="line"><span>    %18 = stablehlo.dot_general %arg5, %17, contracting_dims = [0] x [1], precision = [DEFAULT, DEFAULT] : (tensor&lt;256x128xf32&gt;, tensor&lt;4x256xf32&gt;) -&gt; tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %19 = stablehlo.broadcast_in_dim %arg6, dims = [0] : (tensor&lt;128xf32&gt;) -&gt; tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %20 = stablehlo.add %18, %19 : tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %21 = stablehlo.compare  LT, %20, %cst_0 : (tensor&lt;128x4xf32&gt;, tensor&lt;128x4xf32&gt;) -&gt; tensor&lt;128x4xi1&gt;</span></span>
<span class="line"><span>    %22 = stablehlo.select %21, %cst_0, %20 : tensor&lt;128x4xi1&gt;, tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %23 = stablehlo.dot_general %arg7, %22, contracting_dims = [0] x [0], precision = [DEFAULT, DEFAULT] : (tensor&lt;128x84xf32&gt;, tensor&lt;128x4xf32&gt;) -&gt; tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %24 = stablehlo.broadcast_in_dim %arg8, dims = [0] : (tensor&lt;84xf32&gt;) -&gt; tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %25 = stablehlo.add %23, %24 : tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %26 = stablehlo.compare  LT, %25, %cst : (tensor&lt;84x4xf32&gt;, tensor&lt;84x4xf32&gt;) -&gt; tensor&lt;84x4xi1&gt;</span></span>
<span class="line"><span>    %27 = stablehlo.select %26, %cst, %25 : tensor&lt;84x4xi1&gt;, tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %28 = stablehlo.dot_general %arg9, %27, contracting_dims = [0] x [0], precision = [DEFAULT, DEFAULT] : (tensor&lt;84x10xf32&gt;, tensor&lt;84x4xf32&gt;) -&gt; tensor&lt;10x4xf32&gt;</span></span>
<span class="line"><span>    %29 = stablehlo.broadcast_in_dim %arg10, dims = [0] : (tensor&lt;10xf32&gt;) -&gt; tensor&lt;10x4xf32&gt;</span></span>
<span class="line"><span>    %30 = stablehlo.add %28, %29 : tensor&lt;10x4xf32&gt;</span></span>
<span class="line"><span>    %31 = stablehlo.transpose %30, dims = [1, 0] : (tensor&lt;10x4xf32&gt;) -&gt; tensor&lt;4x10xf32&gt;</span></span>
<span class="line"><span>    return %31 : tensor&lt;4x10xf32&gt;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>Now we just save this into an <code>mlir</code> file.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;exported_lux_model.mlir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;w&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> io</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    write</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hlo_code))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>4850</span></span></code></pre></div><p>Now we define a python script to run the model using EnzymeJAX.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> enzyme_ad.jax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hlo_call</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jnp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;exported_lux_model.mlir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;r&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.read()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run_lux_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hlo_call(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        x,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_3,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        source</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Note that all the inputs must be transposed, i.e. if the julia function has an input of</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># shape (28, 28, 1, 4), then the input to the exported function called from python must be</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># of shape (4, 1, 28, 28). This is because multi-dimensional arrays in Julia are stored in</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># column-major order, while in JAX/Python they are stored in row-major order.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Input as defined in our exported Lux model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Weights and biases corresponding to `ps` and `st` in our exported Lux model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight6_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias6_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight6_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias6_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight6_3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias6_3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Run the exported Lux model</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    jax.jit(run_lux_model)(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        x,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/LuxDL/Lux.jl/edit/main/docs/src/manual/exporting_to_jax.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page on GitHub<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/v1.4.1/manual/compiling_lux_models" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Compiling Lux Models</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/v1.4.1/manual/autodiff" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Automatic Differentiation</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://documenter.juliadocs.org/stable/" target="_blank"><strong>Documenter.jl</strong></a>, <a href="https://vitepress.dev" target="_blank"><strong>VitePress</strong></a> and <a href="https://luxdl.github.io/DocumenterVitepress.jl/stable" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href="https://www.julialang.org">Julia Programming Language</a>.<br></p><p class="copyright" data-v-c970a860>© Copyright 2024 Avik Pal.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_accelerator_support_mldatadevices.md\":\"DwZvApLS\",\"api_building_blocks_luxcore.md\":\"C5N_7MaS\",\"api_building_blocks_weightinitializers.md\":\"CFgwXfh3\",\"api_lux_autodiff.md\":\"Dc9rl5P3\",\"api_lux_contrib.md\":\"DXNYHibD\",\"api_lux_distributed_utils.md\":\"BrEu_yhc\",\"api_lux_interop.md\":\"C1C3JODh\",\"api_lux_layers.md\":\"DK06R7rM\",\"api_lux_utilities.md\":\"Bh3VpHHA\",\"api_nn_primitives_activationfunctions.md\":\"mEZCbZHs\",\"api_nn_primitives_luxlib.md\":\"DadnlsLd\",\"api_nn_primitives_nnlib.md\":\"QlikSj9F\",\"api_testing_functionality_luxtestutils.md\":\"CTT1AFoh\",\"index.md\":\"CNbM7jug\",\"introduction_citation.md\":\"DX4e31Ns\",\"introduction_index.md\":\"DMAcx_p8\",\"introduction_overview.md\":\"Il2tet5g\",\"introduction_resources.md\":\"I1lM2fC0\",\"introduction_updating_to_v1.md\":\"C1CInfNr\",\"manual_autodiff.md\":\"xnnKuC3J\",\"manual_compiling_lux_models.md\":\"DZKfVI49\",\"manual_debugging.md\":\"BiXz9NNm\",\"manual_dispatch_custom_input.md\":\"wa6Fda_9\",\"manual_distributed_utils.md\":\"DYuOdZ2R\",\"manual_exporting_to_jax.md\":\"oF1gY-gI\",\"manual_freezing_model_parameters.md\":\"DMaXJsUR\",\"manual_gpu_management.md\":\"BNnJ4JrF\",\"manual_interface.md\":\"C7tV8DfX\",\"manual_migrate_from_flux.md\":\"CBO0nf62\",\"manual_nested_autodiff.md\":\"0_OVh176\",\"manual_nn_inside_gpu_kernels.md\":\"CwYK5hjG\",\"manual_performance_pitfalls.md\":\"CWOHpun5\",\"manual_preferences.md\":\"6bM4YhsN\",\"manual_weight_initializers.md\":\"Bc2yimtS\",\"tutorials_advanced_1_gravitationalwaveform.md\":\"D8XvLhD4\",\"tutorials_beginner_1_basics.md\":\"DiS_LgsO\",\"tutorials_beginner_2_polynomialfitting.md\":\"Cntj9iw2\",\"tutorials_beginner_3_simplernn.md\":\"8srm2pZ4\",\"tutorials_beginner_4_simplechains.md\":\"BdJfoMnq\",\"tutorials_beginner_5_optimizationintegration.md\":\"BBRG4SvQ\",\"tutorials_index.md\":\"CoTX4CVz\",\"tutorials_intermediate_1_neuralode.md\":\"BgDpcAsp\",\"tutorials_intermediate_2_bayesiannn.md\":\"CKBnnv93\",\"tutorials_intermediate_3_hypernet.md\":\"DbIYdcTr\",\"tutorials_intermediate_4_pinn2dpde.md\":\"P7kiimYG\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Lux.jl Docs\",\"description\":\"Documentation for LuxDL Repositories\",\"base\":\"/v1.4.1/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"light\":\"/lux-logo.svg\",\"dark\":\"/lux-logo-dark.svg\"},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting Started\",\"link\":\"/introduction\"},{\"text\":\"Benchmarks\",\"link\":\"https://lux.csail.mit.edu/benchmarks/\"},{\"text\":\"Tutorials\",\"link\":\"/tutorials/\"},{\"text\":\"Manual\",\"link\":\"/manual/interface\"},{\"text\":\"API\",\"items\":[{\"text\":\"Lux\",\"items\":[{\"text\":\"Built-In Layers\",\"link\":\"/api/Lux/layers\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/api/Lux/autodiff\"},{\"text\":\"Utilities\",\"link\":\"/api/Lux/utilities\"},{\"text\":\"Experimental\",\"link\":\"/api/Lux/contrib\"},{\"text\":\"InterOp\",\"link\":\"/api/Lux/interop\"},{\"text\":\"DistributedUtils\",\"link\":\"/api/Lux/distributed_utils\"}]},{\"text\":\"Accelerator Support\",\"items\":[{\"text\":\"MLDataDevices\",\"link\":\"/api/Accelerator_Support/MLDataDevices\"}]},{\"text\":\"NN Primitives\",\"items\":[{\"text\":\"LuxLib\",\"link\":\"/api/NN_Primitives/LuxLib\"},{\"text\":\"NNlib\",\"link\":\"/api/NN_Primitives/NNlib\"},{\"text\":\"Activation Functions\",\"link\":\"/api/NN_Primitives/ActivationFunctions\"}]},{\"text\":\"Building Blocks\",\"items\":[{\"text\":\"LuxCore\",\"link\":\"/api/Building_Blocks/LuxCore\"},{\"text\":\"WeightInitializers\",\"link\":\"/api/Building_Blocks/WeightInitializers\"}]},{\"text\":\"Testing Functionality\",\"items\":[{\"text\":\"LuxTestUtils\",\"link\":\"/api/Testing_Functionality/LuxTestUtils\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":{\"/introduction/\":{\"text\":\"Getting Started\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"link\":\"/introduction\"},{\"text\":\"Overview\",\"link\":\"/introduction/overview\"},{\"text\":\"Resources\",\"link\":\"/introduction/resources\"},{\"text\":\"Updating to v1\",\"link\":\"/introduction/updating_to_v1\"},{\"text\":\"Citation\",\"link\":\"/introduction/citation\"}]},\"/tutorials/\":{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/\"},{\"text\":\"Beginner\",\"collapsed\":false,\"items\":[{\"text\":\"Julia & Lux for the Uninitiated\",\"link\":\"/tutorials/beginner/1_Basics\"},{\"text\":\"Fitting a Polynomial using MLP\",\"link\":\"/tutorials/beginner/2_PolynomialFitting\"},{\"text\":\"Training a Simple LSTM\",\"link\":\"/tutorials/beginner/3_SimpleRNN\"},{\"text\":\"MNIST Classification with SimpleChains\",\"link\":\"/tutorials/beginner/4_SimpleChains\"},{\"text\":\"Fitting with Optimization.jl\",\"link\":\"/tutorials/beginner/5_OptimizationIntegration\"}]},{\"text\":\"Intermediate\",\"collapsed\":false,\"items\":[{\"text\":\"MNIST Classification using Neural ODEs\",\"link\":\"/tutorials/intermediate/1_NeuralODE\"},{\"text\":\"Bayesian Neural Network\",\"link\":\"/tutorials/intermediate/2_BayesianNN\"},{\"text\":\"Training a HyperNetwork on MNIST and FashionMNIST\",\"link\":\"/tutorials/intermediate/3_HyperNet\"},{\"text\":\"Training a PINN on 2D PDE\",\"link\":\"/tutorials/intermediate/4_PINN2DPDE\"}]},{\"text\":\"Advanced\",\"collapsed\":false,\"items\":[{\"text\":\"Training a Neural ODE to Model Gravitational Waveforms\",\"link\":\"/tutorials/advanced/1_GravitationalWaveForm\"}]},{\"text\":\"Larger Models\",\"collapsed\":true,\"items\":[{\"text\":\"Training Image Classification Models on ImageNet with Distributed Data Parallel Training\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/ImageNet\"},{\"text\":\"Training a DDIM (Diffusion Model) for Image Generation\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/DDIM\"},{\"text\":\"ConvMixer on CIFAR-10\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/ConvMixer\"}]},{\"text\":\"3rd Party Tutorials\",\"collapsed\":true,\"items\":[{\"text\":\"PINNs (NeuralPDE.jl)\",\"link\":\"https://docs.sciml.ai/NeuralPDE/stable/tutorials/pdesystem/\"},{\"text\":\"UDEs (SciMLSensitivity.jl)\",\"link\":\"https://docs.sciml.ai/SciMLSensitivity/stable/tutorials/data_parallel/\"},{\"text\":\"Neural DEs (DiffEqFlux.jl)\",\"link\":\"https://docs.sciml.ai/DiffEqFlux/stable/examples/neural_ode/\"},{\"text\":\"DEQs (DeepEquilibriumNetworks.jl)\",\"link\":\"https://docs.sciml.ai/DeepEquilibriumNetworks/stable/tutorials/basic_mnist_deq/\"},{\"text\":\"Medical Image Segmentation\",\"link\":\"https://github.com/Dale-Black/ComputerVisionTutorials.jl/\"},{\"text\":\"Neural Closure Models\",\"link\":\"https://github.com/agdestein/NeuralClosureTutorials/\"}]}]},\"/manual/\":{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Basics\",\"items\":[{\"text\":\"Lux Interface\",\"link\":\"/manual/interface\"},{\"text\":\"Freezing Parameters\",\"link\":\"/manual/freezing_model_parameters\"},{\"text\":\"GPU Management\",\"link\":\"/manual/gpu_management\"},{\"text\":\"Initializing Weights\",\"link\":\"/manual/weight_initializers\"}]},{\"text\":\"Reactant Compilation\",\"items\":[{\"text\":\"Compiling Lux Models\",\"link\":\"/manual/compiling_lux_models\"},{\"text\":\"Exporting Lux Models to Jax\",\"link\":\"/manual/exporting_to_jax\"}]},{\"text\":\"Automatic Differentiation\",\"items\":[{\"text\":\"Automatic Differentiation\",\"link\":\"/manual/autodiff\"},{\"text\":\"Nested AutoDiff\",\"link\":\"/manual/nested_autodiff\"}]},{\"text\":\"Debugging / Performance Enhancement Tools\",\"items\":[{\"text\":\"Debugging Lux Models\",\"link\":\"/manual/debugging\"},{\"text\":\"Performance Pitfalls\",\"link\":\"/manual/performance_pitfalls\"}]},{\"text\":\"Migration Guides\",\"items\":[{\"text\":\"Migrating from Flux\",\"link\":\"/manual/migrate_from_flux\"}]},{\"text\":\"Advanced Usage\",\"items\":[{\"text\":\"Custom Input Types\",\"link\":\"/manual/dispatch_custom_input\"},{\"text\":\"Configuration via Preferences\",\"link\":\"/manual/preferences\"},{\"text\":\"Distributed Training\",\"link\":\"/manual/distributed_utils\"},{\"text\":\"Lux In GPU Kernels\",\"link\":\"/manual/nn_inside_gpu_kernels\"}]}]},\"/api/\":{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Lux\",\"collapsed\":false,\"items\":[{\"text\":\"Built-In Layers\",\"link\":\"/api/Lux/layers\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/api/Lux/autodiff\"},{\"text\":\"Utilities\",\"link\":\"/api/Lux/utilities\"},{\"text\":\"Experimental Features\",\"link\":\"/api/Lux/contrib\"},{\"text\":\"Interoperability\",\"link\":\"/api/Lux/interop\"},{\"text\":\"DistributedUtils\",\"link\":\"/api/Lux/distributed_utils\"}]},{\"text\":\"Accelerator Support\",\"collapsed\":false,\"items\":[{\"text\":\"MLDataDevices\",\"link\":\"/api/Accelerator_Support/MLDataDevices\"}]},{\"text\":\"NN Primitives\",\"collapsed\":false,\"items\":[{\"text\":\"LuxLib\",\"link\":\"/api/NN_Primitives/LuxLib\"},{\"text\":\"NNlib\",\"link\":\"/api/NN_Primitives/NNlib\"},{\"text\":\"Activation Functions\",\"link\":\"/api/NN_Primitives/ActivationFunctions\"}]},{\"text\":\"Building Blocks\",\"collapsed\":false,\"items\":[{\"text\":\"LuxCore\",\"link\":\"/api/Building_Blocks/LuxCore\"},{\"text\":\"WeightInitializers\",\"link\":\"/api/Building_Blocks/WeightInitializers\"}]},{\"text\":\"Testing Functionality\",\"collapsed\":false,\"items\":[{\"text\":\"LuxTestUtils\",\"link\":\"/api/Testing_Functionality/LuxTestUtils\"}]}]}},\"editLink\":{\"pattern\":\"https://github.com/LuxDL/Lux.jl/edit/main/docs/src/:path\",\"text\":\"Edit this page on GitHub\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/LuxDL/Lux.jl\"},{\"icon\":\"twitter\",\"link\":\"https://twitter.com/avikpal1410\"},{\"icon\":\"slack\",\"link\":\"https://julialang.org/slack/\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://documenter.juliadocs.org/stable/\\\" target=\\\"_blank\\\"><strong>Documenter.jl</strong></a>, <a href=\\\"https://vitepress.dev\\\" target=\\\"_blank\\\"><strong>VitePress</strong></a> and <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/stable\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href=\\\"https://www.julialang.org\\\">Julia Programming Language</a>.<br>\",\"copyright\":\"© Copyright 2024 Avik Pal.\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>