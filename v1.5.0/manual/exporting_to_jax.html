<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Exporting Lux Models to Jax (via EnzymeJAX &amp; Reactant) | Lux.jl Docs</title>
    <meta name="description" content="Documentation for LuxDL Repositories">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/v1.5.0/assets/style.DibcgbLv.css" as="style">
    <link rel="preload stylesheet" href="/v1.5.0/vp-icons.css" as="style">
    
    <script type="module" src="/v1.5.0/assets/app.BrH6v-e1.js"></script>
    <link rel="preload" href="/v1.5.0/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/v1.5.0/assets/chunks/theme.CSpFuADZ.js">
    <link rel="modulepreload" href="/v1.5.0/assets/chunks/framework.C24IT_go.js">
    <link rel="modulepreload" href="/v1.5.0/assets/manual_exporting_to_jax.md.D8zqYWoY.lean.js">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q8GYTEVTZ2"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Q8GYTEVTZ2");</script>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="REPLACE_ME_DOCUMENTER_VITEPRESS_FAVICON">
    <script src="/versions.js"></script>
    <script src="/v1.5.0/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/v1.5.0/" data-v-0f4f798b><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/v1.5.0/lux-logo-dark.svg" alt data-v-35a7d0b8><!--]--><!--[--><img class="VPImage light logo" src="/v1.5.0/lux-logo.svg" alt data-v-35a7d0b8><!--]--><!--]--><!--]--><span data-v-0f4f798b>Lux.jl Docs</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.5.0/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.5.0/introduction" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Getting Started</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://lux.csail.mit.edu/benchmarks/" target="_blank" rel="noreferrer" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Benchmarks</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.5.0/tutorials/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Tutorials</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v1.5.0/manual/interface" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Manual</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>API</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Lux</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Lux/layers" data-v-acbfed09><!--[--><span data-v-acbfed09>Built-In Layers</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Lux/autodiff" data-v-acbfed09><!--[--><span data-v-acbfed09>Automatic Differentiation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Lux/utilities" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Lux/contrib" data-v-acbfed09><!--[--><span data-v-acbfed09>Experimental</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Lux/interop" data-v-acbfed09><!--[--><span data-v-acbfed09>InterOp</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Lux/distributed_utils" data-v-acbfed09><!--[--><span data-v-acbfed09>DistributedUtils</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Accelerator Support</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Accelerator_Support/MLDataDevices" data-v-acbfed09><!--[--><span data-v-acbfed09>MLDataDevices</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>NN Primitives</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/NN_Primitives/LuxLib" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxLib</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/NN_Primitives/NNlib" data-v-acbfed09><!--[--><span data-v-acbfed09>NNlib</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/NN_Primitives/ActivationFunctions" data-v-acbfed09><!--[--><span data-v-acbfed09>Activation Functions</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Building Blocks</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Building_Blocks/LuxCore" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxCore</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Building_Blocks/WeightInitializers" data-v-acbfed09><!--[--><span data-v-acbfed09>WeightInitializers</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Testing Functionality</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/v1.5.0/api/Testing_Functionality/LuxTestUtils" data-v-acbfed09><!--[--><span data-v-acbfed09>LuxTestUtils</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LuxDL/Lux.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/avikpal1410" aria-label="twitter" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LuxDL/Lux.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/avikpal1410" aria-label="twitter" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-bc9dc845><button data-v-bc9dc845>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Basics</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/interface" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Lux Interface</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/freezing_model_parameters" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Freezing Parameters</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/gpu_management" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>GPU Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/weight_initializers" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Initializing Weights</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 has-active" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Reactant Compilation</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/compiling_lux_models" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Compiling Lux Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/exporting_to_jax" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Exporting Lux Models to Jax</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Automatic Differentiation</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/autodiff" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Automatic Differentiation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/nested_autodiff" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Nested AutoDiff</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Debugging / Performance Enhancement Tools</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/debugging" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Debugging Lux Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/performance_pitfalls" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Performance Pitfalls</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Migration Guides</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/migrate_from_flux" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Migrating from Flux</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Advanced Usage</h2><!----></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/dispatch_custom_input" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Custom Input Types</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/preferences" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Configuration via Preferences</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/distributed_utils" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Distributed Training</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/v1.5.0/manual/nn_inside_gpu_kernels" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Lux In GPU Kernels</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--[--><!--[--><!--[--><!--[--><br><h2> Trusted by </h2><a class="enjoyer" href="https://sciml.ai/" target="_blank"><img width="32" height="32" src="https://avatars.githubusercontent.com/u/21238080?v=4"><span><p class="extra-info">Scientific Computing</p><p class="heading">SciML.ai</p><p class="extra-info">Machine Learning</p></span></a><!--]--><!--]--><!--]--><!--]--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _v1_5_0_manual_exporting_to_jax" data-v-83890dd9><div><h1 id="Exporting-Lux-Models-to-Jax-(via-EnzymeJAX-and-Reactant)" tabindex="-1">Exporting Lux Models to Jax (via EnzymeJAX &amp; Reactant) <a class="header-anchor" href="#Exporting-Lux-Models-to-Jax-(via-EnzymeJAX-and-Reactant)" aria-label="Permalink to &quot;Exporting Lux Models to Jax (via EnzymeJAX &amp;amp; Reactant) {#Exporting-Lux-Models-to-Jax-(via-EnzymeJAX-and-Reactant)}&quot;">​</a></h1><div class="danger custom-block"><p class="custom-block-title">Experimental</p><p>This feature is experimental and is subject to change without notice. Additionally, this feature currently requires some manual setup for interacting with Jax, which we are working on improving.</p></div><p>In this manual, we will go over how to export Lux models to StableHLO and use <a href="https://github.com/EnzymeAD/Enzyme-JAX" target="_blank" rel="noreferrer">EnzymeJAX</a> to run integrate Lux models with JAX. We assume that users are familiar with <a href="/v1.5.0/manual/compiling_lux_models#reactant-compilation">Reactant compilation of Lux models</a>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux, Reactant, Random</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reactant_device</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(::ReactantDevice{Missing, Missing}) (generic function with 1 method)</span></span></code></pre></div><p>We simply define a Lux model and generate the stablehlo code using <code>Reactant.@code_hlo</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Conv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MaxPool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Conv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    MaxPool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    FlattenLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ps, st </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_rng</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), model) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dev;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>((layer_1 = (weight = Reactant.ConcreteRArray{Float32, 4}(Float32[-0.100514844 0.641402 … 0.15222053 -0.5301181; 0.45682606 0.5083343 … 0.06879873 0.10708179; … ; 0.2401375 0.18095753 … 0.148147 -0.68299204; 0.11708575 0.048821628 … 0.62626415 -0.6875213;;;; 0.45953766 0.6877121 … 0.48257408 -0.52564013; 0.22677277 -0.58328676 … -0.23234344 -0.45553648; … ; 0.15218197 -0.63391256 … 0.17440075 0.120217; -0.055573903 -0.3379242 … -0.59377456 0.41815332;;;; -0.5203194 0.26564768 … 0.2880513 -0.24490844; 0.2609411 0.2002995 … 0.26858228 -0.26229796; … ; 0.09441388 0.24978368 … -0.3149016 0.16969556; 0.6395181 0.059671473 … 0.3798853 0.3777897;;;; 0.32651654 -0.5890444 … -0.1751135 -0.41645882; -0.5597971 0.5320771 … -0.67852753 0.107406616; … ; -0.016386721 -0.6846315 … 0.049217567 -0.64721453; -0.39763013 -0.35652733 … 0.14593515 -0.28993338;;;; -0.2656273 -0.600764 … 0.12497909 -0.15026206; 0.65176255 0.058104068 … -0.16105938 0.3143208; … ; -0.14073242 -0.3695437 … 0.6207278 -0.47512773; -0.13825017 0.3013572 … -0.13684514 -0.4450739;;;; 0.31697956 0.5574339 … -0.2093402 0.6882201; 0.033461835 -0.39950222 … -0.48107117 0.5505513; … ; -0.17039865 0.6595012 … -0.46096706 -0.15864038; 0.06682308 0.285972 … 0.5155236 0.34457564]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[-0.09860833, -0.18450394, -0.172313, -0.09282472, 0.1309025, 0.061889123])), layer_2 = NamedTuple(), layer_3 = (weight = Reactant.ConcreteRArray{Float32, 4}(Float32[0.11987625 0.24046357 … 0.22752927 0.21899778; 0.2806326 0.2810528 … -0.274844 0.15035425; … ; -0.23564403 -0.0028807875 … -0.10842768 -0.18919921; -0.19969921 -0.268992 … -0.2370692 -0.039153982;;; -0.03374887 -0.093958974 … -0.280846 0.26553962; 0.122150525 0.20753737 … 0.14238782 -0.079042196; … ; 0.09650694 0.20296505 … -0.17326018 0.16363813; -0.118356064 0.16504566 … 0.18531604 -0.13996856;;; 0.2514698 -0.17938598 … -0.05262428 -0.06740383; -0.24503033 0.11728277 … -0.13142236 -0.011098074; … ; -0.23847201 -0.24982567 … -0.23192994 0.044427596; 0.18960184 -0.16340032 … -0.18996632 0.09250315;;; -0.12397134 0.12766095 … 0.2779469 0.052803323; 0.039103575 0.004629241 … -0.15262935 -0.111676365; … ; 0.19498321 0.11950846 … -0.06528456 0.008846691; 0.22409724 -0.018854173 … 0.13590635 -0.22521684;;; 0.18495357 0.10401063 … -0.2670698 0.17617925; 0.14366318 0.20561251 … -0.26477206 0.0015469915; … ; 0.27561936 0.0011872598 … -0.17211406 -0.19183022; 0.005086349 0.17840558 … -0.072645485 0.17083026;;; -0.27658862 -0.17361793 … 0.242468 -0.039650977; -0.24199852 0.27319488 … -0.04899112 -0.20071083; … ; 0.09189941 0.014689862 … 0.051825043 -0.12811285; -0.08589938 0.08455851 … 0.07319629 -0.1747854;;;; -0.22517107 0.020608762 … 0.08025096 -0.14336014; 0.20636114 -0.17598884 … 0.20585205 0.1303978; … ; 0.07489191 -0.11631798 … 0.058901027 -0.2794292; -0.0799499 0.19019358 … 0.20101166 -0.15967444;;; -0.17029636 -0.21178308 … 0.002483191 0.034200985; 0.04447686 -0.15771388 … -0.120917246 -0.054846566; … ; -0.06445969 -0.116768986 … -0.24997774 -0.06368081; 0.113006115 -0.08338781 … 0.10346943 0.13751146;;; -0.20694472 0.19138478 … -0.266974 0.085806124; 0.2147609 0.21121861 … 0.027592428 0.12180024; … ; -0.16645215 -0.26774603 … -0.09705801 0.16954337; 0.0055776797 0.08746583 … 0.12936348 0.2017526;;; -0.0018348376 -0.2567473 … -0.26520002 -0.031490605; -0.056034062 -0.176348 … -0.14361875 0.01490508; … ; -0.018303769 -0.0017325052 … 0.2108695 -0.14421012; -0.20487879 -0.19641913 … -0.017829532 0.09932359;;; 0.14163494 0.063480295 … 0.03308521 0.10206564; -0.19744 0.07638691 … -0.23707482 -0.0973789; … ; 0.14562015 0.038802307 … -0.03170667 -0.103913486; 0.09442957 -0.015896475 … -0.044987272 0.24539067;;; 0.08269734 0.17385432 … 0.19634563 0.0692472; -0.20779805 0.12078848 … 0.24063988 0.2714335; … ; -0.105389535 -0.20656037 … 0.15708946 0.18803856; 0.26072562 -0.003485207 … -0.1243891 0.07297467;;;; -0.08554761 0.21957569 … -0.2742818 0.18916532; 0.08927501 -0.1186073 … 0.17124604 -0.19405301; … ; 0.19792819 0.10561423 … -0.19954802 0.1752539; -0.2632644 0.14365605 … 0.048471738 0.15499277;;; 0.059055757 -0.031942792 … 0.21004838 0.049328804; -0.010950223 -0.092265144 … 0.2666627 -0.014741955; … ; -0.2008716 -0.05379219 … 0.24238436 -0.26664025; 0.016865179 0.01717774 … -0.20316577 0.17713173;;; -0.19995327 -0.09096992 … 0.23395808 -0.012063608; -0.21295139 -0.08832364 … -0.21398924 0.047317084; … ; 0.114560924 -0.12348884 … 0.059224278 -0.25860527; -0.17703351 -0.22157605 … 0.17337337 -0.16027175;;; 0.104936846 -0.08765691 … 0.12241076 -0.14012684; 0.2597034 -0.017866217 … 0.12900914 -0.06272482; … ; -0.008840925 0.062121924 … 0.106482625 0.14555879; -0.028596466 -0.07552715 … -0.08260414 0.13732003;;; 0.12650935 0.09646284 … 0.24086508 0.24695547; 0.08096753 0.09591715 … 0.023150858 -0.26545027; … ; 0.19313364 -0.017933888 … -0.15105338 0.1678572; 0.2614398 -0.039614968 … 0.1461747 0.1272793;;; -0.03461915 0.12092318 … 0.012866791 0.1759687; -0.046394978 -0.18018521 … -0.20192719 0.16220272; … ; 0.06777759 -0.15605855 … -0.12559004 -0.061299384; -0.019838588 0.17196824 … -0.20025302 0.040938716;;;; … ;;;; 0.20436017 0.036468588 … 0.07778767 -0.21271591; 0.100167036 -0.1687434 … -0.2821546 0.031386353; … ; 0.23258851 0.27682805 … -0.09668045 0.16447622; -0.19094673 0.048154727 … -0.023283502 0.21796629;;; -0.019472213 0.21634498 … 0.21686329 0.07765452; 0.026193827 0.2553826 … -0.025493514 -0.14033335; … ; -0.23084445 0.03278077 … 0.20206891 0.10923161; 0.08846138 -0.1163871 … -0.10242631 0.23552088;;; -0.17115343 -0.09725678 … -0.14884971 -0.04715905; 0.10361175 0.22230405 … 0.19065982 -0.14736821; … ; -0.08358303 -0.17538628 … 0.08115203 0.027224839; -0.1990666 -0.20310251 … -0.26493692 -0.1941834;;; -0.09596483 -0.05095075 … -0.0883609 -0.10116895; -0.24626082 0.1807569 … -0.014606951 -0.020255674; … ; 0.26055062 0.062463008 … 0.24080847 0.22719024; 0.25654957 0.15332098 … -0.22900078 -0.0035986663;;; -0.06315138 -0.12076889 … -0.09900095 0.21833563; -0.0016859076 0.104042254 … -0.11325522 -0.24203484; … ; -0.13540733 -0.06715196 … -0.24817711 -0.036290962; -0.27834624 0.023097955 … -0.19361475 0.17604505;;; 0.1645548 -0.120147206 … 0.14359581 -0.043790642; 0.10464323 0.12229406 … 0.0069064857 -0.08437178; … ; -0.22202058 -0.21096227 … 0.07406641 0.06445622; 0.10097251 -0.060633026 … -0.18000072 -0.07600229;;;; -0.12116281 0.11673186 … 0.04368514 0.051994912; 0.0824661 -0.117853135 … -0.23987544 0.031034712; … ; -0.02109389 -0.13760304 … 0.057713665 0.037877575; 0.010567766 0.09230051 … 0.13399862 0.08694564;;; 0.25912565 -0.14499082 … 0.20033634 0.13110895; 0.21542016 0.09348221 … 0.087764904 -0.057571076; … ; -0.10137743 -0.10316813 … -0.09222229 0.18629253; 0.14673097 -0.12077212 … 0.00047666396 0.030407937;;; -0.23049244 0.18659353 … 0.19666132 0.25700033; 0.20265023 0.015039141 … -0.23735927 -0.11269632; … ; 0.24349861 0.23598626 … 0.017935842 -0.23224601; -0.039640423 -0.19660722 … 0.27343664 -0.07564111;;; -0.014139019 -0.10875653 … 0.12825768 -0.16428338; -0.005350559 0.093378566 … 0.24873069 0.16869935; … ; -0.1336206 -0.09430397 … 0.12715751 0.19059215; 0.10316533 -0.26615036 … 0.06680218 -0.04229615;;; 0.2470898 0.17973809 … -0.04823295 -0.14660794; 0.053759247 0.11740078 … -0.17696409 0.1323625; … ; 0.017608581 0.20266858 … -0.11454258 -0.05877; 0.11549814 0.10148246 … -0.24045505 -0.11028515;;; 0.19547431 0.060551327 … 0.15830041 -0.26124424; -0.09885789 0.09757828 … 0.25543177 -0.050780848; … ; -0.25723198 -0.05742457 … -0.19259712 0.24154694; -0.043952383 -0.069884226 … -0.026029184 0.08872778;;;; 0.05659819 0.2516714 … 0.21469435 -0.008269919; 0.17558427 0.177697 … -0.11645464 0.059937198; … ; 0.26867408 0.23669082 … -0.28209427 0.23791258; 0.19959326 -0.2304493 … 0.27611518 -0.24344929;;; 0.20862025 0.067008324 … 0.17829275 -0.0755849; 0.16576298 0.17078549 … -0.1537897 0.06592303; … ; 0.0015867107 -0.09658958 … 0.064331025 -0.17755158; -0.22094624 0.17085029 … 0.0020273982 0.021726867;;; -0.014992779 0.09422591 … 0.099841796 -0.23372321; -0.04019666 -0.091481484 … -0.17310219 -0.27664083; … ; 0.1989196 0.100737736 … 0.047496427 0.06352646; 0.26543173 -0.0078206 … -0.11169241 0.1599543;;; -0.17242633 -0.17616239 … -0.07513033 -0.111452006; -0.1138737 0.19899946 … 0.1819797 -0.23389685; … ; -0.19601588 -0.0076573063 … -0.2764903 0.01534216; -0.2379414 0.10914792 … -0.21636114 0.18898767;;; -0.1730737 -0.13276449 … -0.055362783 0.18294385; 0.18816021 -0.007705185 … 0.17029831 0.2541723; … ; -0.21886098 0.17785463 … 0.19920883 -0.16817337; 0.1373128 -0.25020984 … -0.12138993 -0.037206527;;; -0.144009 -0.211378 … -0.007904152 0.2668537; 0.08098776 -0.27800062 … -0.23608004 0.222885; … ; -0.13767318 0.10420467 … -0.17600718 0.0792036; 0.120612435 0.06217661 … 0.14079519 0.12208768]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[0.059521634, -0.050334737, -0.009720063, 0.019675586, 0.05290228, 0.032847542, -0.030987449, 0.07615535, 0.053398557, -0.030336674, 0.0090858545, -0.055999022, -0.0568757, 0.0106334835, 0.0753409, -0.006780343])), layer_4 = NamedTuple(), layer_5 = NamedTuple(), layer_6 = (layer_1 = (weight = Reactant.ConcreteRArray{Float32, 2}(Float32[0.20567945 0.13950577 … 0.016287515 -0.13625823; -0.023857513 0.08178409 … 0.18574256 0.18949205; … ; -0.004908773 0.12437135 … 0.122653805 0.16701514; -0.11362071 0.07796077 … 0.089975506 0.0068602865]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[0.055422388, -0.055411585, -0.0072900057, -0.033446588, 0.04616411, 0.059655108, 0.030724227, -0.042990997, -0.037487797, -0.06080796  …  -0.03704503, 0.03475806, 0.023569956, -0.0073688403, 0.04583689, -0.0385186, 0.047006823, -0.046786353, -0.0062883645, 0.017459199])), layer_2 = (weight = Reactant.ConcreteRArray{Float32, 2}(Float32[0.0982 -0.30481228 … -0.15199737 -0.20617373; 0.120820366 -0.21799661 … -0.23162602 -0.11640526; … ; 0.18901739 -0.2483782 … 0.28952244 0.13812806; 0.27664563 0.0778448 … -0.23159832 0.14517665]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[-0.02767261, 0.014004502, 0.046468746, 0.0024843565, -0.047050234, 0.011206773, 0.03194926, -0.06063513, -0.06973958, -0.063676804  …  -0.010482817, 0.055663344, -0.08152549, -0.033936515, 0.04119787, 0.059475474, 0.019876348, 0.012382892, -0.01117275, 0.074723326])), layer_3 = (weight = Reactant.ConcreteRArray{Float32, 2}(Float32[0.14243387 -0.1413405 … 0.099759124 0.11808148; 0.14102985 0.18599004 … -0.110330954 0.00057825993; … ; 0.15877534 -0.14523235 … -0.124123 0.11750876; -0.11532391 0.121751495 … -0.13485748 0.112063006]), bias = Reactant.ConcreteRArray{Float32, 1}(Float32[0.024228286, -0.08603747, 0.09359703, -0.028482005, -0.09540328, -0.07774367, 0.040403437, -0.076062605, -0.0952605, -0.0081296405])))), (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple(), layer_4 = NamedTuple(), layer_5 = NamedTuple(), layer_6 = (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple())))</span></span></code></pre></div><p>Generate an example input.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> randn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_rng</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dev;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>28×28×1×4 Reactant.ConcreteRArray{Float32, 4}:</span></span>
<span class="line"><span>[:, :, 1, 1] =</span></span>
<span class="line"><span>  0.291513   -1.56926    -0.0183474  …   0.621333    0.367604   -1.46127</span></span>
<span class="line"><span> -0.148189    1.00461     1.84009        1.8828      0.470282    0.135206</span></span>
<span class="line"><span>  1.71638     1.48005     0.604107      -0.250818   -0.446599   -0.227338</span></span>
<span class="line"><span>  0.739571    1.53753     0.171969       0.0811164   0.0492191   0.21301</span></span>
<span class="line"><span> -0.348267    0.383777   -0.0773392     -0.253224   -0.403784    0.208378</span></span>
<span class="line"><span>  0.67469     0.0619725   0.569012   …  -0.0772457  -0.274107    0.123659</span></span>
<span class="line"><span> -0.924262    0.171224    2.90908        0.933106    0.276725   -0.381141</span></span>
<span class="line"><span> -0.634469   -1.76159     0.123123       0.298099    1.19099    -1.53978</span></span>
<span class="line"><span> -0.895668   -0.58338    -0.754008       1.19339     0.0128983  -1.17349</span></span>
<span class="line"><span> -1.16553    -0.140299   -0.444516      -0.841543    0.602513   -0.511156</span></span>
<span class="line"><span>  ⋮                                  ⋱   ⋮                      </span></span>
<span class="line"><span>  1.39049     0.750511    0.630092       0.766737    0.288641    1.19623</span></span>
<span class="line"><span> -0.0961363   0.0907582   0.122563   …  -2.50502    -1.16454     1.26468</span></span>
<span class="line"><span> -0.355299    0.339815    1.76188        1.56542     1.49923     0.248654</span></span>
<span class="line"><span>  0.529701   -1.1187      0.336659       0.725559    0.316552    0.284991</span></span>
<span class="line"><span>  0.269968    0.258473   -0.539333      -0.165689   -0.829671   -1.1678</span></span>
<span class="line"><span> -0.693396   -1.47787     1.39068       -0.315031   -0.0898651  -0.506982</span></span>
<span class="line"><span>  0.0108781   1.6856      2.44338    …   0.397521    0.54465    -1.24321</span></span>
<span class="line"><span>  0.777076   -0.382574    0.453974      -0.677041   -0.188839    0.20346</span></span>
<span class="line"><span> -0.487275    1.64293    -0.0917963      0.289039   -0.93466    -1.24878</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[:, :, 1, 2] =</span></span>
<span class="line"><span> -0.2564      0.490193     -0.953683  …  -1.53926    -0.742347   -1.24991</span></span>
<span class="line"><span> -0.638731   -0.870364      0.891006      0.947371    2.04728     0.0453085</span></span>
<span class="line"><span>  0.598188    1.07915       3.02946      -0.592152    0.686369    0.171756</span></span>
<span class="line"><span> -1.6616      1.50378       0.176021      1.86299     0.0769223  -0.121998</span></span>
<span class="line"><span>  0.389206    0.932907      1.55841      -0.842642   -0.589177   -0.548012</span></span>
<span class="line"><span> -0.331483   -0.972335     -0.172708  …   0.504491   -0.480797    0.714467</span></span>
<span class="line"><span> -0.628994    1.41017      -0.3971       -2.03657    -0.250362    0.901397</span></span>
<span class="line"><span>  0.766022   -0.160986     -0.80128       1.37745     0.442927    0.127934</span></span>
<span class="line"><span>  2.02324    -0.151792      0.940139      1.96927    -0.663223   -0.0262358</span></span>
<span class="line"><span> -0.914827   -0.122567     -0.397588     -0.259247    0.63175    -0.813359</span></span>
<span class="line"><span>  ⋮                                   ⋱   ⋮                      </span></span>
<span class="line"><span>  0.415368    1.09517      -1.72281      -0.0346338  -0.818807    1.12648</span></span>
<span class="line"><span>  0.750158   -0.458762     -0.2913    …   2.39599     1.10885    -0.0234102</span></span>
<span class="line"><span> -0.0245608   0.885272      0.185913      1.34336     0.673229   -0.940073</span></span>
<span class="line"><span>  0.803491   -0.309233      0.532299      0.213618    2.0833      0.292533</span></span>
<span class="line"><span>  0.994433    0.980885     -1.0785        1.02998    -2.10494    -0.645233</span></span>
<span class="line"><span>  0.432701    1.55744      -1.48815       0.385454    1.04971     1.09799</span></span>
<span class="line"><span> -0.177779    1.03415       0.110962  …   0.266054   -1.22412    -1.8875</span></span>
<span class="line"><span>  0.921374    0.000732422  -0.509239      0.975088   -2.07542     1.5797</span></span>
<span class="line"><span>  0.267658    0.792885     -1.55864      -1.05998     0.0301979   0.226222</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[:, :, 1, 3] =</span></span>
<span class="line"><span> -0.787919    0.765517    0.683456  …   0.435143   -0.856428   -0.537721</span></span>
<span class="line"><span>  0.894248   -1.43599    -0.671201      0.454535    0.794371   -1.00744</span></span>
<span class="line"><span> -0.0684376   1.45013     1.5718       -0.468792   -0.599632   -0.37979</span></span>
<span class="line"><span> -0.588749    0.419611   -1.1295       -0.0764233  -0.958919   -1.56817</span></span>
<span class="line"><span>  0.477329   -0.71991    -0.596318      0.365734    1.88897     0.27841</span></span>
<span class="line"><span> -1.48525    -1.28766     0.550164  …   0.442849   -0.0904621   0.274203</span></span>
<span class="line"><span> -1.4905     -0.687716    0.342532     -0.315267   -0.238426    0.52272</span></span>
<span class="line"><span> -0.591793   -0.782822    0.971431      0.957152    0.28524    -0.488387</span></span>
<span class="line"><span>  0.730082    0.0321158   2.03569       1.79206     0.443328    0.878222</span></span>
<span class="line"><span> -0.473179    0.179542   -0.383948     -1.89874     0.301429    0.242777</span></span>
<span class="line"><span>  ⋮                                 ⋱   ⋮                      </span></span>
<span class="line"><span>  0.568298    1.43998     0.902204     -0.0341252   0.182365    1.12177</span></span>
<span class="line"><span> -1.06885    -0.227502    1.80644   …  -1.51385    -0.0980411  -0.468023</span></span>
<span class="line"><span>  1.4266     -0.790177   -1.11933      -1.04343    -2.74012    -0.603439</span></span>
<span class="line"><span>  0.941303   -1.2708      1.76251       0.329143   -0.157368    0.518659</span></span>
<span class="line"><span> -0.286642   -0.158975   -0.336721     -2.78971    -0.433858   -1.36348</span></span>
<span class="line"><span> -0.209906    2.24079     1.33335      -1.91862     0.756535    1.05</span></span>
<span class="line"><span> -0.703892   -0.119758    0.338672  …  -1.06781     0.333503    0.367246</span></span>
<span class="line"><span> -0.514301    1.74311     1.23352      -0.234211   -2.67728     0.50096</span></span>
<span class="line"><span> -0.0134848  -0.285777   -0.375862      0.487558   -0.788505   -0.622511</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[:, :, 1, 4] =</span></span>
<span class="line"><span>  0.139778  -0.84954   -0.191424    …   0.501695   -0.86957     0.15875</span></span>
<span class="line"><span>  0.382491   0.116574   1.4908         -0.0281603   0.0523839   0.171212</span></span>
<span class="line"><span>  1.93197    0.187688  -1.19373         0.112344   -0.747831   -0.41799</span></span>
<span class="line"><span>  1.47092   -1.32698    0.205559       -1.63161     0.578686    2.30573</span></span>
<span class="line"><span>  1.41261    0.394958  -0.361142       -0.594664    2.19236     0.0775962</span></span>
<span class="line"><span> -1.00258   -0.2293    -0.886353    …   0.836232    1.13513    -0.522541</span></span>
<span class="line"><span>  0.304635  -0.259867   0.442206       -0.811523   -0.946637   -1.63823</span></span>
<span class="line"><span>  1.07021   -1.19011   -1.35452         0.583191    0.389748   -0.554008</span></span>
<span class="line"><span> -1.30172   -0.441454   0.238232        0.640625   -1.0373      1.86624</span></span>
<span class="line"><span>  0.68639   -1.10676   -1.63936         1.16447     2.26076    -0.867646</span></span>
<span class="line"><span>  ⋮                                 ⋱   ⋮                      </span></span>
<span class="line"><span>  0.19226    0.193263  -0.324167       -1.5641     -0.0836404   0.353753</span></span>
<span class="line"><span> -0.92663    0.671869   0.00835054  …   1.01832    -0.373847    0.529258</span></span>
<span class="line"><span>  0.697421   2.05721   -1.50536         0.650203   -0.112076    1.7092</span></span>
<span class="line"><span>  0.834789  -1.45895   -0.174513       -1.09461     0.401719   -1.28114</span></span>
<span class="line"><span> -0.966289  -1.05522   -0.0551505      -0.471634    1.42752     0.921201</span></span>
<span class="line"><span>  1.76929    0.886018   0.808093       -1.74448    -0.279297   -0.0572769</span></span>
<span class="line"><span>  0.398299   0.434771   1.57555     …  -1.88135     0.581354   -0.887089</span></span>
<span class="line"><span>  0.138228  -1.04933   -1.20448         1.23037    -2.04173     0.118148</span></span>
<span class="line"><span> -0.469687   0.224029  -1.67689        -0.206943    0.528563   -1.07894</span></span></code></pre></div><p>Now instead of compiling the model, we will use <code>Reactant.@code_hlo</code> to generate the StableHLO code.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hlo_code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @code_hlo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ps, st)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>module {</span></span>
<span class="line"><span>  func.func @main(%arg0: tensor&lt;4x1x28x28xf32&gt;, %arg1: tensor&lt;6x1x5x5xf32&gt;, %arg2: tensor&lt;6xf32&gt;, %arg3: tensor&lt;16x6x5x5xf32&gt;, %arg4: tensor&lt;16xf32&gt;, %arg5: tensor&lt;256x128xf32&gt;, %arg6: tensor&lt;128xf32&gt;, %arg7: tensor&lt;128x84xf32&gt;, %arg8: tensor&lt;84xf32&gt;, %arg9: tensor&lt;84x10xf32&gt;, %arg10: tensor&lt;10xf32&gt;) -&gt; tensor&lt;4x10xf32&gt; {</span></span>
<span class="line"><span>    %cst = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %cst_0 = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %cst_1 = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %cst_2 = stablehlo.constant dense&lt;0.000000e+00&gt; : tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %cst_3 = stablehlo.constant dense&lt;0xFF800000&gt; : tensor&lt;f32&gt;</span></span>
<span class="line"><span>    %0 = stablehlo.transpose %arg1, dims = [3, 2, 1, 0] : (tensor&lt;6x1x5x5xf32&gt;) -&gt; tensor&lt;5x5x1x6xf32&gt;</span></span>
<span class="line"><span>    %1 = stablehlo.transpose %arg3, dims = [3, 2, 1, 0] : (tensor&lt;16x6x5x5xf32&gt;) -&gt; tensor&lt;5x5x6x16xf32&gt;</span></span>
<span class="line"><span>    %2 = stablehlo.reverse %0, dims = [0, 1] : tensor&lt;5x5x1x6xf32&gt;</span></span>
<span class="line"><span>    %3 = stablehlo.convolution(%arg0, %2) dim_numbers = [b, f, 1, 0]x[0, 1, i, o]-&gt;[0, 1, f, b], window = {stride = [1, 1], pad = [[0, 0], [0, 0]], rhs_dilate = [1, 1]} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor&lt;4x1x28x28xf32&gt;, tensor&lt;5x5x1x6xf32&gt;) -&gt; tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %4 = stablehlo.broadcast_in_dim %arg2, dims = [2] : (tensor&lt;6xf32&gt;) -&gt; tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %5 = stablehlo.add %3, %4 : tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %6 = stablehlo.compare  LT, %5, %cst_2 : (tensor&lt;24x24x6x4xf32&gt;, tensor&lt;24x24x6x4xf32&gt;) -&gt; tensor&lt;24x24x6x4xi1&gt;</span></span>
<span class="line"><span>    %7 = stablehlo.select %6, %cst_2, %5 : tensor&lt;24x24x6x4xi1&gt;, tensor&lt;24x24x6x4xf32&gt;</span></span>
<span class="line"><span>    %8 = &quot;stablehlo.reduce_window&quot;(%7, %cst_3) &lt;{padding = dense&lt;0&gt; : tensor&lt;4x2xi64&gt;, window_dilations = array&lt;i64: 1, 1, 1, 1&gt;, window_dimensions = array&lt;i64: 2, 2, 1, 1&gt;, window_strides = array&lt;i64: 2, 2, 1, 1&gt;}&gt; ({</span></span>
<span class="line"><span>    ^bb0(%arg11: tensor&lt;f32&gt;, %arg12: tensor&lt;f32&gt;):</span></span>
<span class="line"><span>      %32 = stablehlo.maximum %arg11, %arg12 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>      stablehlo.return %32 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>    }) : (tensor&lt;24x24x6x4xf32&gt;, tensor&lt;f32&gt;) -&gt; tensor&lt;12x12x6x4xf32&gt;</span></span>
<span class="line"><span>    %9 = stablehlo.reverse %1, dims = [0, 1] : tensor&lt;5x5x6x16xf32&gt;</span></span>
<span class="line"><span>    %10 = stablehlo.convolution(%8, %9) dim_numbers = [0, 1, f, b]x[0, 1, i, o]-&gt;[0, 1, f, b], window = {stride = [1, 1], pad = [[0, 0], [0, 0]], rhs_dilate = [1, 1]} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor&lt;12x12x6x4xf32&gt;, tensor&lt;5x5x6x16xf32&gt;) -&gt; tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %11 = stablehlo.broadcast_in_dim %arg4, dims = [2] : (tensor&lt;16xf32&gt;) -&gt; tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %12 = stablehlo.add %10, %11 : tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %13 = stablehlo.compare  LT, %12, %cst_1 : (tensor&lt;8x8x16x4xf32&gt;, tensor&lt;8x8x16x4xf32&gt;) -&gt; tensor&lt;8x8x16x4xi1&gt;</span></span>
<span class="line"><span>    %14 = stablehlo.select %13, %cst_1, %12 : tensor&lt;8x8x16x4xi1&gt;, tensor&lt;8x8x16x4xf32&gt;</span></span>
<span class="line"><span>    %15 = &quot;stablehlo.reduce_window&quot;(%14, %cst_3) &lt;{padding = dense&lt;0&gt; : tensor&lt;4x2xi64&gt;, window_dilations = array&lt;i64: 1, 1, 1, 1&gt;, window_dimensions = array&lt;i64: 2, 2, 1, 1&gt;, window_strides = array&lt;i64: 2, 2, 1, 1&gt;}&gt; ({</span></span>
<span class="line"><span>    ^bb0(%arg11: tensor&lt;f32&gt;, %arg12: tensor&lt;f32&gt;):</span></span>
<span class="line"><span>      %32 = stablehlo.maximum %arg11, %arg12 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>      stablehlo.return %32 : tensor&lt;f32&gt;</span></span>
<span class="line"><span>    }) : (tensor&lt;8x8x16x4xf32&gt;, tensor&lt;f32&gt;) -&gt; tensor&lt;4x4x16x4xf32&gt;</span></span>
<span class="line"><span>    %16 = stablehlo.transpose %15, dims = [3, 2, 1, 0] : (tensor&lt;4x4x16x4xf32&gt;) -&gt; tensor&lt;4x16x4x4xf32&gt;</span></span>
<span class="line"><span>    %17 = stablehlo.reshape %16 : (tensor&lt;4x16x4x4xf32&gt;) -&gt; tensor&lt;4x256xf32&gt;</span></span>
<span class="line"><span>    %18 = stablehlo.dot_general %arg5, %17, contracting_dims = [0] x [1] : (tensor&lt;256x128xf32&gt;, tensor&lt;4x256xf32&gt;) -&gt; tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %19 = stablehlo.broadcast_in_dim %arg6, dims = [0] : (tensor&lt;128xf32&gt;) -&gt; tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %20 = stablehlo.add %18, %19 : tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %21 = stablehlo.compare  LT, %20, %cst_0 : (tensor&lt;128x4xf32&gt;, tensor&lt;128x4xf32&gt;) -&gt; tensor&lt;128x4xi1&gt;</span></span>
<span class="line"><span>    %22 = stablehlo.select %21, %cst_0, %20 : tensor&lt;128x4xi1&gt;, tensor&lt;128x4xf32&gt;</span></span>
<span class="line"><span>    %23 = stablehlo.dot_general %arg7, %22, contracting_dims = [0] x [0] : (tensor&lt;128x84xf32&gt;, tensor&lt;128x4xf32&gt;) -&gt; tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %24 = stablehlo.broadcast_in_dim %arg8, dims = [0] : (tensor&lt;84xf32&gt;) -&gt; tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %25 = stablehlo.add %23, %24 : tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %26 = stablehlo.compare  LT, %25, %cst : (tensor&lt;84x4xf32&gt;, tensor&lt;84x4xf32&gt;) -&gt; tensor&lt;84x4xi1&gt;</span></span>
<span class="line"><span>    %27 = stablehlo.select %26, %cst, %25 : tensor&lt;84x4xi1&gt;, tensor&lt;84x4xf32&gt;</span></span>
<span class="line"><span>    %28 = stablehlo.dot_general %arg9, %27, contracting_dims = [0] x [0] : (tensor&lt;84x10xf32&gt;, tensor&lt;84x4xf32&gt;) -&gt; tensor&lt;10x4xf32&gt;</span></span>
<span class="line"><span>    %29 = stablehlo.broadcast_in_dim %arg10, dims = [0] : (tensor&lt;10xf32&gt;) -&gt; tensor&lt;10x4xf32&gt;</span></span>
<span class="line"><span>    %30 = stablehlo.add %28, %29 : tensor&lt;10x4xf32&gt;</span></span>
<span class="line"><span>    %31 = stablehlo.transpose %30, dims = [1, 0] : (tensor&lt;10x4xf32&gt;) -&gt; tensor&lt;4x10xf32&gt;</span></span>
<span class="line"><span>    return %31 : tensor&lt;4x10xf32&gt;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>Now we just save this into an <code>mlir</code> file.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;exported_lux_model.mlir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;w&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> io</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    write</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hlo_code))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>4754</span></span></code></pre></div><p>Now we define a python script to run the model using EnzymeJAX.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> enzyme_ad.jax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hlo_call</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jnp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;exported_lux_model.mlir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;r&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.read()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run_lux_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bias6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hlo_call(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        x,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_3,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        source</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Note that all the inputs must be transposed, i.e. if the julia function has an input of</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># shape (28, 28, 1, 4), then the input to the exported function called from python must be</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># of shape (4, 1, 28, 28). This is because multi-dimensional arrays in Julia are stored in</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># column-major order, while in JAX/Python they are stored in row-major order.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Input as defined in our exported Lux model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Weights and biases corresponding to `ps` and `st` in our exported Lux model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight6_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias6_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight6_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias6_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">weight6_3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bias6_3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jax.random.normal(jax.random.PRNGKey(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Run the exported Lux model</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    jax.jit(run_lux_model)(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        x,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_2,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        weight6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bias6_3,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/LuxDL/Lux.jl/edit/main/docs/src/manual/exporting_to_jax.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page on GitHub<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/v1.5.0/manual/compiling_lux_models" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Compiling Lux Models</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/v1.5.0/manual/autodiff" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Automatic Differentiation</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://documenter.juliadocs.org/stable/" target="_blank"><strong>Documenter.jl</strong></a>, <a href="https://vitepress.dev" target="_blank"><strong>VitePress</strong></a> and <a href="https://luxdl.github.io/DocumenterVitepress.jl/stable" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href="https://www.julialang.org">Julia Programming Language</a>.<br></p><p class="copyright" data-v-c970a860>© Copyright 2025 Avik Pal.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_accelerator_support_mldatadevices.md\":\"1sxMlFaJ\",\"api_building_blocks_luxcore.md\":\"Df8drYrb\",\"api_building_blocks_weightinitializers.md\":\"y4QBPogg\",\"api_lux_autodiff.md\":\"B2l_Sx8e\",\"api_lux_contrib.md\":\"DuOA9mbA\",\"api_lux_distributed_utils.md\":\"BrgZ5-OI\",\"api_lux_interop.md\":\"CBIX8V7O\",\"api_lux_layers.md\":\"DVNjGlZS\",\"api_lux_utilities.md\":\"DRfmvvq6\",\"api_nn_primitives_activationfunctions.md\":\"D5QgWv0S\",\"api_nn_primitives_luxlib.md\":\"CcoiCmsl\",\"api_nn_primitives_nnlib.md\":\"CXFTx2f_\",\"api_testing_functionality_luxtestutils.md\":\"dTuLXHDl\",\"index.md\":\"BSmmbjTG\",\"introduction_citation.md\":\"BfuttmoY\",\"introduction_index.md\":\"C-DZ0wuy\",\"introduction_overview.md\":\"DESNPfVM\",\"introduction_resources.md\":\"CdZLiQFm\",\"introduction_updating_to_v1.md\":\"ChUvZPn7\",\"manual_autodiff.md\":\"pqf3cU6q\",\"manual_compiling_lux_models.md\":\"C2S6ulwI\",\"manual_debugging.md\":\"B3iEuYjg\",\"manual_dispatch_custom_input.md\":\"DK9uqLVD\",\"manual_distributed_utils.md\":\"BA7wyLj6\",\"manual_exporting_to_jax.md\":\"D8zqYWoY\",\"manual_freezing_model_parameters.md\":\"B-IBhEp0\",\"manual_gpu_management.md\":\"DFVg2v8_\",\"manual_interface.md\":\"B8LHojDl\",\"manual_migrate_from_flux.md\":\"CXVSwPa3\",\"manual_nested_autodiff.md\":\"BM8KLhQD\",\"manual_nn_inside_gpu_kernels.md\":\"DO9GNnOL\",\"manual_performance_pitfalls.md\":\"B_RinyHA\",\"manual_preferences.md\":\"CIeGxMwY\",\"manual_weight_initializers.md\":\"CKNvEYvB\",\"tutorials_advanced_1_gravitationalwaveform.md\":\"CVkj-seS\",\"tutorials_beginner_1_basics.md\":\"BlvK5ib5\",\"tutorials_beginner_2_polynomialfitting.md\":\"CIgQDZLP\",\"tutorials_beginner_3_simplernn.md\":\"D5bLFy7I\",\"tutorials_beginner_4_simplechains.md\":\"Cw_VCQ1p\",\"tutorials_beginner_5_optimizationintegration.md\":\"D3lt-FwV\",\"tutorials_index.md\":\"B_zmeVNe\",\"tutorials_intermediate_1_neuralode.md\":\"EkdcA2Fh\",\"tutorials_intermediate_2_bayesiannn.md\":\"DERKLF4t\",\"tutorials_intermediate_3_hypernet.md\":\"DkWYkQr_\",\"tutorials_intermediate_4_pinn2dpde.md\":\"BsyGrrNK\",\"tutorials_intermediate_5_conditionalvae.md\":\"DlIMUGP-\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Lux.jl Docs\",\"description\":\"Documentation for LuxDL Repositories\",\"base\":\"/v1.5.0/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"light\":\"/lux-logo.svg\",\"dark\":\"/lux-logo-dark.svg\"},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting Started\",\"link\":\"/introduction\"},{\"text\":\"Benchmarks\",\"link\":\"https://lux.csail.mit.edu/benchmarks/\"},{\"text\":\"Tutorials\",\"link\":\"/tutorials/\"},{\"text\":\"Manual\",\"link\":\"/manual/interface\"},{\"text\":\"API\",\"items\":[{\"text\":\"Lux\",\"items\":[{\"text\":\"Built-In Layers\",\"link\":\"/api/Lux/layers\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/api/Lux/autodiff\"},{\"text\":\"Utilities\",\"link\":\"/api/Lux/utilities\"},{\"text\":\"Experimental\",\"link\":\"/api/Lux/contrib\"},{\"text\":\"InterOp\",\"link\":\"/api/Lux/interop\"},{\"text\":\"DistributedUtils\",\"link\":\"/api/Lux/distributed_utils\"}]},{\"text\":\"Accelerator Support\",\"items\":[{\"text\":\"MLDataDevices\",\"link\":\"/api/Accelerator_Support/MLDataDevices\"}]},{\"text\":\"NN Primitives\",\"items\":[{\"text\":\"LuxLib\",\"link\":\"/api/NN_Primitives/LuxLib\"},{\"text\":\"NNlib\",\"link\":\"/api/NN_Primitives/NNlib\"},{\"text\":\"Activation Functions\",\"link\":\"/api/NN_Primitives/ActivationFunctions\"}]},{\"text\":\"Building Blocks\",\"items\":[{\"text\":\"LuxCore\",\"link\":\"/api/Building_Blocks/LuxCore\"},{\"text\":\"WeightInitializers\",\"link\":\"/api/Building_Blocks/WeightInitializers\"}]},{\"text\":\"Testing Functionality\",\"items\":[{\"text\":\"LuxTestUtils\",\"link\":\"/api/Testing_Functionality/LuxTestUtils\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":{\"/introduction/\":{\"text\":\"Getting Started\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"link\":\"/introduction\"},{\"text\":\"Overview\",\"link\":\"/introduction/overview\"},{\"text\":\"Resources\",\"link\":\"/introduction/resources\"},{\"text\":\"Updating to v1\",\"link\":\"/introduction/updating_to_v1\"},{\"text\":\"Citation\",\"link\":\"/introduction/citation\"}]},\"/tutorials/\":{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/\"},{\"text\":\"Beginner\",\"collapsed\":false,\"items\":[{\"text\":\"Julia & Lux for the Uninitiated\",\"link\":\"/tutorials/beginner/1_Basics\"},{\"text\":\"Fitting a Polynomial using MLP\",\"link\":\"/tutorials/beginner/2_PolynomialFitting\"},{\"text\":\"Training a Simple LSTM\",\"link\":\"/tutorials/beginner/3_SimpleRNN\"},{\"text\":\"MNIST Classification with SimpleChains\",\"link\":\"/tutorials/beginner/4_SimpleChains\"},{\"text\":\"Fitting with Optimization.jl\",\"link\":\"/tutorials/beginner/5_OptimizationIntegration\"}]},{\"text\":\"Intermediate\",\"collapsed\":false,\"items\":[{\"text\":\"MNIST Classification using Neural ODEs\",\"link\":\"/tutorials/intermediate/1_NeuralODE\"},{\"text\":\"Bayesian Neural Network\",\"link\":\"/tutorials/intermediate/2_BayesianNN\"},{\"text\":\"Training a HyperNetwork on MNIST and FashionMNIST\",\"link\":\"/tutorials/intermediate/3_HyperNet\"},{\"text\":\"Training a PINN on 2D PDE\",\"link\":\"/tutorials/intermediate/4_PINN2DPDE\"},{\"text\":\"Conditional VAE for MNIST using Reactant\",\"link\":\"/tutorials/intermediate/5_ConditionalVAE\"}]},{\"text\":\"Advanced\",\"collapsed\":false,\"items\":[{\"text\":\"Training a Neural ODE to Model Gravitational Waveforms\",\"link\":\"/tutorials/advanced/1_GravitationalWaveForm\"}]},{\"text\":\"Larger Models\",\"collapsed\":true,\"items\":[{\"text\":\"Training Image Classification Models on ImageNet with Distributed Data Parallel Training\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/ImageNet\"},{\"text\":\"Training a DDIM (Diffusion Model) for Image Generation\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/DDIM\"},{\"text\":\"Different Vision Models on CIFAR-10\",\"link\":\"https://github.com/LuxDL/Lux.jl/tree/main/examples/CIFAR10\"}]},{\"text\":\"3rd Party Tutorials\",\"collapsed\":true,\"items\":[{\"text\":\"PINNs (NeuralPDE.jl)\",\"link\":\"https://docs.sciml.ai/NeuralPDE/stable/tutorials/pdesystem/\"},{\"text\":\"UDEs (SciMLSensitivity.jl)\",\"link\":\"https://docs.sciml.ai/SciMLSensitivity/stable/tutorials/data_parallel/\"},{\"text\":\"Neural DEs (DiffEqFlux.jl)\",\"link\":\"https://docs.sciml.ai/DiffEqFlux/stable/examples/neural_ode/\"},{\"text\":\"DEQs (DeepEquilibriumNetworks.jl)\",\"link\":\"https://docs.sciml.ai/DeepEquilibriumNetworks/stable/tutorials/basic_mnist_deq/\"},{\"text\":\"Medical Image Segmentation\",\"link\":\"https://github.com/Dale-Black/ComputerVisionTutorials.jl/\"},{\"text\":\"Neural Closure Models\",\"link\":\"https://github.com/agdestein/NeuralClosureTutorials/\"}]}]},\"/manual/\":{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Basics\",\"items\":[{\"text\":\"Lux Interface\",\"link\":\"/manual/interface\"},{\"text\":\"Freezing Parameters\",\"link\":\"/manual/freezing_model_parameters\"},{\"text\":\"GPU Management\",\"link\":\"/manual/gpu_management\"},{\"text\":\"Initializing Weights\",\"link\":\"/manual/weight_initializers\"}]},{\"text\":\"Reactant Compilation\",\"items\":[{\"text\":\"Compiling Lux Models\",\"link\":\"/manual/compiling_lux_models\"},{\"text\":\"Exporting Lux Models to Jax\",\"link\":\"/manual/exporting_to_jax\"}]},{\"text\":\"Automatic Differentiation\",\"items\":[{\"text\":\"Automatic Differentiation\",\"link\":\"/manual/autodiff\"},{\"text\":\"Nested AutoDiff\",\"link\":\"/manual/nested_autodiff\"}]},{\"text\":\"Debugging / Performance Enhancement Tools\",\"items\":[{\"text\":\"Debugging Lux Models\",\"link\":\"/manual/debugging\"},{\"text\":\"Performance Pitfalls\",\"link\":\"/manual/performance_pitfalls\"}]},{\"text\":\"Migration Guides\",\"items\":[{\"text\":\"Migrating from Flux\",\"link\":\"/manual/migrate_from_flux\"}]},{\"text\":\"Advanced Usage\",\"items\":[{\"text\":\"Custom Input Types\",\"link\":\"/manual/dispatch_custom_input\"},{\"text\":\"Configuration via Preferences\",\"link\":\"/manual/preferences\"},{\"text\":\"Distributed Training\",\"link\":\"/manual/distributed_utils\"},{\"text\":\"Lux In GPU Kernels\",\"link\":\"/manual/nn_inside_gpu_kernels\"}]}]},\"/api/\":{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Lux\",\"collapsed\":false,\"items\":[{\"text\":\"Built-In Layers\",\"link\":\"/api/Lux/layers\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/api/Lux/autodiff\"},{\"text\":\"Utilities\",\"link\":\"/api/Lux/utilities\"},{\"text\":\"Experimental Features\",\"link\":\"/api/Lux/contrib\"},{\"text\":\"Interoperability\",\"link\":\"/api/Lux/interop\"},{\"text\":\"DistributedUtils\",\"link\":\"/api/Lux/distributed_utils\"}]},{\"text\":\"Accelerator Support\",\"collapsed\":false,\"items\":[{\"text\":\"MLDataDevices\",\"link\":\"/api/Accelerator_Support/MLDataDevices\"}]},{\"text\":\"NN Primitives\",\"collapsed\":false,\"items\":[{\"text\":\"LuxLib\",\"link\":\"/api/NN_Primitives/LuxLib\"},{\"text\":\"NNlib\",\"link\":\"/api/NN_Primitives/NNlib\"},{\"text\":\"Activation Functions\",\"link\":\"/api/NN_Primitives/ActivationFunctions\"}]},{\"text\":\"Building Blocks\",\"collapsed\":false,\"items\":[{\"text\":\"LuxCore\",\"link\":\"/api/Building_Blocks/LuxCore\"},{\"text\":\"WeightInitializers\",\"link\":\"/api/Building_Blocks/WeightInitializers\"}]},{\"text\":\"Testing Functionality\",\"collapsed\":false,\"items\":[{\"text\":\"LuxTestUtils\",\"link\":\"/api/Testing_Functionality/LuxTestUtils\"}]}]}},\"editLink\":{\"pattern\":\"https://github.com/LuxDL/Lux.jl/edit/main/docs/src/:path\",\"text\":\"Edit this page on GitHub\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/LuxDL/Lux.jl\"},{\"icon\":\"twitter\",\"link\":\"https://twitter.com/avikpal1410\"},{\"icon\":\"slack\",\"link\":\"https://julialang.org/slack/\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://documenter.juliadocs.org/stable/\\\" target=\\\"_blank\\\"><strong>Documenter.jl</strong></a>, <a href=\\\"https://vitepress.dev\\\" target=\\\"_blank\\\"><strong>VitePress</strong></a> and <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/stable\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href=\\\"https://www.julialang.org\\\">Julia Programming Language</a>.<br>\",\"copyright\":\"© Copyright 2025 Avik Pal.\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>